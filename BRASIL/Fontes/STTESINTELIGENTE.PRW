#include 'Protheus.ch'
#include 'RwMake.ch'

/*====================================================================================\
|Programa  | STTESINTELIGENTE | Autor | GIOVANI.ZAGO             | Data | 07/03/2013  |
|=====================================================================================|
|Descrição |   TES INTELIGENTE        		    	                                  |
|          |                                                                          |
|          |                                                                          |
|=====================================================================================|
|Sintaxe   | STTESINTELIGENTE                                                         |
|=====================================================================================|
|Uso       | Especifico STECK                                                         |
|=====================================================================================|
|........................................Histórico....................................|
\====================================================================================*/
*-----------------------------*
User Function STTESINTELIGENTE()
	*-----------------------------*
	Local lRest         := .F.

	Local cCLIST := AllTrim(SuperGetMV("ST_CLIST", .F., "00872401;"))
	Local cNCMST := "" // Alterado na melhoria 20230713008872
	
	//--------------------------------------------------------------------------------//
	//FR - 21/03/2023 - Flávia Rocha - Sigamat Consultoria - PROJETO MERCADO LIVRE
	//--------------------------------------------------------------------------------//	
	Local _cArmzMELI:= GetNewPar("ST_AMZMELI" ,"06")  //Armazém padrão para os produtos de remessa para Mercado Livre

	Private lRICMSST := .F.

	Private _Lmomat   	:= IsInCallSteck("TMKA271") .Or. IsInCallSteck("TMKA380") .or. IsInCallSteck("U_STFSVE46")
	Private _lFis    	:= IsInCallSteck("U_STPEDFIS") .Or. IsInCallSteck("U_STFISTES") .Or. IsInCallSteck("U_STFISS01") .Or. IsInCallSteck("U_STFISS03") .Or. IsInCallSteck("U_STFISS11") .Or. IsInCallSteck("U_RSTFAT08") .Or. IsInCallSteck("U_RSTFAT23") .Or. IsInCallSteck("U_RSTFAT35") .Or. IsInCallSteck("U_STRETSST") .Or. IsInCallSteck("U_STFTA001") .Or. IsInCallSteck("U_StWeb082") .Or. IsInCallSteck("U_CH_PED")
	Private _lAtFis     := IsInCallSteck("U_STFISTES") .Or. IsInCallSteck("U_STFISS") .OR. IsInCallSteck("U_RSTFAT08") .OR. IsInCallSteck("U_RSTFAT23") .or. IsInCallSteck("U_STRETSST").or. IsInCallSteck("U_STFTA001")
	Private _nPosTes  	:= aScan(aHeader, {|x| Upper(AllTrim(x[2])) == IIF(  _Lmomat,"UB_TES"     ,iif(_lFis,"TES"		 ,"C6_TES"     ) 	)   })
	Private _nPosOper 	:= aScan(aHeader, {|x| Upper(AllTrim(x[2])) == IIF(  _Lmomat,"UB_OPER"    ,iif(_lFis,'TPOPER'    ,"C6_OPER"    )	)   })
	Private _nPosProd 	:= aScan(aHeader, {|x| Upper(AllTrim(x[2])) == IIF(  _Lmomat,"UB_PRODUTO" ,iif(_lFis,"C6_PRODUTO","C6_PRODUTO" )	)   })
	Private _nPosCfo   	:= aScan(aHeader, {|x| Upper(AllTrim(x[2])) == IIF(  _Lmomat,"UB_CF"      ,iif(_lFis,"CFOP"      ,"C6_CF"      )	)   })
	
	//--------------------------------------------------------------------------------//
	//FR - 21/03/2023 - Flávia Rocha - Sigamat Consultoria - PROJETO MERCADO LIVRE
	//--------------------------------------------------------------------------------//	
	Private _nPosArmz  	:= aScan(aHeader, {|x| Upper(AllTrim(x[2])) == IIF(  _Lmomat,"UB_LOCAL"   ,iif(_lFis,"C6_LOCAL"  ,"C6_LOCAL"   )	)   })
	
	Private _lRet     	:= .F.
	Private _cTipoCF   	:= IIF(_Lmomat ,'C',IIf(M->C5_TIPO $ 'DB',"F","C"))
	Private _cProg     	:= IIF(_Lmomat ,"TK273"        ,"MT100")
	Private _cLoja    	:= IIF(_Lmomat ,"M->UA_LOJA"   ,"M->C5_LOJACLI")
	Private _cCliente 	:= IIF(_Lmomat ,"M->UA_CLIENTE","M->C5_CLIENTE")
	Private _cTipoCli 	:= IIF(_Lmomat ,"M->UA_XTIPO"  ,"M->C5_TIPOCLI")
	Private _cTes     	:= ''
	Private _cEst       := Getmv("MV_ESTADO",,'SP')
	Private _aDadosCfo  := {}
	Private _cTipofor   := '1'
	Private _cCliEst    := If(_cTipoCF == "C", "SA1->A1_EST"     , "SA2->A2_EST"      )
	Private _cCliContrib:= If(_cTipoCF == "C", "SA1->A1_CONTRIB" , "_cTipofor"        )
	Private _cCliInscr  := If(_cTipoCF == "C", "SA1->A1_INSCR"   , "SA2->A2_INSCR"    )
	Private _cCliTip    := If(_cTipoCF == "C", "SA1->A1_TIPO"    , "SA2->A2_TIPO"     )
	Private _cCliSufra  := If(_cTipoCF == "C", "SA1->A1_SUFRAMA" , ""                 )
	Private _cCliMun    := If(_cTipoCF == "C", "SA1->A1_COD_MUN" , "SA2->A2_COD_MUN"  )
	Private _cxCliContr := If(_cTipoCF == "C", "SA1->A1_GRPTRIB" , "SA2->A2_GRPTRIB"  )
	Private _cAtividade	:= If(_cTipoCF == "C", "SA1->A1_SATIV1"  , "SA2->A2_SATIV1"   )//Incluído João Victor em 29/03/2013
	Private _cCliCep    := If(_cTipoCF == "C", "SA1->A1_CEP"     , "SA2->A2_CEP"      )
	Private _cZconsum 	:= IIF(_Lmomat ,"M->UA_ZCONSUM"          , "M->C5_ZCONSUM"    )
	Private _cTipopv   	:= IIF(_Lmomat ,""                       , "M->C5_TIPO"       )//Incluído João Victor em 25/06/2013
	Private _cCredMAO   := If(_cTipoCF == "C", "SA1->A1_CRDMA"   , ""                 )
	DEFAULT _XTES       := ""

	// Incluido na melhoria 20230713008872
	cNCMST += AllTrim(SuperGetMV("ST_NCMST01", .F., "85185000;85177900;85291090;85318000;85319000;85362000;85363090;85364900;85365090;85366910;85366990;85369090;85389090;85444900;"))
	cNCMST += AllTrim(SuperGetMV("ST_NCMST02", .F., "85185000;85177900;85291090;85318000;85319000;85362000;85363090;85364900;85365090;85366910;85366990;85369090;85389090;85444900;"))
	cNCMST += AllTrim(SuperGetMV("ST_NCMST03", .F., "85185000;85177900;85291090;85318000;85319000;85362000;85363090;85364900;85365090;85366910;85366990;85369090;85389090;85444900;"))
	cNCMST += AllTrim(SuperGetMV("ST_NCMST04", .F., "85185000;85177900;85291090;85318000;85319000;85362000;85363090;85364900;85365090;85366910;85366990;85369090;85389090;85444900;"))
	// Incluido na melhoria 20230713008872

	/*********************************************
	<<<< ALTERAÇÃO >>>>
	Ação.........: Tratamento para pegar o Tipo do consumo
	.............: Quando o pedido vier via EDI e o Cliente for REVENDEDOR faz o mesmo tratamento que está na rotina STEDIPV +- linha 338
	.............: Se a variável _cZconsum = NIL é pq não está entrando via Orçamento ou Pedido de Venda.
	Desenvolvedor: Marcelo Klopfer Leme - SIGAMAT
	Data.........: 22/02/2022
	Chamados.....: 20220222004302
	****************************************/	
	IF Type("_cConsumo")=="C"
		U_STTESTEL()
	ELSEIF Type("_cConsumo")<>"C" .AND. IsInCallStack("U_xSTEDIPV") 
		If (SA1->A1_TIPO $ 'R' .And. SA1->A1_CONTRIB = '1'  .And. (alltrim(SA1->A1_GRPVEN) $ 'D1/D2/D3/R1/R2/R3/R5' ) .And. (!Empty(ALLTRIM(SA1->A1_INSCR)) .Or. 'ISENT' $ Upper(ALLTRIM(SA1->A1_INSCR))))
			&_cZconsum := '1'
		EndIf	
	ENDIF

	//If ( Type("l410Auto") == "U" .OR. !l410Auto )
	If FWIsInCallStack("U_SXGERSC5") .OR. (TYPE("l410Auto") == "U" .OR. !l410Auto) .OR. FWIsInCallStack("U_CH_PED") 

		dbSelectArea("SA1")
		SA1->(dbSetOrder(1))
		dbSelectArea("SA2")
		SA2->(dbSetOrder(1))
		
		If 	SA1->(DbSeek(xFilial("SA1")+&_cCliente+&_cLoja))  .Or. 	SA2->(DbSeek(xFilial("SA2")+&_cCliente+&_cLoja))

			dbSelectArea("SB1")
			SB1->(dbSetOrder(1))
			If SB1->(DbSeek(xFilial("SB1")+aCols[n][_nPosProd]))

				If SA1->A1_COD + SA1->A1_LOJA $ cCLIST .And. AllTrim(SB1->B1_POSIPI) $ cNCMST
					lRICMSST := .T.
				End If

				If cEmpAnt == '01'
					If  	aCols[n][_nPosOper] ='01'//VENDAS NACIONAIS
						_cTes:=	 StOper01()
					ElseIf  aCols[n][_nPosOper] ='03'//RET.DEMONSTRAÇÃO C/IPI E ICMS ( ATUA.ESTOQUE)
						_cTes:=	 StOper03()
					ElseIf  aCols[n][_nPosOper] ='05'//VENDA - DRAWBACK
						_cTes:=	 StOper05()
					ElseIf  aCols[n][_nPosOper] ='07'//VENDAS RED B.CALCULO ICMS
						_cTes:=	 StOper07()
					ElseIf  aCols[n][_nPosOper] ='08'//TRADING
						_cTes:=	 StOper08()
					ElseIf  aCols[n][_nPosOper] ='09'//COMPLEMENTO DE PRECO
						_cTes:=	 StOper09()
					// Ticket 20201203011728
					ElseIf  aCols[n][_nPosOper] ='10'// REMESSA PARA CONSIGNACAO
						_cTes:=	 StOper10()
					ElseIf  aCols[n][_nPosOper] ='11'// REM INDUSTRIALIZAÇÃO POR CONTA E ORDEM
						_cTes:=	 StOper11()
					ElseIf  aCols[n][_nPosOper] ='12'//DEMOSTRACAO
						_cTes:=	 StOper12()
					ElseIf  aCols[n][_nPosOper] ='13'//MOSTRUARIO
						_cTes:=	 StOper13()
					ElseIf  aCols[n][_nPosOper] ='14'//REMESSA PARA TESTE
						_cTes:=	 StOper14()
					ElseIf  aCols[n][_nPosOper] ='15'//RETORNO TESTE
						_cTes:=	 StOper15()
					ElseIf  aCols[n][_nPosOper] ='16'//Trasferências entre filiais (GUARAREMA)
						_cTes:=	 StOper16()
					ElseIf  aCols[n][_nPosOper] ='17'//REM P/VASILHAME
						_cTes:=	 StOper17()
					ElseIf  aCols[n][_nPosOper] ='18'//FEIRA/EXPOSICOES
						_cTes:=	 StOper18()
					ElseIf  aCols[n][_nPosOper] ='19'//BONIFICACAO
						_cTes:=	 StOper19()
					ElseIf  aCols[n][_nPosOper] ='20'//AMOSTRA GRATIS
						_cTes:=	 StOper20()
					ElseIf  aCols[n][_nPosOper] ='21'//MAT.PROPAGANDA
						_cTes:=	 StOper21()
					ElseIf  aCols[n][_nPosOper] ='22'//INDUSTRIALIZAÇÃO PARA OUTRA EMPRESA
						_cTes:=	 StOper22()
					ElseIf  aCols[n][_nPosOper] ='23'//REMESSA DE BRINDES C/ICMS
						_cTes:=	 StOper23()
					ElseIf  aCols[n][_nPosOper] ='24'
						_cTes:=	 StOper24()
					ElseIf  aCols[n][_nPosOper] ='25'//VENDA DE SUCATA (NÃO ATUA.ESTOQUE)
						_cTes:=	 StOper25()
					ElseIf  aCols[n][_nPosOper] ='26'//REMESSA DE BRINDES S/ICMS
						_cTes:=	 StOper26()
					ElseIf  aCols[n][_nPosOper] ='27'//RETORNO VASILHAME
						_cTes:=	 StOper27()
					ElseIf  aCols[n][_nPosOper] ='28'//REMESSA MERCADORIA FALTANTE
						_cTes:=	 StOper28()
					ElseIf  aCols[n][_nPosOper] ='29'//BONIFICACAO
						_cTes:=	 StOper29()
					// Ticket 20201203011728
					ElseIf  aCols[n][_nPosOper] ='30'//VENDA POR CONSIGNACAO
						_cTes:=	 StOper30()
					ElseIf  aCols[n][_nPosOper] ='31'//doação
						_cTes:=	 StOper31()
					ElseIf  aCols[n][_nPosOper] ='32'//VENDA DO ATIVO
						_cTes:=	 StOper32()
					ElseIf  aCols[n][_nPosOper] ='33'//retorno comodato
						_cTes:=	 StOper33()
					ElseIf  aCols[n][_nPosOper] ='34'//REM.P/TROCA
						_cTes:=	 StOper34()
					ElseIf  aCols[n][_nPosOper] ='35'//DEV.REM.P/TROCA
						_cTes:=	 StOper35()
					ElseIf  aCols[n][_nPosOper] ='36'//DEV.REM.P/CONSERTO- CONSUMOS
						_cTes:=	 StOper36()
					ElseIf  aCols[n][_nPosOper] ='37'//REMESSA P/ CONSERTO
						_cTes:=	 StOper37()
					ElseIf  aCols[n][_nPosOper] ='38'//VENDA A ORDEM
						_cTes:=	 StOper38()
					ElseIf  aCols[n][_nPosOper] ='39'//REM POR CONTA E ORDEM -CFOP 5923/6923
						_cTes:=	 StOper39()
					ElseIf  aCols[n][_nPosOper] ='40'//ENT.FUTURA-VENDA
						_cTes:=	 StOper40()
					ElseIf  aCols[n][_nPosOper] ='41'//ENT.FUTURA-REMESSA
						_cTes:=	 StOper41()
					ElseIf  aCols[n][_nPosOper] ='42'//TRANSFERENCIA DE SALDO C/D
						_cTes:=	 StOper42()
					ElseIf  aCols[n][_nPosOper] ='43'//Remessa de Industrialização - não estava sendo utilizada a 43, ajustei pra usar essa
						_cTes:=	 StOper43()
					ElseIf  aCols[n][_nPosOper] ='45'//TRANSFERENCIA DE ATIVO
						_cTes:=	 StOper45()
					ElseIf  aCols[n][_nPosOper] ='46'//VENDA FUNDACAO
						_cTes:=	 StOper46()
					ElseIf  aCols[n][_nPosOper] ='47'//VENDA TRANSPORTE PUBLICO
						_cTes:=	 StOper47()
					ElseIf  aCols[n][_nPosOper] ='48'//TRANSF USO E CONSUMO
						_cTes:=	 StOper48()
					ElseIf  aCols[n][_nPosOper] ='49'//RETORNO LOCAÇÃO
						_cTes:=	 StOper49()
					ElseIf  aCols[n][_nPosOper] ='51'// REMESSA PARA DESCARTE
						_cTes:=	 StOper51()
					ElseIf  aCols[n][_nPosOper] ='52'//REM.ATIVO IMOB.USO FORA DO ESTABECIMENTO
						_cTes:=	 StOper52()
					ElseIf  aCols[n][_nPosOper] ='53'//RET.DEMONSTRAÇÃO C/IPI E ICMS
						_cTes:=	 StOper53()
					ElseIf  aCols[n][_nPosOper] ='54'//RET.DEMONSTRAÇÃO C/ICMS
						_cTes:=	 StOper54()
					ElseIf  aCols[n][_nPosOper] ='55'//RET.DEMONSTRAÇÃO S/IPI E ICMS
						_cTes:=	 StOper55()
					ElseIf  aCols[n][_nPosOper] ='57'//DEVOL ATIVO  C/ IPI E ICMS
						_cTes:=	 StOper57()
					ElseIf  aCols[n][_nPosOper] ='58'//DEVOL ATIVO  C/ ICMS
						_cTes:=	 StOper58()
					ElseIf  aCols[n][_nPosOper] ='59'//DEVOL ATIVO  S/ ICMS
						_cTes:=	 StOper59()
					ElseIf  aCols[n][_nPosOper] ='60'//DEV. MAT.PRIMA -  C/ IPI E ICMS
						_cTes:=	 StOper60()
					ElseIf  aCols[n][_nPosOper] ='61'//DEV. MAT.PRIMA C/ICMS
						_cTes:=	 StOper61()
					ElseIf  aCols[n][_nPosOper] ='62'//DEV. MAT.PRIMA S/ICMS
						_cTes:=	 StOper62()
					ElseIf  aCols[n][_nPosOper] ='63'//DEVOL.USO CONS C/ IPI E ICMS
						_cTes:=	 StOper63()
					ElseIf  aCols[n][_nPosOper] ='64'//DEVOL.USO CONS C/ICMS
						_cTes:=	 StOper64()
					ElseIf  aCols[n][_nPosOper] ='65'//DEVOL.USO CONS S/ICMS
						_cTes:=	 StOper65()
					ElseIf  aCols[n][_nPosOper] ='66'//COMPL ICMS CFOP 5401
						_cTes:=	 StOper66()
					ElseIf  aCols[n][_nPosOper] ='67'//COMPL ICMS CFOP 5403 // Regra excluída a pedido da Veronica Chamado 004748
						_cTes:=	 StOper67()
					ElseIf  aCols[n][_nPosOper] ='68'//COMPL ICMS ST CFOP 5101
						_cTes:=	 StOper68()
					ElseIf  aCols[n][_nPosOper] ='69'//COMPL ICMS ST CFOP 5102
						_cTes:=	 StOper69()
					ElseIf  aCols[n][_nPosOper] ='70'//RETORNO COMODATO
						_cTes:=	 StOper70()
					ElseIf  aCols[n][_nPosOper] ='71'//VENDAS - FAB.MAT.INF. (RE ICMS)
						_cTes:=	 StOper71()
					ElseIf  aCols[n][_nPosOper] ='72'//SINISTRO
						_cTes:=	 StOper72()
					ElseIf  aCols[n][_nPosOper] ='73'//VENDA - FAB.MAT INFORMATICA
						_cTes:=	 StOper73()
					ElseIf  aCols[n][_nPosOper] ='74'//REMESSA P/ INDUTRIALIZACAO
						_cTes:=	 StOper74()
					ElseIf  aCols[n][_nPosOper] ='75'//REMESSA P/ INDUTRIALIZACAO sem movimentar estoque
						_cTes:=	 StOper75()
					ElseIf  aCols[n][_nPosOper] ='76'//MUDANÇA DE ENDEREÇO
						_cTes:=	 StOper76()
					ElseIf  aCols[n][_nPosOper] ='77'//VENDA - FABR. MAT. P/ VEICULOS
						_cTes:=	 StOper77()
					ElseIf  aCols[n][_nPosOper] ='78'//VENDA ESTALEIRO
						_cTes:=	 StOper78()
					ElseIf  aCols[n][_nPosOper] ='79'//DEVOL.USO CONS C/ IPI E ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 StOper79()
					ElseIf  aCols[n][_nPosOper] ='80'//DEVOL.USO CONS C/ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 StOper80()
					ElseIf  aCols[n][_nPosOper] ='81'//DEVOL.USO CONS S/ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 StOper81()
					ElseIf  aCols[n][_nPosOper] ='82'//DEVOL ATIVO  S/ ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 StOper82()
					ElseIf  aCols[n][_nPosOper] ='83'//DEVOL ATIVO  C/ IPI E ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 StOper83()
					ElseIf  aCols[n][_nPosOper] ='84'//DEVOL ATIVO  C/ ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 StOper84()
					ElseIf  aCols[n][_nPosOper] ='85'//VENDA SP/MA -> STECK AM
						_cTes:=	 StOper85()
					ElseIf  aCols[n][_nPosOper] ='86'//MUDANÇA DE ENDEREÇO
						_cTes:=	 StOper86()
					ElseIf  aCols[n][_nPosOper] ='87'//RET INDL
						_cTes:=	 StOper87()
					ElseIf  aCols[n][_nPosOper] ='88'//TRANSF. ENTRE FILIAIS (ATUA.ESTOQUE & GERA O.S.)
						_cTes:=	 StOper88()
					ElseIf  aCols[n][_nPosOper] ='89'//REMESSA DE MERCADORIA FALTANTE (ATU ESTOQUE)
						_cTes:=	 StOper89()
					ElseIf  aCols[n][_nPosOper] ='90'//VENDA - REPENEC
						_cTes:=	 StOper90()
					ElseIf  aCols[n][_nPosOper] ='91'//ANULAÇÃO DE VALORES REF AQUISIÇÃO DE SERVIÇO DE TRANSPORTE
						_cTes:=	 StOper91()
					ElseIf  aCols[n][_nPosOper] ='92'//TRANSF. ENTRE FILIAIS  GERA OS  RETRABALHO
						_cTes:=	 StOper92()
					ElseIf  aCols[n][_nPosOper] ='93'//INDUSTRIALIZAÇÃO PARA OUTRA EMPRESA
						_cTes:=	 StOper93()
					ElseIf  aCols[n][_nPosOper] ='94'//TRANSF. ENTRE FILIAIS  (N/ GERA O.S.)
						_cTes:=	 StOper94()
					ElseIf  aCols[n][_nPosOper] ='95'//REM POR CONTA E ORDEM
						_cTes:=	 StOper95()
					ElseIf  aCols[n][_nPosOper] ='96'//TRANSF. ENTRE FILIAIS (NÃO ATUA.ESTOQUE)
						_cTes:=	 StOper96()
					ElseIf  aCols[n][_nPosOper] ='97'//VENDA COPA
						_cTes:=	 StOper97()
					ElseIf  aCols[n][_nPosOper] ='98'//VENDA - MATL USO E CONSUMO
						_cTes:=	 StOper98()
					ElseIf  aCols[n][_nPosOper] ='99'//VENDA - MATL USO E CONSUMO (NÃO ATUA.ESTOQUE)
						_cTes:=	 StOper99()
					ElseIf  aCols[n][_nPosOper] ='0A'// COMPLEMENTO DE IPI CFOP 5401
						_cTes:=	 StOper0A()
					ElseIf  aCols[n][_nPosOper] ='0B'// COMPLEMENTO DE IPI CFOP 5101
						_cTes:=	 StOper0B()
					ElseIf aCols[n][_nPosOper] = "0E" //REMESSA EMPRESTIMO DE ATIVO 
						_cTes:=	 StOper0E()
					Endif

				ElseIf cEmpAnt == '03'//STECK MANAUS
					If  	aCols[n][_nPosOper] $ '01'//VENDAS NACIONAIS
						_cTes:=	 AmOper01()
					ElseIf  aCols[n][_nPosOper] ='02'//VENDA SUCATA C/DIFEREIMENTO
						_cTes:=	 AmOper02()
					ElseIf  aCols[n][_nPosOper] ='03'//VENDA SUCATA S/DIFEREIMENTO
						_cTes:=	 AmOper03()
					ElseIf  aCols[n][_nPosOper] ='04'//REMESSA PARA COMODATO
						_cTes:=	 AmOper04()
					ElseIf  aCols[n][_nPosOper] ='05'//REM.P/CONSERTO
						_cTes:=	 AmOper05()
					ElseIf  aCols[n][_nPosOper] ='06'//REMESSA P/ INDUSTRIALIZACAO
						_cTes:=	 AmOper06()
					ElseIf  aCols[n][_nPosOper] ='07'//DEV. MAT.PRIMA S/ICMS
						_cTes:=	 AmOper07()
					ElseIf  aCols[n][_nPosOper] ='08'//DEV. MAT.PRIMA C/ICMS
						_cTes:=	 AmOper08()
					ElseIf  aCols[n][_nPosOper] ='09'//VENDAS Mat. Prima
						_cTes:=	 AmOper09()
					ElseIf  aCols[n][_nPosOper] ='10'//REMESSA PARA TESTE
						_cTes:=	 AmOper10()
					ElseIf  aCols[n][_nPosOper] ='11'//DEVOL.USO CONS C/ICMS
						_cTes:=	 AmOper11()
					ElseIf  aCols[n][_nPosOper] ='12'//VENDA DO ATIVO
						_cTes:=	 AmOper12()
					ElseIf  aCols[n][_nPosOper] ='13'//COMPL ICMS CFOP 5401
						_cTes:=	 AmOper13()
					ElseIf  aCols[n][_nPosOper] ='14'//COMPL ICMS  CFOP 5101
						_cTes:=	 AmOper14()
					ELSEIf aCols[n][_nPosOper] = '15' // ESCOAMENTO DE PRODUÇÃO
						_cTes:=	 AmOper15()
					ElseIf  aCols[n][_nPosOper] ='16'//BONIFICACAO
						_cTes:=	 AmOper16()
					ElseIf  aCols[n][_nPosOper] ='17'//AMOSTRA GRATIS
						_cTes:=	 AmOper17()
					ElseIf  aCols[n][_nPosOper] ='18'//DEVOL.USO CONS C/ IPI E ICMS
						_cTes:=	 AmOper18()
					ElseIf  aCols[n][_nPosOper] ='19'//ANULAÇÃO DE VALORES REF AQUISIÇÃO DE SERVIÇO DE TRANSPORTE
						_cTes:=	 AmOper19()
					ElseIf  aCols[n][_nPosOper] ='20'//COMPLEMENTO DE PRECO
						_cTes:=	 AmOper20()
					ElseIf  aCols[n][_nPosOper] ='21'//COMPL.  PRECO DESCONTO ZONA FRANCA CFOP 5401
						_cTes:=	 AmOper21()
					ElseIf  aCols[n][_nPosOper] ='22'//COMPL ICMS VEND C/ST
						_cTes:=	 AmOper22()
					ElseIf  aCols[n][_nPosOper] ='23'//RETORNO LOCAÇÃO
						_cTes:=	 AmOper23()
					ElseIf  aCols[n][_nPosOper] ='24'//VENDA - MATL USO E CONSUMO c/ estoque
						_cTes:=	 AmOper24()
					ElseIf  aCols[n][_nPosOper] ='25'//VENDA - MATL USO E CONSUMO s/ estoque
						_cTes:=	 AmOper25()
					ElseIf  aCols[n][_nPosOper] ='26'//REMESSA PARA DESTRUIÇÃO
						_cTes:=	 AmOper26()
					ElseIf  aCols[n][_nPosOper] ='27'// RET.DEMONSTRAÇÃO S/ICMS
						_cTes:=	 AmOper27()
					ElseIf  aCols[n][_nPosOper] ='28'// RETORNO DE COMODATO
						_cTes:=	 AmOper28()
					ElseIf  aCols[n][_nPosOper] ='29'// VENDA SUCATA COM DIFEREIMENTO C/ ESTOQUE
						_cTes:=	 AmOper29()
					ElseIf  aCols[n][_nPosOper] ='30'// VENDA SUCATA SEM DIFEREIMENTO C/ ESTOQUE
						_cTes:=	 AmOper30()
					ElseIf  aCols[n][_nPosOper] ='31'// DEVOL ATIVO  COM ICMS S/ ESTOQUE
						_cTes:=	 AmOper31()
					ElseIf  aCols[n][_nPosOper] ='32'// DEVOL ATIVO  SEM ICMS S/ ESTOQUE
						_cTes:=	 AmOper32()
					ElseIf  aCols[n][_nPosOper] ='33'// DEVOLUÇÃO DE USO E CONSUMO
						_cTes:=	 AmOper33()
					ElseIf  aCols[n][_nPosOper] ='34'// RETORNO DE EMPRESTIMO
						_cTes:=	 AmOper34()
					ElseIf  aCols[n][_nPosOper] ='35'// DEVOLUÇÃO DE COMBUSTIVEL
						_cTes:=	 AmOper35()
					ElseIf  aCols[n][_nPosOper] ='36'// DEVOLUÇÃO DE USO E CONSUMO SEM ICMS S/ESTOQUE
						_cTes:=	 AmOper36()
					ElseIf  aCols[n][_nPosOper] ='37'// DEVOLUÇÃO DE USO E CONSUMO SEM ICMS C/ESTOQUE
						_cTes:=	 AmOper37()
					ElseIf  aCols[n][_nPosOper] ='38'// DECOLUÇÃO DE VASILHAME OU SACARIA
						_cTes:=	 AmOper38()	
					ElseIf  aCols[n][_nPosOper] ='39'// DOAÇÃO DE ATIVO
						_cTes:=	 AmOper39()
					ElseIf  aCols[n][_nPosOper] ='40'// 	SALVADOS DE  SINISTRO
						//Ticket - 20201210012053
						_cTes:=	 AmOper40()
					ElseIf  aCols[n][_nPosOper] ='41' //ENT.FUTURA-REMESSA
						//Ticket - 20220527011060
						_cTes:=	 AmOper41()
//					ElseIf aCols[n][_nPosOper] = "0E" //REMESSA EMPRESTIMO DE ATIVO 
//						_cTes:=	 AmOper0E()
					EndIf

				/**********************************
				<<< Alteração >> 
				Ação...........: Desenvolvimento de TES Inteligente específicas para a empresa "11 - NEWCO" 
				Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
				Data...........: 21/12/2021
				**********************************/
				ELSEIF cEmpAnt == "11"
					If  	aCols[n][_nPosOper] ='01'//VENDAS NACIONAIS
						_cTes:=	 NCOper01()
					ElseIf  aCols[n][_nPosOper] ='03'//RET.DEMONSTRAÇÃO C/IPI E ICMS ( ATUA.ESTOQUE)
						_cTes:=	 NCOper03()
					ElseIf  aCols[n][_nPosOper] ='05'//VENDA - DRAWBACK
						_cTes:=	 NCOper05()
					ElseIf  aCols[n][_nPosOper] ='07'//VENDAS RED B.CALCULO ICMS
						_cTes:=	 NCOper07()
					ElseIf  aCols[n][_nPosOper] ='08'//TRADING
						_cTes:=	 NCOper08()
					ElseIf  aCols[n][_nPosOper] ='09'//COMPLEMENTO DE PRECO
						_cTes:=	 NCOper09()
					// Ticket 20201203011728
					ElseIf  aCols[n][_nPosOper] ='10'// REMESSA PARA CONSIGNACAO
						_cTes:=	 NCOper10()
					ElseIf  aCols[n][_nPosOper] ='11'// REM INDUSTRIALIZAÇÃO POR CONTA E ORDEM
						_cTes:=	 NCOper11()
					ElseIf  aCols[n][_nPosOper] ='12'//DEMOSTRACAO
						_cTes:=	 NCOper12()
					ElseIf  aCols[n][_nPosOper] ='13'//MOSTRUARIO
						_cTes:=	 NCOper13()
					ElseIf  aCols[n][_nPosOper] ='14'//REMESSA PARA TESTE
						_cTes:=	 NCOper14()
					ElseIf  aCols[n][_nPosOper] ='15'//RETORNO TESTE
						_cTes:=	 NCOper15()
					ElseIf  aCols[n][_nPosOper] ='16'//Trasferências entre filiais (GUARAREMA)
						_cTes:=	 NCOper16()
					ElseIf  aCols[n][_nPosOper] ='17'//REM P/VASILHAME
						_cTes:=	 NCOper17()
					ElseIf  aCols[n][_nPosOper] ='18'//FEIRA/EXPOSICOES
						_cTes:=	 NCOper18()
					ElseIf  aCols[n][_nPosOper] ='19'//BONIFICACAO
						_cTes:=	 NCOper19()
					ElseIf  aCols[n][_nPosOper] ='20'//AMOSTRA GRATIS
						_cTes:=	 NCOper20()
					ElseIf  aCols[n][_nPosOper] ='21'//MAT.PROPAGANDA
						_cTes:=	 NCOper21()
					ElseIf  aCols[n][_nPosOper] ='22'//INDUSTRIALIZAÇÃO PARA OUTRA EMPRESA
						_cTes:=	 NCOper22()
					ElseIf  aCols[n][_nPosOper] ='23'//REMESSA DE BRINDES C/ICMS
						_cTes:=	 NCOper23()
					ElseIf  aCols[n][_nPosOper] ='24'
						_cTes:=	 NCOper24()
					ElseIf  aCols[n][_nPosOper] ='25'//VENDA DE SUCATA (NÃO ATUA.ESTOQUE)
						_cTes:=	 NCOper25()
					ElseIf  aCols[n][_nPosOper] ='26'//REMESSA DE BRINDES S/ICMS
						_cTes:=	 NCOper26()
					ElseIf  aCols[n][_nPosOper] ='27'//RETORNO VASILHAME
						_cTes:=	 NCOper27()
					ElseIf  aCols[n][_nPosOper] ='28'//REMESSA MERCADORIA FALTANTE
						_cTes:=	 NCOper28()
					ElseIf  aCols[n][_nPosOper] ='29'//BONIFICACAO
						_cTes:=	 NCOper29()
					// Ticket 20201203011728
					ElseIf  aCols[n][_nPosOper] ='30'//VENDA POR CONSIGNACAO
						_cTes:=	 NCOper30()
					ElseIf  aCols[n][_nPosOper] ='31'//doação
						_cTes:=	 NCOper31()
					ElseIf  aCols[n][_nPosOper] ='32'//VENDA DO ATIVO
						_cTes:=	 NCOper32()
					ElseIf  aCols[n][_nPosOper] ='33'//retorno comodato
						_cTes:=	 NCOper33()
					ElseIf  aCols[n][_nPosOper] ='34'//REM.P/TROCA
						_cTes:=	 NCOper34()
					ElseIf  aCols[n][_nPosOper] ='35'//DEV.REM.P/TROCA
						_cTes:=	 NCOper35()
					ElseIf  aCols[n][_nPosOper] ='36'//DEV.REM.P/CONSERTO- CONSUMOS
						_cTes:=	 NCOper36()
					ElseIf  aCols[n][_nPosOper] ='37'//REMESSA P/ CONSERTO
						_cTes:=	 NCOper37()
					ElseIf  aCols[n][_nPosOper] ='38'//VENDA A ORDEM
						_cTes:=	 NCOper38()
					ElseIf  aCols[n][_nPosOper] ='39'//REM POR CONTA E ORDEM -CFOP 5923/6923
						_cTes:=	 NCOper39()
					ElseIf  aCols[n][_nPosOper] ='40'//ENT.FUTURA-VENDA
						_cTes:=	 NCOper40()
					ElseIf  aCols[n][_nPosOper] ='41'//ENT.FUTURA-REMESSA
						_cTes:=	 NCOper41()
					ElseIf  aCols[n][_nPosOper] ='42'//TRANSFERENCIA DE SALDO C/D
						_cTes:=	 NCOper42()
					ElseIf  aCols[n][_nPosOper] ='43'//Remessa de Industrialização - não estava sendo utilizada a 43, ajustei pra usar essa
						_cTes:=	 NCOper43()
					ElseIf  aCols[n][_nPosOper] ='45'//TRANSFERENCIA DE ATIVO
						_cTes:=	 NCOper45()
					ElseIf  aCols[n][_nPosOper] ='46'//VENDA FUNDACAO
						_cTes:=	 NCOper46()
					ElseIf  aCols[n][_nPosOper] ='47'//VENDA TRANSPORTE PUBLICO
						_cTes:=	 NCOper47()
					ElseIf  aCols[n][_nPosOper] ='48'//TRANSF USO E CONSUMO
						_cTes:=	 NCOper48()
					ElseIf  aCols[n][_nPosOper] ='49'//RETORNO LOCAÇÃO
						_cTes:=	 NCOper49()
					ElseIf  aCols[n][_nPosOper] ='51'// REMESSA PARA DESCARTE
						_cTes:=	 NCOper51()
					ElseIf  aCols[n][_nPosOper] ='52'//REM.ATIVO IMOB.USO FORA DO ESTABECIMENTO
						_cTes:=	 NCOper52()
					ElseIf  aCols[n][_nPosOper] ='53'//RET.DEMONSTRAÇÃO C/IPI E ICMS
						_cTes:=	 NCOper53()
					ElseIf  aCols[n][_nPosOper] ='54'//RET.DEMONSTRAÇÃO C/ICMS
						_cTes:=	 NCOper54()
					ElseIf  aCols[n][_nPosOper] ='55'//RET.DEMONSTRAÇÃO S/IPI E ICMS
						_cTes:=	 NCOper55()
					ElseIf  aCols[n][_nPosOper] ='57'//DEVOL ATIVO  C/ IPI E ICMS
						_cTes:=	 NCOper57()
					ElseIf  aCols[n][_nPosOper] ='58'//DEVOL ATIVO  C/ ICMS
						_cTes:=	 NCOper58()
					ElseIf  aCols[n][_nPosOper] ='59'//DEVOL ATIVO  S/ ICMS
						_cTes:=	 NCOper59()
					ElseIf  aCols[n][_nPosOper] ='60'//DEV. MAT.PRIMA -  C/ IPI E ICMS
						_cTes:=	 NCOper60()
					ElseIf  aCols[n][_nPosOper] ='61'//DEV. MAT.PRIMA C/ICMS
						_cTes:=	 NCOper61()
					ElseIf  aCols[n][_nPosOper] ='62'//DEV. MAT.PRIMA S/ICMS
						_cTes:=	 NCOper62()
					ElseIf  aCols[n][_nPosOper] ='63'//DEVOL.USO CONS C/ IPI E ICMS
						_cTes:=	 NCOper63()
					ElseIf  aCols[n][_nPosOper] ='64'//DEVOL.USO CONS C/ICMS
						_cTes:=	 NCOper64()
					ElseIf  aCols[n][_nPosOper] ='65'//DEVOL.USO CONS S/ICMS
						_cTes:=	 NCOper65()
					ElseIf  aCols[n][_nPosOper] ='66'//COMPL ICMS CFOP 5401
						_cTes:=	 NCOper66()
					ElseIf  aCols[n][_nPosOper] ='67'//COMPL ICMS CFOP 5403 // Regra excluída a pedido da Veronica Chamado 004748
						_cTes:=	 NCOper67()
					ElseIf  aCols[n][_nPosOper] ='68'//COMPL ICMS ST CFOP 5101
						_cTes:=	 NCOper68()
					ElseIf  aCols[n][_nPosOper] ='69'//COMPL ICMS ST CFOP 5102
						_cTes:=	 NCOper69()
					ElseIf  aCols[n][_nPosOper] ='70'//RETORNO COMODATO
						_cTes:=	 NCOper70()
					ElseIf  aCols[n][_nPosOper] ='71'//VENDAS - FAB.MAT.INF. (RE ICMS)
						_cTes:=	 NCOper71()
					ElseIf  aCols[n][_nPosOper] ='72'//SINISTRO
						_cTes:=	 NCOper72()
					ElseIf  aCols[n][_nPosOper] ='73'//VENDA - FAB.MAT INFORMATICA
						_cTes:=	 NCOper73()
					ElseIf  aCols[n][_nPosOper] ='74'//REMESSA P/ INDUTRIALIZACAO
						_cTes:=	 NCOper74()
					ElseIf  aCols[n][_nPosOper] ='75'//REMESSA P/ INDUTRIALIZACAO sem movimentar estoque
						_cTes:=	 NCOper75()
					ElseIf  aCols[n][_nPosOper] ='76'//MUDANÇA DE ENDEREÇO
						_cTes:=	 NCOper76()
					ElseIf  aCols[n][_nPosOper] ='77'//VENDA - FABR. MAT. P/ VEICULOS
						_cTes:=	 NCOper77()
					ElseIf  aCols[n][_nPosOper] ='78'//VENDA ESTALEIRO
						_cTes:=	 NCOper78()
					ElseIf  aCols[n][_nPosOper] ='79'//DEVOL.USO CONS C/ IPI E ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 NCOper79()
					ElseIf  aCols[n][_nPosOper] ='80'//DEVOL.USO CONS C/ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 NCOper80()
					ElseIf  aCols[n][_nPosOper] ='81'//DEVOL.USO CONS S/ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 NCOper81()
					ElseIf  aCols[n][_nPosOper] ='82'//DEVOL ATIVO  S/ ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 NCOper82()
					ElseIf  aCols[n][_nPosOper] ='83'//DEVOL ATIVO  C/ IPI E ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 NCOper83()
					ElseIf  aCols[n][_nPosOper] ='84'//DEVOL ATIVO  C/ ICMS (NÃO ATUA.ESTOQUE)
						_cTes:=	 NCOper84()
					ElseIf  aCols[n][_nPosOper] ='85'//VENDA SP/MA -> STECK AM
						_cTes:=	 NCOper85()
					ElseIf  aCols[n][_nPosOper] ='86'//MUDANÇA DE ENDEREÇO
						_cTes:=	 NCOper86()
					ElseIf  aCols[n][_nPosOper] ='87'//RET INDL
						_cTes:=	 NCOper87()
					ElseIf  aCols[n][_nPosOper] ='88'//TRANSF. ENTRE FILIAIS (ATUA.ESTOQUE & GERA O.S.)
						_cTes:=	 NCOper88()
					ElseIf  aCols[n][_nPosOper] ='89'//REMESSA DE MERCADORIA FALTANTE (ATU ESTOQUE)
						_cTes:=	 NCOper89()
					ElseIf  aCols[n][_nPosOper] ='90'//VENDA - REPENEC
						_cTes:=	 NCOper90()
					ElseIf  aCols[n][_nPosOper] ='91'//ANULAÇÃO DE VALORES REF AQUISIÇÃO DE SERVIÇO DE TRANSPORTE
						_cTes:=	 NCOper91()
					ElseIf  aCols[n][_nPosOper] ='92'//TRANSF. ENTRE FILIAIS  GERA OS  RETRABALHO
						_cTes:=	 NCOper92()
					ElseIf  aCols[n][_nPosOper] ='93'//INDUSTRIALIZAÇÃO PARA OUTRA EMPRESA
						_cTes:=	 NCOper93()
					ElseIf  aCols[n][_nPosOper] ='94'//TRANSF. ENTRE FILIAIS  (N/ GERA O.S.)
						_cTes:=	 NCOper94()
					ElseIf  aCols[n][_nPosOper] ='95'//REM POR CONTA E ORDEM
						_cTes:=	 NCOper95()
					ElseIf  aCols[n][_nPosOper] ='96'//TRANSF. ENTRE FILIAIS (NÃO ATUA.ESTOQUE)
						_cTes:=	 NCOper96()
					ElseIf  aCols[n][_nPosOper] ='97'//VENDA COPA
						_cTes:=	 NCOper97()
					ElseIf  aCols[n][_nPosOper] ='98'//VENDA - MATL USO E CONSUMO
						_cTes:=	 NCOper98()
					ElseIf  aCols[n][_nPosOper] ='99'//VENDA - MATL USO E CONSUMO (NÃO ATUA.ESTOQUE)
						_cTes:=	 NCOper99()
					ElseIf  aCols[n][_nPosOper] ='0A'// COMPLEMENTO DE IPI CFOP 5401
						_cTes:=	 NcOper0A()
					ElseIf  aCols[n][_nPosOper] ='0B'// COMPLEMENTO DE IPI CFOP 5101
						_cTes:=	 NcOper0B()
					ELSEIF aCols[n][_nPosOper] = '0C'	// REMESSA DE MATERIAL FALTANTE NÃO ATUALIZA ESTOQUE
						_cTes:=	 NCOper0C()
					ElseIf aCols[n][_nPosOper] = "0E" //REMESSA EMPRESTIMO DE ATIVO 
						_cTes:=	 NCOper0E()
					ElseIf aCols[n][_nPosOper] = "0G" //REMESSA P/ MERCADO LIVRE
						_cTes:=	 NCOper0G()
					Endif
				EndIf
			EndIf
		Endif

		aCols[n][_nPosTes] := _cTes

		If IsInCallStack("U_STCADCOT") .or. IsInCallStack("U_STCONSCOT") .OR. IsInCallStack("POST") .OR. IsInCallStack("U_STCRM07A") .or. IsInCallStack("U_STCRM08A")
			lRest := .T.
			If !Empty(_cTes)
				_XTES := _cTes
			Endif 
			If Empty(Alltrim(aCols[n][_nPosTes]))			
				
				If !Empty(_XTES)
					aCols[n][_nPosTes] := _XTES
				Else
				cMsgRet := "Produto nao atende as novas regras de Tes Inteligente"
			Endif 		

		Endif 
		Endif 


		If Empty(Alltrim(aCols[n][_nPosTes])) .and. !(_lAtFis)
			//FR - 18/04/2022 - MSG RETORNO PARA API COTAÇÕES
			If !lRest
				AutoGrLog( "Produto nao atende as novas regras de Tes Inteligente")		//FR - 14/10/2021
				msginfo("Produto nao atende as novas regras de Tes Inteligente")			
			Endif 
			//FR - 18/04/2022 - MSG RETORNO PARA API COTAÇÕES

		Else
			dbSelectArea("SF4")
			SF4->(dbSetOrder(1))
			If _nPosCfo > 0 .And. MsSeek(xFilial("SF4")+_cTes)

				AAdd(_aDadosCfo,{"OPERNF"  , "S"        })
				AAdd(_aDadosCfo,{"TPCLIFOR", &_cCliTip  })
				AAdd(_aDadosCfo,{"UFDEST"  , &_cCliEst  })
				AAdd(_aDadosCfo,{"INSCR"   , &_cCliInscr})
				AAdd(_aDadosCfo,{"CONTR"   , If(_cTipoCF == "C", &_cCliContrib, "")})
				aCols[n][_nPosCfo] := MaFisCfo( ,SF4->F4_CF,_aDadosCfo )
			EndIf
		EndIf

		If !(_Lmomat)

			If MaFisFound("IT",N)
				MaFisAlt("IT_TES",_cTes,n)
				MaFisRef("IT_TES",_cProg,_cTes)
			EndIf

			//_oDlgDefault := GetWndDefault()
			//aEval(_oDlgDefault:aControls,{|x| x:Refresh()})
			/*
			If ( Type("l410Auto") == "U" .or. ! l410Auto)          //Inserido Jefferson Carlos dia 25/11/2013
				If !( oGetDad == Nil )                             //Inserido Jefferson Carlos dia 25/11/2013
			oDlg                      := GetWndDefault()   //Inserido Jefferson Carlos dia 25/11/2013
			oDlg := oGetDad:oWnd                           //Inserido Jefferson Carlos dia 25/11/2013
				EndIf                                              //Inserido Jefferson Carlos dia 25/11/2013
			EndIf
			*/
			If !(_lFis)
				Ma410Rodap(,,0)

				/*******************************************
				Ação...........: Não permite atualizar o Browse do pedido de venda se for chamado pela função MSTECK5B.
				...............: Esta é uma rotina de importação de itens de pedido via arquivo CSV.
				...............: Se atualizar no meio do processo de imput de informação o browse se perde.
				Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
				Data...........: 22/12/2021
				Chamado........: 20211203025898
				*******************************************/
				IF FWIsInCallStack("MSTECK5B") = .F.
					If ( Type("l410Auto") == "U" .OR. !l410Auto)
						oGetDad:oBrowse:Refresh()
					EndIf
				ENDIF
			EndIf
		Else

			If MaFisFound("IT",N) //Chamado 000050 - Erro no gatilho da TES Zona Franca
				MaFisAlt("IT_TES",_cTes,n)
				MaFisRef("IT_TES",_cProg,_cTes)
			EndIf

			Tk273Trigger()
			Tk273FRefresh()
			Tk273TlvImp()
		Endif
	EndIf

Return  (_lRet)




	/*====================================================================================\
	|Programa  | StOper01         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 01                                                    |
	|          |   01 - Vendas Nacionais                                                  |
	|=====================================================================================|
	|Sintaxe   | StOper01                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
Static Function StOper01()
	*-----------------------------*

	//Itens marcados na cor VERDE LIMÃO na Planilha Oficial de TES Inteligente
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		// regra de 01 à 06  e 37 à 47
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '558' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 01 / 37
				                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTIDA A TES ANTERIOR 558 ITEM DA PLANILHA 01 / 37
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '560' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 560 ITEM DA PLANILHA 02 / 38 
				                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTIDA A TES ANTERIOR 560 ITEM DA PLANILHA 02 / 38 
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '558' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 04 / 40 
				                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTIDA A TES ANTERIOR 558 ITEM DA PLANILHA 04 / 40 
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '501' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 501 ITEM DA PLANILHA 05 / 41
				                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTIDA A TES ANTERIOR 501 ITEM DA PLANILHA 05 / 41
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '506'
			EndIf

		ElseIf _cEst <> &_cCliEst


			If  !(Empty(ALLTRIM( &_cCliSufra)))

				If alltrim(&_cCliMun) $ ('04062') .And. &_cCliEst = 'AM' .and.  &_cCliCep = '069640970'	// regra  191 à 196 = 197 à 202

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
					EndIf


				ElseIf alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'	// regra  125 à 130 = 155 à 160

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '610' //Alterada a TES de 509 para 610 em 02/04/2013 solicitado por Verônica Brandão
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
					EndIf

				ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'	// regra  161 à 166 = 167 à 172

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '610'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '685'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '610'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '610'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '685'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
					EndIf



				ElseIf !(alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252')) .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  173 à 178 = 179 à 184

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '544'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '542'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '544'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '544'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '542'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '830'//Alterado por João Victor em 31/01/2014 de 585 para 830 conforme chamado 000139
					EndIf

				ElseIf alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252') .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  143 à 148 = 185 à 190

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '610'//TROCADO DE 509 PARA 610 SOLICITAÇÃO VERONICA BRANDAO .....giovani 23/04/2013
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '827'//Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
					EndIf

				EndIf

			Else	// regra  7 à 12 e 43 à 48
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '560'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '501'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '506'
				EndIf

			EndIf

		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))).And. ( &_cCliEst $ 'MG#PR')
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '872'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '873'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '872'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '872'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '874'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '875'
		EndIf



		//nova regra solicitada pela veronica em 07/12/18 - chamado 008623
	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))).And. ( &_cCliEst $ 'PE')
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '891'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '892'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '891'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '891'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '893'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '894'
		EndIf

		//Itens marcados na cor AZUL ESCURO na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))


		If !(Empty(ALLTRIM( &_cCliSufra)))

			If alltrim(&_cCliMun) $ ('04062') .And. &_cCliEst = 'AM' .and.  &_cCliCep = '069640970'	// regra  233 à 238 = 239 à 244

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'	// regra  131 à 136 = 203 à 208

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'	// regra  137 à 142  = 209 à 214

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252')) .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  221 à 226 = 227 à 232

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252') .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  149 à 154 = 215 à 220

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
				EndIf
			EndIf
		Else
			// regra de 13 à 18 e 61 à 66
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '558' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 13 / 61
					                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTER A TES ANTERIOR 558 ITEM DA PLANILHA 13 / 61
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '560' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 560 ITEM DA PLANILHA 14 / 62
					                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTER A TES ANTERIOR 560 ITEM DA PLANILHA 14 / 62
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '558' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 16 / 64
					                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTAR A TES ANTERIOR 558 ITEM DA PLANILHA 16 / 64
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '502' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 502 ITEM DA PLANILHA 17 / 65
					                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTER A TES ANTERIOR 502 ITEM DA PLANILHA 17 / 65
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '572'
				EndIf
				// regra 19 à 24 e 67 à 72 - Excluído chamado 002456
				// regra 67 à 72
			ElseIf _cEst <> &_cCliEst
				If !( &_cCliEst $ 'MG/RS/SC/BA/AL/AP/DF/ES/GO/PE/PR/RJ/SE') //.And.  !( &_cCliEst $ 'MG/RS/SC/BA')//Chamado 002456
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '560'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '502'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '572'
					EndIf
					// regra 19 à 24 //Chamado 002456 - Realizado ajuste nessa regra pois a mesma estava sendo considerada junto com a regra 67 à 72
				Else
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '560'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '502'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '572'
					EndIf
				EndIf

			EndIf
		Endif



		//Itens marcados na cor VINHO na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		If !(Empty(ALLTRIM( &_cCliSufra)))

			If alltrim(&_cCliMun) $ ('04062') .And. &_cCliEst = 'AM' .and.  &_cCliCep = '069640970'	// regra  245 à 250

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '578'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '503'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'	// regra  251 à 256

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '680'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '680' //Alterado em 30/04/2013 de 677 para 680 por João Victor conforme solicitação de Verônica Brandão.
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '829' //Alterado por João Victor em 31/01/2014 de 678 para 829 conforme chamado 000139
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'	// regra  257 à 262

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '680'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '680'//Alterado em 30/04/2013 de 677 para 680 por João Victor conforme solicitação de Verônica Brandão.
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '829' //Alterado por João Victor em 31/01/2014 de 678 para 829 conforme chamado 000139
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252')) .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  263 à 268

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '578'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '578'//Alterado em 30/04/2013 de 503 para 578 por João Victor conforme solicitação de Verônica Brandão.
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '831' //Alterado por João Victor em 31/01/2014 de 507 para 831 conforme chamado 000139
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252') .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  269 à 274

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '578'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '578'//Alterado em 30/04/2013 de 503 para 578 por João Victor conforme solicitação de Verônica Brandão.
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '831' //Alterado por João Victor em 31/01/2014 de 507 para 831 conforme chamado 000139
				EndIf


			EndIf
		Else

			// regra de 55 à 60
			//	If 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)) .And.  &_cCliEst $ 'BA' .And. !(&_cCliEst) $ 'MS'
			/*
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '639'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '721'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '639'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '595'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '591'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '592'
			EndIf

			*/ //chamado 001008 giovani zago 30/09/14
			// regra de 25 à 30 e de 93 à 98
			//ElseIf   _cEst = &_cCliEst
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '558' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 25 / 93 
					                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTER A TES ANTERIOR 558 ITEM DA PLANILHA 25 / 93 
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '560' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 560 ITEM DA PLANILHA 26 / 94
					                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTER A TES ANTERIOR 560 ITEM DA PLANILHA 26 / 94
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '558' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 28 / 96
					                   //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTER A TES ANTERIOR 558 ITEM DA PLANILHA 28 / 96
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '502' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 502 ITEM DA PLANILHA 29 / 97
					                   //// Alterado por Marcelo Klopfer - 22/03/2022 - MANTER A TES ANTERIOR 502 ITEM DA PLANILHA 29 / 97
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '572'
				EndIf

			ElseIf _cEst <> &_cCliEst /*.And. !(&_cCliEst) $ 'MS'*/	// regra de 31 à 36 e de 99 à 104
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '578'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '503'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '507'
				EndIf

				/*
			Elseif &_cCliEst $ 'MS' // regra de 287 à 292
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '639'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '721'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '639'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '595'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '591'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '592'
				EndIf
				*/ //chamado 001008 giovani zago 30/09/14
			EndIf
		EndIf





		//Itens marcados na cor VERDE ÁGUA na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))).And. ( &_cCliEst $ 'MG/RS/SC/BA/AL/AP/DF/ES/GO/PE/PR/RJ/SE')//( &_cCliEst $ 'MG/RS/SC/BA/AL/AP/DF/ES/GO/PE/PR/RJ/SE')CHAMADO VERONICA 21/06/17  //( &_cCliEst $ 'MG/RS/SC/BA')Chamado 002456
		DbSelectArea("SF7")
		SF7->(DbSetOrder(4))
		//SF7->(DbOrderNickName("NICKSF7"))
		//F7_FILIAL+F7_GRTRIB    +F7_GRPCLI     +F7_EST +F7_TIPOCLI
		//Filial   + Grupo Trib. + Grp.Cli./For + Estado+ Tipo do Cliente
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			// regra de 49 à 54
			If SF7->F7_MARGEM <> 0 
				If &_cCliEst <> 'MG'
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '924' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 639 ITEM DA PLANILHA 49 / 53
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '929' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 721 ITEM DA PLANILHA 49 / 53
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '639'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '924' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 639 ITEM DA PLANILHA 49 / 53
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '920' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 591 ITEM DA PLANILHA 49 / 53
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '592'
					EndIf

				EndIf

				// regra de 299 à 304 Chamado 002456
			ElseIf SF7->F7_MARGEM = 0
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '560'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '501'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '506'
				EndIf
			Endif

		Else
			// regra de 293 à 298 Chamado 002456
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '560'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '502'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '572'
			EndIf
		Endif


		//Itens marcados na cor LARANJA na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		DbSelectArea("SF7")
		//SF7->(DbOrderNickName("NICKSF7"))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))/* .And. (!(&_cCliEst = 'MT')*/ .And. !(&_cxCliContr $ '004/005/006/007')
			// regra de 73 à 78 e 105 à 110
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '513' 	//// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 513 ITEM DA PLANILHA 73 / 105
															//// Alterado por Marcelo Klopfer - 24/02/2022 - ALTERADO PARA VOLTAR A TES ANTERIOR 513 ITEM DA PLANILHA 73 / 105
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '513'  //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 513 ITEM DA PLANILHA 76 / 108
															//// Alterado por Marcelo Klopfer - 24/02/2022 - ALTERADO PARA VOLTAR A TES ANTERIOR 513 ITEM DA PLANILHA 73 / 105
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '513'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '543'
				//Chamado 003273
				ElseIf SB1->B1_CLAPROD = 'F' .AND. SB1->B1_IPI = 0 
					_cTes     := '559'  //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 559 ITEM DA PLANILHA 76 / 106
															//// Alterado por Marcelo Klopfer - 24/02/2022 - ALTERADO PARA VOLTAR A TES ANTERIOR 559 ITEM DA PLANILHA 76 / 106
				ElseIf SB1->B1_CLAPROD = 'F' .AND. SB1->B1_IPI <> 0 
					_cTes     := '504' 	//// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 504 ITEM DA PLANILHA 77 / 109
															//// Alterado por Marcelo Klopfer - 24/02/2022 - ALTERADO PARA VOLTAR A TES ANTERIOR 504 ITEM DA PLANILHA 77 / 109
						//	If SF7->F7_MARGEM <> 0
						///		If  SB1->B1_IPI <> 0
						///		ElseIf  SB1->B1_IPI = 0
						///		EndIf
						///	ElseIf SF7->F7_MARGEM = 0
						///		If  SB1->B1_IPI <> 0
						///			_cTes     := '504'
						///		ElseIf  SB1->B1_IPI = 0
						///			_cTes     := '560'
						///		EndIf
						////Endif
				EndIf
				// regra de 79 à 86 e 111 à 118
			ElseIf   _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '918' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 513 ITEM DA PLANILHA 79 / 111
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '918' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 513 ITEM DA PLANILHA 83 / 115
				ElseIf SB1->B1_CLAPROD = 'I'
					If SF7->F7_MARGEM <> 0
						If  SB1->B1_IPI <> 0
							_cTes     := '543'
						ElseIf  SB1->B1_IPI = 0
							_cTes     := '513'
						EndIf
					ElseIf SF7->F7_MARGEM = 0
						If  SB1->B1_IPI <> 0
							_cTes     := '506'
						ElseIf  SB1->B1_IPI = 0
							_cTes     := '558'
						EndIf
					EndIf
					//Chamado 003273
				ElseIf SB1->B1_CLAPROD = 'F'
					If SF7->F7_MARGEM <> 0
						If  SB1->B1_IPI <> 0
							_cTes     := '917'  //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 504 ITEM DA PLANILHA 84 / 116
						ElseIf  SB1->B1_IPI = 0
							_cTes     := '919' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 559 ITEM DA PLANILHA 80 / 112
						EndIf
					ElseIf SF7->F7_MARGEM = 0
						If  SB1->B1_IPI <> 0
							_cTes     := '501'
						ElseIf  SB1->B1_IPI = 0
							_cTes     := '560'
						EndIf
					EndIf
				EndIf
			EndIf

			// regra de 87 à 92 - Regra cancelada em 02/04/2013 por Verônica Brandão
			// regra de 87 à 92 - Regra reativada em 11/02/2015 por Verônica Brandão - chamado 001506
		Else
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '558' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 87
				                     //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTER A TES ANTERIOR 558 ITEM DA PLANILHA 87
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '560' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 560 ITEM DA PLANILHA 88
														 //// Alterado por Marcelo Klopfer - 21/03/2022 - MANTER TES ANTERIOR 560 ITEM DA PLANILHA 88
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '558' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 90
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '501' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 516 ITEM DA PLANILHA 91
														 //// Alterado por Marcelo Klopfer - 21/03/2022 - TES ANTERIOR 916 ITEM DA PLANILHA 91
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '506'
				EndIf

				//Else
				// regra de 275 à 280
			ElseIf   _cEst <> &_cCliEst
				If &_cCliEst = 'MT' .And. 	&_cxCliContr = '004' .And. Getmv('ST_MTSTOP',,.F.)// giovani zago 28/01/2020 ajuste do estado MT ticket 20200124000120
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '923' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 627 ITEM DA PLANILHA 275
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '927' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 621 ITEM DA PLANILHA 276
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '627'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '923' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 627 ITEM DA PLANILHA 278
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '922' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 626 ITEM DA PLANILHA 276
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '632' //ALTERADO DE 626 PARA 632  19/04/2013
					EndIf

					// regra de 281 à 286
				ElseIf &_cCliEst = 'MT' .And. 	&_cxCliContr $ '005/006/007' .And. Getmv('ST_MTSTOP',,.F.)// giovani zago 28/01/2020 ajuste do estado MT ticket 20200124000120
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '925' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 640 ITEM DA PLANILHA 281
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '928' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 682 ITEM DA PLANILHA 282
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '640'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '925' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 640 ITEM DA PLANILHA 284
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '926' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 641 ITEM DA PLANILHA 285
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '642'
					EndIf

				Else	// regra de 119 à 124

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '560'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '558' //Alterada a TES de 506 para 558 em 02/04/2013 solicitado por Verônica Brandão
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '501'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '506'
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf
Return  (_cTes)


	/*====================================================================================\
	|Programa  | StOper08         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 08                                                    |
	|          |   08 - Trading                                                           |
	|=====================================================================================|
	|Sintaxe   | StOper08                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper08()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 01 à 06 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
			//Regra de 07 à 12 e 31 à 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 19 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
		EndIf

	EndIf

	Return (_cTes)

	/*====================================================================================\
	|Programa  | StOper11         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 11                                                    |
	|          |   11 - REM INDUSTRIALIZAÇÃO POR CONTA E ORDEM                                                           |
	|=====================================================================================|
	|Sintaxe   | StOper11                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper11()
	*-----------------------------*


	_cTes     := '836'


	Return (_cTes)

	/*====================================================================================\
	|Programa  | StOper12         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 12                                                    |
	|          |   12 - DEMOSTRACAO                                                       |
	|=====================================================================================|
	|Sintaxe   | StOper12                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper12()
	*-----------------------------*

	// regra de 01 à 12
	If  &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '651'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '651'
		EndIf
		// regra de 13 à 24
	ElseIf  &_cTipoCli = 'F' .And. &_cCliContrib = '2'
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '576'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '576'
		EndIf
	Endif

	Return  (_cTes)

	/*====================================================================================\
	|Programa  | StOper36         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 36                                                    |
	|          |   36 - DEV.REM.P/CONSERTO- CONSUMOS                                      |
	|=====================================================================================|
	|Sintaxe   | StOper36                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper36()
	*-----------------------------*

	// regra de 01 à 06
	If  &_cTipoCli = 'F'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '527'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '527'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '527'
		EndIf
	Endif

	Return  (_cTes)




	/*====================================================================================\
	|Programa  | StOper37         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 37                                                    |
	|          |   37 - REMESSA P/ CONSERTO                                               |
	|=====================================================================================|
	|Sintaxe   | StOper37                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper37()
	*-----------------------------*

	// regra de 01 à 06
	If  &_cTipoCli = 'F'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '526'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '526'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '526'
		EndIf
	Endif

	Return  (_cTes)






	/*====================================================================================\
	|Programa  | StOper46         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 46                                                    |
	|          |   46 - VENDA FUNDACAO                                                    |
	|=====================================================================================|
	|Sintaxe   | StOper46                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper46()
	*-----------------------------*

	//Regra de 01 à 12 -> Alterado o Tipo de Cliente do Cadastro de Cliente e do Pedidos de Venda de R=REVENDEDOR para F=CONSUMIDOR FINAL em 08/05/2013 solicitado por Verônica Brandão
	//Regra de 01 à 12 -> Alterado o Tipo de Cliente do Cadastro de Cliente e do Pedidos de Venda de F=CONSUMIDOR FINAL para R=REVENDEDOR e contribuinte de NÃO para SIM  em 15/05/2013 solicitado por Verônica Brandão
	// regra de 01 à 12
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. &_cAtividade = '000054'.And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')
		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '619'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '720'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '619'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '720'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'R' .And. &_cCliContrib = '2' .And. &_cAtividade = '000054' .And. &_cTipopv $ ('N')
		//Regra de 13 à 18
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '619'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '720'
			EndIf

			//Regra de 19 à 24
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '813'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '812'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '813'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '813'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '811'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '814'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper73         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 73                                                    |
	|          |   73 - VENDA - FAB.MAT INFORMATICA                                       |
	|=====================================================================================|
	|Sintaxe   | StOper73                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper73()
	*-----------------------------*

	If &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. &_cAtividade = '000007'.And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		//Regra de 01 à 06
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '560'//Alterada a TES de 705 para 752 em 15/05/2013 solicitado por Verônica Brandão//Alterada a TES de 752 para 560 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '549'//Alterada a TES de 548 para 549 em 15/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '560'//Alterada a TES de 705 para 752 em 15/05/2013 solicitado por Verônica Brandão//Alterada a TES de 752 para 560 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '548'
			EndIf
			//Regra de 07 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '560'//Alterada a TES de 705 para 752 em 15/05/2013 solicitado por Verônica Brandão//Alterada a TES de 752 para 560 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '549'//Alterada a TES de 548 para 549 em 15/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '560'//Alterada a TES de 705 para 752 em 15/05/2013 solicitado por Verônica Brandão//Alterada a TES de 752 para 560 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '548'
			EndIf
		Endif

	Elseif &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. &_cAtividade = '000007'.And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		//Regra de 13 à 18
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '548'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '502'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '572'//Alterada a TES de 754 para 572 em 20/05/2013 solicitado por André Almeida
			EndIf
			//Regra de 19 à 24
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '548'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '502'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '572'//Alterada a TES de 754 para 572 em 20/05/2013 solicitado por André Almeida
			EndIf
		Endif
	Endif

	Return  (_cTes)


	/* Regra cancelada em 15/05/2013 por João Victor devido a solicitação de Verônica Brandão
	// regra de 01 à 12
	If  &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. &_cAtividade = '000007' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
	DbSelectArea("SF7")
	SF7->(DbOrderNickName("NICKSF7"))
		If !SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
	_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
	_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
	_cTes     := '548'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
	_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
	_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
	_cTes     := '548'
			EndIf
		Endif
	Endif
	*/



	/*====================================================================================\
	|Programa  | StOper74         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 74                                                    |
	|          |   74 - REMESSA P/ INDUTRIALIZACAO                                        |
	|=====================================================================================|
	|Sintaxe   | StOper74                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper74()
	*-----------------------------*

	// regra de 01 à 03
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '518'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '518'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '518'
			EndIf
			// regra de 04 à 06
		Elseif _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '518'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '518'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '518'
			EndIf
		Endif
	Endif

	Return  (_cTes)


	/*====================================================================================\
	|Programa  | StOper78         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 78                                                    |
	|          |   78 - VENDA ESTALEIRO                                                   |
	|=====================================================================================|
	|Sintaxe   | StOper78                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper78()
	*-----------------------------*

	// regra de 01 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cAtividade = '000008' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cZconsum = '2'
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '795'//Alterada a TES de 618 para 795 em 13/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '795'//Alterada a TES de 618 para 795 em 13/06/2013 solicitado por Verônica Brandão
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '795'//Alterada a TES de 618 para 795 em 13/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '795'//Alterada a TES de 618 para 795 em 13/06/2013 solicitado por Verônica Brandão
			EndIf
		Endif
		//Regra de 13 à 24
	ElseIf  &_cTipoCli = 'F' .And. &_cCliContrib = '2' .And. &_cAtividade = '000008' .And. &_cZconsum = '2'
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '795'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '794'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '793'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '794'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '794'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '793'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '796'
			EndIf
		Endif
	ElseIf &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. &_cAtividade = '000008' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cZconsum = '1'
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '795'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '795'
			EndIf
		Endif
	Endif


	Return  (_cTes)




	/*====================================================================================\
	|Programa  | StOper88         | Autor | GIOVANI.ZAGO             | Data | 10/09/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 88                                                    |
	|          |   88 - TRANSF. ENTRE FILIAIS  GERA OS                                    |
	|=====================================================================================|
	|Sintaxe   | StOper88                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper88()
	*-----------------------------*

	// regra de 01 à 03
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (_cEst = &_cCliEst) .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '664'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '663'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '664'
		Endif
	Endif

	Return  (_cTes)

	/*====================================================================================\
	|Programa  | StOper94         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 94                                                    |
	|          |   94 - TRANSF. ENTRE FILIAIS                                             |
	|=====================================================================================|
	|Sintaxe   | StOper94                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper94()
	*-----------------------------*

	// regra de 01 à 03
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			// regra de 01 à 03
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '664'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '848'//Chamado 002252 Alterar de TES 663 para TES 848
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '664'
				// regra de 04 à 06 - Chamado 002252
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '664'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '663'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '664'
			EndIf
		Endif
	ELSEIF  &_cTipoCli = 'S' 
		////.And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If _cEst = &_cCliEst
			// regra de 01 à 03
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '664'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '848'//Chamado 002252 Alterar de TES 663 para TES 848
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '664'
				// regra de 04 à 06 - Chamado 002252
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '664'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '663'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '664'
			EndIf
		Endif
	Endif

	Return  (_cTes)


	/*====================================================================================\
	|Programa  | StOper95         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 95                                                    |
	|          |   95 - REM POR CONTA E ORDEM                                             |
	|=====================================================================================|
	|Sintaxe   | StOper95                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper95()
	*-----------------------------*

	// regra de 01 à 06
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '581'
		Endif

		//regra de 07 à 12
	Elseif &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '581'
		Endif

		//regra de 13 à 18
	Elseif &_cTipoCli = 'F' .And. &_cCliContrib = '2'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '581'
		Endif

		//regra de 19 à 24
	Elseif &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '581'
		Endif

	Endif
	Return  (_cTes)


	/*====================================================================================\
	|Programa  | StOper28         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 28                                                    |
	|          |   28 -    REMESSA MERCADORIA FALTANTE                                          |
	|=====================================================================================|
	|Sintaxe   | StOper28                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper28()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '933'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 901 ITEM DA PLANILHA 01 / 25
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '933'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 901 ITEM DA PLANILHA 04 / 28
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '902'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '902'
			EndIf

			//Regra de 7 à 12 e 31 à 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '902'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '902'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '933'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 901 ITEM DA PLANILHA 13 / 37
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '933' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 901 ITEM DA PLANILHA 16 / 40
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '898'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '898'
			EndIf

			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '898'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '898'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '933' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 901 ITEM DA PLANILHA 49
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '933'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 901 ITEM DA PLANILHA 52
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '898'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '898'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '901'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '898'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '898'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '933' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 900 ITEM DA PLANILHA 61
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '900'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '900'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '900'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 900 ITEM DA PLANILHA 64
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '899'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '899'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '900'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '900'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '900'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '900'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '899'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '899'
			EndIf
		EndIf


	EndIf
	Return  (_cTes)


	/*====================================================================================\
	|Programa  | StOper66         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 66                                                    |
	|          |   66 - COMPL ICMS CFOP 5401                                              |
	|=====================================================================================|
	|Sintaxe   | StOper66                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper66()
	*-----------------------------*

	//Regra de 1 à 6
	If  &_cTipoCli = 'S'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '707'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '603'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '707'
		Endif
	Endif

	Return  (_cTes)


	/*====================================================================================\
	|Programa  | StOper67         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 67                                                    |
	|          |   67 - COMPL ICMS CFOP 5403                                              |
	|=====================================================================================|
	|Sintaxe   | //Solicitado exclusão de regra pela senhora Veronica Brandão chamado 004748                                                             |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
	Static Function StOper67()
	*-----------------------------*

	If  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) <> '1'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		DbSelectArea("SF7")
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//			If SF7->F7_MARGEM <> 0
//				IF	_cEst = &_cCliEst
//					If SB1->B1_CLAPROD = 'C'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//					If SB1->B1_CLAPROD = 'F'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//					If SB1->B1_CLAPROD = 'I'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//				Else
//					If SB1->B1_CLAPROD = 'C'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//					If SB1->B1_CLAPROD = 'F'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//					If SB1->B1_CLAPROD = 'I'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//				EndIf
//			Else
//				If EMPTY(SB1->B1_GRTRIB)
//					IF	_cEst = &_cCliEst
//						If SB1->B1_CLAPROD = 'C'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//						If SB1->B1_CLAPROD = 'F'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//						If SB1->B1_CLAPROD = 'I'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//					Else
//						If SB1->B1_CLAPROD = 'C'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//						If SB1->B1_CLAPROD = 'F'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//						If SB1->B1_CLAPROD = 'I'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//					EndIf
//				Else
//					IF	_cEst = &_cCliEst
//						If SB1->B1_CLAPROD = 'C'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//						If SB1->B1_CLAPROD = 'F'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//						If SB1->B1_CLAPROD = 'I'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//					Else
//						If SB1->B1_CLAPROD = 'C'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//						If SB1->B1_CLAPROD = 'F'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//						If SB1->B1_CLAPROD = 'I'
//							If SB1->B1_IPI = 0
//								_cTes := ""
//							Else
//								_cTes := ""
//							EndIf
//						EndIf
//					EndIf
//				EndIf
//			EndIf
		Else
			If EMPTY(SB1->B1_GRTRIB)
				IF	_cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := ""
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := ""
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := ""
						EndIf
					EndIf
				Else
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := ""
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := ""
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := ""
						EndIf
					EndIf
				EndIf
//			Else
//				IF	_cEst = &_cCliEst
//					If SB1->B1_CLAPROD = 'C'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//					If SB1->B1_CLAPROD = 'F'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//					If SB1->B1_CLAPROD = 'I'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//				Else
//					If SB1->B1_CLAPROD = 'C'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//					If SB1->B1_CLAPROD = 'F'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//					If SB1->B1_CLAPROD = 'I'
//						If SB1->B1_IPI = 0
//							_cTes := ""
//						Else
//							_cTes := ""
//						EndIf
//					EndIf
//				EndIf
			EndIf
		EndIf
	EndIf

	Return  (_cTes)



	/*====================================================================================\
	|Programa  | StOper68         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 68                                                    |
	|          |   68 - COMPL ICMS ST CFOP 5101                                           |
	|=====================================================================================|
	|Sintaxe   | StOper68                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper68()
	*-----------------------------*

	//Regra de 1 à 6
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '657'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '657'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '657'
		Endif

		//Regra de 7 à 12
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '657'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '657'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '657'
		Endif

	Endif

	Return (_cTes)

	/*====================================================================================\
	|Programa  | StOper69         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 69                                                    |
	|          |   69 - COMPL ICMS ST CFOP 5102                                           |
	|=====================================================================================|
	|Sintaxe   | StOper69                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper69()
	*-----------------------------*

	//Regra de 1 à 6
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '659'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '659'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '659'
		Endif

		//	Regra de 7 à 12
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '659'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '659'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '659'
		Endif

	Endif

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper32         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 32                                                    |
	|          |   32 - VENDA DO ATIVO                                                    |
	|=====================================================================================|
	|Sintaxe   | StOper32                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper32()
	*-----------------------------*

	//Das regras de 01 à 60 -> Alterada a TES de 531 para 692 em 08/05/2013 solicitado por Verônica Brandão
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 01 à 06 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
			//Regra de 07 à 12 e 31 à 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 19 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'S' .And. AllTrim(&_cZconsum) = ''  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper75         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 75                                                    |
	|          |   75 - remessa sem movimentar estoque                                    |
	|=====================================================================================|
	|Sintaxe   | StOper75                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper75()
	*-----------------------------*

	//Regra de 1 à 2
	_cTes     := '687'


	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper13         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 13                                                    |
	|          |   13 - MOSTRUARIO                                                        |
	|=====================================================================================|
	|Sintaxe   | StOper13                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper13()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 01 à 06 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '545'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '545'
			EndIf
			//Regra de 07 à 12 e 31 à 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '545'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '545'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			EndIf
			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			EndIf
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper18         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 18                                                    |
	|          |   18 - FEIRA/EXPOSICOES                                                  |
	|=====================================================================================|
	|Sintaxe   | StOper18                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper18()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 01 à 06 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
			//Regra de 07 à 12 e 31 à 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
		EndIf

	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper19         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 19                                                    |
	|          |   19 - BONIFICACAO                                                       |
	|=====================================================================================|
	|Sintaxe   | StOper19                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper19()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 01 / 25
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 04 / 28
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 13 / 37
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 16 / 40
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '520'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '520'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '520'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '520'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 49
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 52
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '520'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '520'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '569'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '520'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '520'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 598 ITEM DA PLANILHA 61
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '598'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '598'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 598 ITEM DA PLANILHA 64
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '570'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '570'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '598'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '598'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '598'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '598'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '570'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '570'
			EndIf
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper20         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 20                                                    |
	|          |   20 - AMOSTRA GRATIS                                                    |
	|=====================================================================================|
	|Sintaxe   | StOper20                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper20()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 01 / 25
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 04 / 28
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '650'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '650'
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '650'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '650'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 13 / 37
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 16 / 40
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 49
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 52
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 688 ITEM DA PLANILHA 61
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 688 ITEM DA PLANILHA 64
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '573'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '573'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '573'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '573'
			EndIf
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper29         | Autor | GIOVANI.ZAGO             | Data | 03/08/2017  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 29                                                    |
	|          |   29 - BONIFICACAO                                                       |
	|=====================================================================================|
	|Sintaxe   | StOper29                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper29()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 01 / 25
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 04 / 28 
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '878'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '878'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '878'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '878'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 13 / 37
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 16 / 40
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '877'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '877'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '877'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '877'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 49
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 52
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '877'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '877'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '879'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '877'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '877'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 881 ITEM DA PLANILHA 61
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '881'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '881'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 64
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '880'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '880'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '881'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '881'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '881'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '881'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '880'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '880'
			EndIf
		EndIf

	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper23         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 23                                                    |
	|          |   23 - REMESSA DE BRINDES C/ICMS
	|=====================================================================================|
	|Sintaxe   | StOper23                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper23()
	*-----------------------------*

	//Regra de 1 à 6
	If  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '715'
			Endif
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '715'
			Endif
		Endif
	Endif

	Return (_cTes)

Static Function StOper24()

	If  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst = &_cCliEst .And. SB1->B1_IPI = 0
		_cTes     := '915'
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst = &_cCliEst .And. SB1->B1_IPI<>0 .And. AllTrim(SB1->B1_CLAPROD)=="C"
		_cTes     := '915'
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst = &_cCliEst .And. SB1->B1_IPI<>0 .And. AllTrim(SB1->B1_CLAPROD)$"F#I"
		_cTes     := '914'
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst <> &_cCliEst .And. SB1->B1_IPI = 0
		_cTes     := '915'
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst <> &_cCliEst .And. SB1->B1_IPI <> 0 .And. AllTrim(SB1->B1_CLAPROD)=="C"
		_cTes     := '915'
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst <> &_cCliEst .And. SB1->B1_IPI <> 0 .And. AllTrim(SB1->B1_CLAPROD)$"F#I"
		_cTes     := '914'
	Endif

	Return (_cTes)

	/*====================================================================================\
	|Programa  | StOper25         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 25                                                    |
	|          |   25 - VENDA DE SUCATA (NÃO ATUA.ESTOQUE)                                |
	|=====================================================================================|
	|Sintaxe   | StOper25                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper25()
	*-----------------------------*

	//Regra de 1 à 3
	If  &_cTipoCli = 'F' .And. &_cZconsum = '2'
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '686'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '686'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '686'
			Endif
		Endif
	Endif


	Return (_cTes)

	/*====================================================================================\
	|Programa  | StOper26         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 26                                                    |
	|          |   26 - REMESSA DE BRINDES S/ICMS                                         |
	|=====================================================================================|
	|Sintaxe   | StOper26                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper26()
	*-----------------------------*

	//Regra de 1 à 6
	If  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '714'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '714'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '714'
			Endif
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '714'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '714'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '714'
			Endif
		Endif
	Endif

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper38         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 38                                                    |
	|          |   38 - VENDA A ORDEM                                                     |
	|=====================================================================================|
	|Sintaxe   | StOper38                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper38()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '930' 	//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 01 / 25
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '733' //Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731' //Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '930' //Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 04 / 28
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '732' //Alterada a TES de 612 para 732 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '734' //Alterada a TES de 637 para 734 em 08/05/2013 solicitado por Verônica Brandão
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '731' //Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '733' //Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731' //Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '731' //Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '732' //Alterada a TES de 612 para 732 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '734' //Alterada a TES de 637 para 734 em 08/05/2013 solicitado por Verônica Brandão
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '930'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 13 / 37
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '733'//Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '930'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 16 / 40
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '735'//Alterada a TES de 655 para 735 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '736'//Alterada a TES de 656 para 736 em 08/05/2013 solicitado por Verônica Brandão
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '733'//Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '735'//Alterada a TES de 655 para 735 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '736'//Alterada a TES de 656 para 736 em 08/05/2013 solicitado por Verônica Brandão
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '930'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 49
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '733'//Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '930'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 52
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '732'//Alterada a TES de 612 para 732 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '734'//Alterada a TES de 637 para 734 em 08/05/2013 solicitado por Verônica Brandão
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '733'//Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '732'//Alterada a TES de 612 para 732 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '734'//Alterada a TES de 637 para 734 em 08/05/2013 solicitado por Verônica Brandão
			EndIf
		EndIf

	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper40         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 40                                                    |
	|          |   40 - ENT.FUTURA-VENDA                                                  |
	|=====================================================================================|
	|Sintaxe   | StOper40                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper40()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf
		EndIf

	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper41         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 41                                                    |
	|          |   41 - ENT.FUTURA-VENDA                                                  |
	|=====================================================================================|
	|Sintaxe   | StOper41                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper41()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '587'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '515'
			EndIf
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper60         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 60                                                    |
	|          |   60 - DEV. MAT.PRIMA -  C/ IPI E ICMS                                   |
	|=====================================================================================|
	|Sintaxe   | StOper60                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper60()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			EndIf
		Endif
	Endif

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper61         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 61                                                    |
	|          |   61 - DEV. MAT.PRIMA C/ICMS                                             |
	|=====================================================================================|
	|Sintaxe   | StOper61                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper61()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			EndIf
		Endif
	Endif

	Return (_cTes)

	/*====================================================================================\
	|Programa  | StOper62         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 62                                                    |
	|          |   62 - DEV. MAT.PRIMA S/ICMS                                             |
	|=====================================================================================|
	|Sintaxe   | StOper62                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper62()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			EndIf
		Endif
	Endif

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper63         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 63                                                    |
	|          |   63 - DEV. MAT.PRIMA S/ICMS                                             |
	|=====================================================================================|
	|Sintaxe   | StOper63                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper63()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			EndIf
		Endif
	Endif

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper64         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 64                                                    |
	|          |   64 - DEVOL.USO CONS C/ICMS                                             |
	|=====================================================================================|
	|Sintaxe   | StOper64                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper64()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			EndIf
		Endif
	Endif

	Return (_cTes)

	/*====================================================================================\
	|Programa  | StOper65         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 65                                                    |
	|          |   65 - DEVOL.USO CONS C/ICMS                                             |
	|=====================================================================================|
	|Sintaxe   | StOper65                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper65()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			EndIf
		Endif
	Endif

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper39         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 39                                                    |
	|          |   39 - REM POR CONTA E ORDEM -CFOP 5923/6923                             |
	|=====================================================================================|
	|Sintaxe   | StOper39                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/

	*-----------------------------*
Static Function StOper39()
	*-----------------------------*

	//Das regras de 01 à 24 -> Alterada a TES de 622 para 737 em 08/05/2013 solicitado por Verônica Brandão
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//REGRA DE 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif

			//REGRA DE 4 à 6
		Elseif _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif
		Endif

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//REGRA DE 7 à 9
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif
			//REGRA DE 10 à 12
		Elseif _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif
		Endif

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//REGRA DE 13 à 15
		If  _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif

			//REGRA DE 15 à 18
		Elseif _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif
		Endif

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//REGRA DE 19 à 21
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif

			//REGRA DE 22 à 24
		Elseif _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif
		Endif

	Endif

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper85         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 85                                                    |
	|          |   85 - VENDA SP/MA -> STECK AM                                           |
	|=====================================================================================|
	|Sintaxe   | StOper85                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/

	*-----------------------------*
Static Function StOper85()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. !(Empty(ALLTRIM( &_cCliSufra)))

		//Regra de 1 à 6
		If alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '509'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '508'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '509'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '508'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
			EndIf

			//Regra de 13 à 18
		ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '685'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '685'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'R' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. !(Empty(ALLTRIM( &_cCliSufra)))

		//Regra de 1 à 6
		If alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '509'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '508'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '509'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '508'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
			EndIf

			//Regra de 13 à 18
		ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '685'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '685'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. !(Empty(ALLTRIM( &_cCliSufra)))

		//Regra de 7 a 12
		If  alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '508'// Chamado 005549 - Robson Mazzarotto
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '508' // Chamado 005549 - Robson Mazzarotto
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '828'//Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
			EndIf
			//Regra de 19 à 24
		ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '508'// Chamado 005549 - Robson Mazzarotto
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '508' // Chamado 005549 - Robson Mazzarotto
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2' .And. !(Empty(ALLTRIM( &_cCliSufra)))

		//Regra de 25 à 30
		If  alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '680'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '677'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '829' //Alterado por João Victor em 31/01/2014 de 678 para 829 conforme chamado 000139
			EndIf

			//Regra de 31 à 36
		ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '680'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '677'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '829'//Alterado por João Victor em 31/01/2014 de 678 para 829 conforme chamado 000139
			EndIf
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper35         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 35                                                    |
	|          |   35 - DEV.REM.P/TROCA                                                   |
	|=====================================================================================|
	|Sintaxe   | StOper35                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper35()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 01 / 25
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 01 / 28
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '547'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '547'
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '547'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '547'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 13 / 37
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 16 / 40
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '713'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '713'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '713'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '713'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 61
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 64
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '713'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '713'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '552'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '713'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '713'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 602 ITEM DA PLANILHA 49
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '602'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '602'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '936'  	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 602 ITEM DA PLANILHA 52
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '594'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '594'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '602'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '602'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '602'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '602'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '594'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '594'
			EndIf
		EndIf

	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper34         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 34                                                    |
	|          |   34 - REM.P/TROCA                                                    |
	|=====================================================================================|
	|Sintaxe   | StOper34                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper34()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '779'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '779'
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '779'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '779'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. &_cCliContrib = '2'

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '631'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '631'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '631'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '631'
			EndIf
		EndIf

	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper21         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 21                                                    |
	|          |   21 - REM.P/TROCAMAT.PROPAGANDA                                         |
	|=====================================================================================|
	|Sintaxe   | StOper21                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper21()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. &_cCliContrib = '2' .And. Alltrim(&_cZconsum) = ''

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '' .And. &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf
		EndIf

	EndIf

	Return (_cTes)

	/*====================================================================================\
	|Programa  | StOper22         | Autor | GIOVANI.ZAGO            | Data | 31/01/2017  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 22                                                    |
	|          |   22 - INDUSTRIALIZAÇÃO PARA OUTRA EMPRESA				                  |
	|=====================================================================================|
	|Sintaxe   | StOper22                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper22()
	*-----------------------------*



	If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
		_cTes     := '866'
	ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
		_cTes     := '866'
	ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
		_cTes     := '866'
	ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
		_cTes     := '866'
	ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
		_cTes     := '865'
	ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
		_cTes     := '865'
	EndIf


	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper79         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 79                                                    |
	|          |   79 - DEVOL.USO CONS C/ IPI E ICMS (NÃO ATUA.ESTOQUE)                   |
	|=====================================================================================|
	|Sintaxe   | StOper79                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper79()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper80         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 80                                                    |
	|          |   80 - DEVOL.USO CONS C/ICMS (NÃO ATUA.ESTOQUE)                          |
	|=====================================================================================|
	|Sintaxe   | StOper80                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper80()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper81         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 81                                                    |
	|          |   81 - DEVOL.USO CONS S/ICMS (NÃO ATUA.ESTOQUE)                          |
	|=====================================================================================|
	|Sintaxe   | StOper81                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper81()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper57         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 57                                                    |
	|          |   57 - DEVOL ATIVO  C/ IPI E ICMS                                        |
	|=====================================================================================|
	|Sintaxe   | StOper57                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper57()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper58         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 58                                                    |
	|          |   58 - DEVOL ATIVO  C/ ICMS                                              |
	|=====================================================================================|
	|Sintaxe   | StOper58                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper58()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper59         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 59                                                    |
	|          |   59 - DEVOL ATIVO  S/ ICMS                                              |
	|=====================================================================================|
	|Sintaxe   | StOper59                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper59()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper83         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 83                                                    |
	|          |   83 - DEVOL ATIVO  C/ IPI E ICMS (NÃO ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | StOper83                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper83()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper84         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 84                                                    |
	|          |   84 - DEVOL ATIVO  C/ IPI E ICMS (NÃO ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | StOper84                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper84()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper82         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 82                                                    |
	|          |   82 - DEVOL ATIVO  S/ ICMS (NÃO ATUA.ESTOQUE)                           |
	|=====================================================================================|
	|Sintaxe   | StOper82                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper82()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper09         | Autor | JOAO.RINALDI             | Data | 29/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 09                                                    |
	|          |   09 - COMPLEMENTO DE PRECO                                              |
	|=====================================================================================|
	|Sintaxe   | StOper09                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper09()
	*-----------------------------*

	//Itens marcados na cor VERDE LIMÃO na Planilha Oficial de TES Inteligente
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		// regra de 01 à 06  e 37 à 42
		If   _cEst = &_cCliEst
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '752'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '752'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '752'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '742'
			EndIf
		Else
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '752'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '752'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '752'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '742'
			EndIf
		EndIf

		ElseIf _cEst <> &_cCliEst


			If  !(Empty(ALLTRIM( &_cCliSufra)))

				If alltrim(&_cCliMun) $ ('04062') .And. &_cCliEst = 'AM' .and.  &_cCliCep = '069640970'	// regra  191 à 196 = 197 à 202

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '745'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '744'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '745'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '745'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '744'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '761'
					EndIf


				ElseIf alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'	// regra  125 à 130 = 155 à 160

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '745'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '744'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '762'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '745'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '744'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '761'
					EndIf

				ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'	// regra  161 à 166 = 167 à 172

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '762'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '776'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '762'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '762'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '776'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '761'
					EndIf



				ElseIf !(alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252')) .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  173 à 178 = 179 à 184

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '763'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '760'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '763'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '763'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '760'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '777'
					EndIf

				ElseIf alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252') .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  143 à 148 = 185 à 190

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '745'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '744'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '762'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '745'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '744'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '761'
					EndIf

				EndIf

			Else	// regra  7 à 12 e 43 à 48
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '752'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '738'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '742'
				EndIf

			EndIf

		EndIf
		//Itens marcados na cor AZUL ESCURO na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		If !(Empty(ALLTRIM( &_cCliSufra)))

			If alltrim(&_cCliMun) $ ('04062') .And. &_cCliEst = 'AM' .and.  &_cCliCep = '069640970'	// regra  233 à 238 = 239 à 244

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '760'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '760'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '777'
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'	// regra  131 à 136 = 203 à 208

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '760'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '760'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '777'
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'	// regra  137 à 142  = 209 à 214

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '760'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '760'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '777'
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252')) .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  221 à 226 = 227 à 232

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '760'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '763'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '760'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '777'
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252') .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  149 à 154 = 215 à 220

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '749'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '747'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '749'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '749'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '747'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '756'
				EndIf
			EndIf
		Else
			// regra de 13 à 18 e 61 à 66
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '752'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '739'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '754'
				EndIf
				// regra 19 à 24 e 67 à 72
			ElseIf _cEst <> &_cCliEst .And.  !( &_cCliEst $ 'MG/RS/SC/BA')
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '752'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '739'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '754'
				EndIf
			EndIf

		EndIf

		//Itens marcados na cor VINHO na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		If !(Empty(ALLTRIM( &_cCliSufra)))

			If alltrim(&_cCliMun) $ ('04062') .And. &_cCliEst = 'AM' .and.  &_cCliCep = '069640970'	// regra  245 à 250

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '755'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '755'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '743'
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'	// regra  251 à 256

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '772'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '773'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '772'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '772'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '773'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '771'
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'	// regra  257 à 262

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '772'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '773'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '772'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '772'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '773'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '771'
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252')) .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  263 à 268

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '755'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '755'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '743'
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252') .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  269 à 274

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '755'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '755'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '743'
				EndIf


			EndIf
		Else

			// regra de 55 à 60
			If 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)) .And.  &_cCliEst $ 'BA' .And. !(&_cCliEst) $ 'MS'
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '767'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '778'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '767'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '759'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '757'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '758'
				EndIf


				// regra de 25 à 30 e de 93 à 98
			ElseIf   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '752'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '739'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '754'
				EndIf

			ElseIf _cEst <> &_cCliEst .And. !(&_cCliEst) $ 'MS'	// regra de 31 à 36 e de 99 à 104
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '755'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '753'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '740'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '743'
				EndIf

			Elseif &_cCliEst $ 'MS' // regra de 287 à 292
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '799'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '800'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '801'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '802'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '803'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '804'
				EndIf

			EndIf

		EndIf

		//Itens marcados na cor VERDE ÁGUA na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))).And.  ( &_cCliEst $ 'MG/RS/SC/BA')
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '751'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '751'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '746'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '746'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '741'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '748'
				EndIf
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '751'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '751'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '746'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '746'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '741'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '748'
				EndIf
			EndIf
		Else
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '752'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '742'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '748'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '748'
				EndIf
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '767'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '778'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '767'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '767'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '757'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '758'
				EndIf
			EndIf
		EndIf

		//Itens marcados na cor LARANJA na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		DbSelectArea("SF7")
		SF7->(DbSetOrder(4))
		//SF7->(DbOrderNickName("NICKSF7"))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli)) /*.And. (!(&_cCliEst = 'MT')*/ .And. !(&_cxCliContr $ '004/005/006/007')
			// regra de 73 à 78 e 105 à 110
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '751'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '751'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '746'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '746'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '741'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '748'
				EndIf
				// regra de 79 à 86 e 111 à 118
			ElseIf   _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '746'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '751'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '746'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '741'
				ElseIf SB1->B1_CLAPROD = 'I'
					If SF7->F7_MARGEM <> 0
						If  SB1->B1_IPI <> 0
							_cTes     := '748'
						ElseIf  SB1->B1_IPI = 0
							_cTes     := '746'
						EndIf
					ElseIf SF7->F7_MARGEM = 0
						If  SB1->B1_IPI <> 0
							_cTes     := '742'
						ElseIf  SB1->B1_IPI = 0
							_cTes     := '750'
						EndIf
					EndIf
				EndIf
			EndIf
			// regra de 87 à 92 - Regra cancelada em 02/04/2013 por Verônica Brandão
			/*
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '752'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '738'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '742'
				EndIf
			*/
		Else
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '752'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '742'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '748'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '748'
				EndIf
				// regra de 275 à 280
			ElseIf   _cEst <> &_cCliEst
					If &_cCliEst = 'MT' .And. 	&_cxCliContr = '004'.And. Getmv('ST_MTSTOP',,.F.)// giovani zago 28/01/2020 ajuste do estado MT ticket 20200124000120
						If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
							_cTes     := '765'
						ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
							_cTes     := '774'
						ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
							_cTes     := '765'
						ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
							_cTes     := '765'
						ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
							_cTes     := '764'
						ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
							_cTes     := '766'
						EndIf

						// regra de 281 à 286
					ElseIf &_cCliEst = 'MT' .And. 	&_cxCliContr $ '005/006/007' .And. Getmv('ST_MTSTOP',,.F.)// giovani zago 28/01/2020 ajuste do estado MT ticket 20200124000120
						If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
							_cTes     := '768'
						ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
							_cTes     := '775'
						ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
							_cTes     := '768'
						ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
							_cTes     := '768'
						ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
							_cTes     := '769'
						ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
							_cTes     := '770'
						EndIf

					Else	// regra de 119 à 124

						If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
							_cTes     := '750'
						ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
							_cTes     := '752'
						ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
							_cTes     := '750'
						ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
							_cTes     := '750'
						ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
							_cTes     := '738'
						ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
							_cTes     := '742'
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
		Return  (_cTes)



	/*====================================================================================\
	|Programa  | StOper71         | Autor | JOAO.RINALDI             | Data | 11/06/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 71                                                    |
	|          |   71 - VENDAS - FAB.MAT.INF. (RE ICMS)                                   |
	|=====================================================================================|
	|Sintaxe   | StOper71                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper71()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '788'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '788'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '788'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '787'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper96         | Autor | JOAO.RINALDI             | Data | 11/06/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 96                                                    |
	|          |   96 - TRANSF. ENTRE FILIAIS (NÃO ATUA.ESTOQUE)                          |
	|=====================================================================================|
	|Sintaxe   | StOper96                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper96()
	*-----------------------------*

	// regra de 01 à 03
	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (_cEst = &_cCliEst) .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '790'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '789'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '790'
		Endif
	Endif

	Return  (_cTes)




	/*====================================================================================\
	|Programa  | StOper97         | Autor | JOAO.RINALDI             | Data | 18/06/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 97                                                    |
	|          |   97 - VENDA COPA                                                        |
	|=====================================================================================|
	|Sintaxe   | StOper97                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper97()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '2'
		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			EndIf
			//Regra de 7 à 12
		Elseif  _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '809'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '808'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '809'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '809'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '808'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '809'
			EndIf
		Endif
	Elseif &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')
		//Regra de 13 à 18
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			EndIf
			//Regra de 19 à 24
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			EndIf
		EndIf
	ElseIf &_cTipoCli == 'R' .And. &_cCliContrib == '1' .And. (!Empty(Alltrim(&_cCliInscr)) .Or. 'ISENT' $ Upper(Alltrim(&_cCliInscr)))	// Ticket 20210604009371 - TES INTELIGENTE - Eduardo Pereira - Inicio
		//Regra de 13 à 18
		If   _cEst == &_cCliEst
			If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			EndIf
			//Regra de 19 à 24
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			EndIf
		EndIf
		// Ticket 20210604009371 - TES INTELIGENTE - Eduardo Pereira - Fim
	Endif

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper14         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 14                                                    |
	|          |   14 - REMESSA PARA TESTE                                                |
	|=====================================================================================|
	|Sintaxe   | StOper14                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper14()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '596'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '596'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '596'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '596'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper15         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 15                                                    |
	|          |   15 - RETORNO TESTE                                                     |
	|=====================================================================================|
	|Sintaxe   | StOper15                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper15()
	*-----------------------------*

//	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('D') //ticket 20200803005044
		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '797'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '797'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '797'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '797'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper17         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 17                                                    |
	|          |   17 - REM P/VASILHAME                                                   |
	|=====================================================================================|
	|Sintaxe   | StOper17                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper17()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper27         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 27                                                    |
	|          |   27 - RETORNO VASILHAME                                                 |
	|=====================================================================================|
	|Sintaxe   | StOper27                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper27()
	*-----------------------------*

//	If  &_cTipoCli = 'F' .OR.&_cTipoCli = 'D' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

	If  &_cTipoCli = 'F' .OR.&_cTipoCli = 'D' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('D')// 20200803005044
		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper42         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 42                                                    |
	|          |   42 - TRANSFERENCIA DE SALDO C/D                                        |
	|=====================================================================================|
	|Sintaxe   | StOper42                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper42()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '711'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '711'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '711'
			EndIf

			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '711'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '711'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '711'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper45         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 45                                                    |
	|          |   45 - TRANSFERENCIA DE ATIVO                                            |
	|=====================================================================================|
	|Sintaxe   | StOper45                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper45()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '723'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '723'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '723'
			EndIf

			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '723'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '723'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '723'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper48         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 48                                                    |
	|          |   48 - TRANSF USO E CONSUMO                                              |
	|=====================================================================================|
	|Sintaxe   | StOper48                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper48()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '693'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '693'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '693'
			EndIf

			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '693'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '693'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '693'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper49         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 49                                                    |
	|          |   49 - RETORNO LOCAÇÃO                                                   |
	|=====================================================================================|
	|Sintaxe   | StOper49                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper49()
	*-----------------------------*

	//If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('D') //20200803005044
		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper51         | Autor | GIOVANI.ZAGO             | Data | 07/06/2017  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 51                                                    |
	|          |   51 - REMESSA PARA DESCARTE					                          |
	|=====================================================================================|
	|Sintaxe   | StOper51                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper51()
	*-----------------------------*

	_cTes     := '867'


	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper52         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 52                                                    |
	|          |   52 - REM.ATIVO IMOB.USO FORA DO ESTABECIMENTO                          |
	|=====================================================================================|
	|Sintaxe   | StOper52                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper52()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '699'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '699'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '699'
			EndIf

			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '699'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '699'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '699'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper53         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 53                                                    |
	|          |   53 - RET.DEMONSTRAÇÃO C/IPI E ICMS                                     |
	|=====================================================================================|
	|Sintaxe   | StOper53                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper53()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper54         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 54                                                    |
	|          |   54 - RET.DEMONSTRAÇÃO C/ICMS                                           |
	|=====================================================================================|
	|Sintaxe   | StOper54                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper54()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper55         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 55                                                    |
	|          |   55 - RET.DEMONSTRAÇÃO S/IPI E ICMS                                     |
	|=====================================================================================|
	|Sintaxe   | StOper55                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper55()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper70         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 70                                                    |
	|          |   70 - RETORNO COMODATO                                                  |
	|=====================================================================================|
	|Sintaxe   | StOper70                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper70()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper72         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 72                                                    |
	|          |   72 - SINISTRO                                                          |
	|=====================================================================================|
	|Sintaxe   | StOper72                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper72()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper77         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 77                                                    |
	|          |   77 - VENDA - FABR. MAT. P/ VEICULOS                                    |
	|=====================================================================================|
	|Sintaxe   | StOper77                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper77()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N') .And. &_cAtividade = '000024'

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '791'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '791'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '506'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '791'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '791'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '506'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper87         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 87                                                    |
	|          |   87 - RET INDL                                                          |
	|=====================================================================================|
	|Sintaxe   | StOper87                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper87()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('D')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper98         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 98                                                    |
	|          |   98 - VENDA - MATL USO E CONSUMO                                        |
	|=====================================================================================|
	|Sintaxe   | StOper98                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper98()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper99         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 99                                                    |
	|          |   99 - VENDA - MATL USO E CONSUMO (NÃO ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | StOper99                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper99()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			EndIf
		EndIf
	EndIf

	Return (_cTes)

/*====================================================================================\
|Programa  | StOper0A         | Autor | MARCELO KLOPFER          | Data | 18/02/2022  |
|=====================================================================================|
|Descrição |   TES INTELIGENTE        		    	                                      |
|          |   Tipo de Operação OA                                                    |
|          |   OA - COMPLEMENTO DE IPI CFOP 5401                                      |
|=====================================================================================|
|Sintaxe   | StOper0A                                                                 |
|=====================================================================================|
|Uso       | Especifico STECK                                                         |
|=====================================================================================|
|........................................Histórico....................................|
\====================================================================================*/
STATIC FUNCTION StOper0A()

	/***********************
	Regras
	1 - Tipo do Cliente = "S" Solidário
	2 - Tela  = '1'
	3 - Para todos os estados
	4 - Para todos os tipos de produtos "F / C / I"
	5 - Somente para IPI <> 0 
	6 - Contribuinte A1_CONTRIB
	7 - Tem que ter Inscrição Estadual
	8 - Tipo do pedido de venda tem ser Normal.
	***********************/
	IF  &_cTipoCli = 'S' /*.And. &_cZconsum = '1' */  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('P')

		IF SB1->B1_IPI <> 0
			_cTes     := '916'
		ENDIF
	ENDIF

RETURN _cTes

/*====================================================================================\
|Programa  | StOper0B         | Autor | MARCELO KLOPFER          | Data | 18/02/2022  |
|=====================================================================================|
|Descrição |   TES INTELIGENTE        		    	                                      |
|          |   Tipo de Operação OB                                                    |
|          |   OB - COMPLEMENTO DE IPI CFOP 5101                                      |
|=====================================================================================|
|Sintaxe   | StOper0B                                                                 |
|=====================================================================================|
|Uso       | Especifico STECK                                                         |
|=====================================================================================|
|........................................Histórico....................................|
\====================================================================================*/
STATIC FUNCTION StOper0B()

	/***********************
	Regras
	1 - Tipo do Cliente = "R" Revendedor
	2 - Tela = '1'
	3 - Para todos os estados
	4 - Para todos os tipos de produtos "F / C / I"
	5 - Somente para IPI <> 0 
	6 - Contribuinte A1_CONTRIB
	7 - Tem que ter Inscrição Estadual
	8 - Tipo do pedido de venda tem ser Normal.
	***********************/
	IF  &_cTipoCli = 'R' /*.And. &_cZconsum = '1'*/ .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('P')

		IF SB1->B1_IPI <> 0
			_cTes     := '822'
		ENDIF
	ENDIF

RETURN _cTes


/*/{Protheus.doc} STOper0E
Remessa Empréstimo de Ativo
@type function
@version  12.1.33
@author Ricardo Munhoz
@since 13/10/2022
@return character, TES correspondente
/*/
	Static Function StOper0E()

	If  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'R' .And. Alltrim(&_cZconsum) = '1'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "692"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'R' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = '1'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "692"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	Return _cTes


	/*====================================================================================\
	|Programa  | StOper07         | Autor | JOAO.RINALDI             | Data | 28/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 07                                                    |
	|          |   07 - VENDAS RED B.CALCULO ICMS                                         |
	|=====================================================================================|
	|Sintaxe   | StOper07                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper07()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '815'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '816'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '818'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '815'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '816'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '818'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper03         | Autor | Jefferson.carlos         | Data | 09/04/2018  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 03                                                    |
	|          |   03 - RET.DEMONSTRAÇÃO C/IPI E ICMS ( ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | StOper03                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK    Chamado 007038                                                     |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper03()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper05         | Autor | JOAO.RINALDI             | Data | 24/01/2014  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 05                                                    |
	|          |   05 - VENDA - DRAWBACK                                                  |
	|=====================================================================================|
	|Sintaxe   | StOper05                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper05()
	*-----------------------------*
	//giovani zago alterei zconsumo para 2 veronica solicitou 28/01/14
	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '825'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '825'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '824'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '825'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '825'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '824'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper90         | Autor | João Victor              | Data | 12/11/2014  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 90                                                    |
	|          |   90 - VENDA - REPENEC                                                   |
	|          |   Chamado 001107                                                         |
	|=====================================================================================|
	|Sintaxe   | StOper90                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper90()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '838'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '838'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '837'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '838'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '838'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '837'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper91         | Autor | João Victor              | Data | 12/02/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 91                                                    |
	|          |   91 - ANULAÇÃO DE VALORES REF AQUISIÇÃO DE SERVIÇO DE TRANSPORTE        |
	|          |   Chamado 001496                                                         |
	|=====================================================================================|
	|Sintaxe   | StOper91                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper91()
	*-----------------------------*
	_cTes     := '842'
	Return (_cTes)

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			EndIf

			//Regra de 3 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper93         | Autor | João Victor              | Data | 27/05/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 93                                                    |
	|          |   93 - INDUSTRIALIZAÇÃO PARA OUTRA EMPRESA                               |
	|          |   Chamado 001996                                                         |
	|=====================================================================================|
	|Sintaxe   | StOper93                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper93()
	*-----------------------------*

	//If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
	//	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'   .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) //chamado veronica 23/09/16

	//Regra de 1 à 6
	If   _cEst = &_cCliEst
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '931' //// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 511 ITEM DA PLANILHA 01
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '564'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '511'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '931' //// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 511 ITEM DA PLANILHA 01
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '564'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '638'
		EndIf

		//Regra de 7 à 12
	ElseIf _cEst <> &_cCliEst
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '511'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '564'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '511'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '511'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '564'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '638'
		EndIf
	EndIf
	//EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper47         | Autor | João Victor              | Data | 14/10/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 47                                                    |
	|          |   47 - VENDA TRANSPORTE PUBLICO                                          |
	|          |   Chamado 002843                                                         |
	|=====================================================================================|
	|Sintaxe   | StOper47                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper47()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '850'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '849'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '850'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '850'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '849'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '850'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper86         | Autor | João Victor              | Data | 26/02/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 86                                                    |
	|          |   86 - MUDANÇA DE ENDEREÇO                                               |
	|          |   Chamado 002843                                                         |
	|=====================================================================================|
	|Sintaxe   | StOper86                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper86()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv == 'N'

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '854'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '854'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '854'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '854'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '854'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '854'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | StOper76         | Autor | GIOVANI.ZAGO              | Data | 11/04/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 76                                                    |
	|          |   76 - MUDANÇA DE ENDEREÇO                                               |
	|          |   Chamado 002843                                                         |
	|=====================================================================================|
	|Sintaxe   | StOper76                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper76()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv == 'N'

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '856'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '856'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '856'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '856'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '856'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '856'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | StOper99         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 99                                                    |
	|          |   99 - VENDA - MATL USO E CONSUMO (NÃO ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | StOper99                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper31()
	*-----------------------------*


	If  &_cTipoCli = 'F'

		If &_cZconsum = '1'
			If (SB1->B1_CLAPROD = 'F' .Or. SB1->B1_CLAPROD = 'I' ).And. SB1->B1_IPI <> 0
				_cTes     := '860'
			Else
				_cTes     := '861'
			EndIf
		Else
			If (SB1->B1_CLAPROD = 'F' .Or. SB1->B1_CLAPROD = 'I' ).And. SB1->B1_IPI <> 0
				_cTes     := '859'
			Else
				_cTes     := '861'
			EndIf

		EndIf




	ElseIf  &_cTipoCli = 'R'

		If &_cZconsum = '1'
			If (SB1->B1_CLAPROD = 'F' .Or. SB1->B1_CLAPROD = 'I' ).And. SB1->B1_IPI <> 0
				_cTes     := '860'
			Else
				_cTes     := '938' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 861 ITEM DA PLANILHA 04 / 16 / 28 / 40 / 52 
			EndIf

		ElseIf &_cZconsum = '2'
			If (SB1->B1_CLAPROD = 'F' .Or. SB1->B1_CLAPROD = 'I' ).And. SB1->B1_IPI <> 0
				_cTes     := '859'
			Else
				_cTes     := '938' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 861 ITEM DA PLANILHA 04 / 16 / 28 / 40 / 52 
			EndIf

		EndIf

	ElseIf  &_cTipoCli = 'S'
		If (SB1->B1_CLAPROD = 'F' .Or. SB1->B1_CLAPROD = 'I' ).And. SB1->B1_IPI <> 0
			_cTes     := '862'
		Else
			_cTes     := '938' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 863 ITEM DA PLANILHA 64
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper99         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 99                                                    |
	|          |   99 - VENDA - MATL USO E CONSUMO (NÃO ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | StOper99                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper33()
	*-----------------------------*

	_cTes     := '846'

	Return (_cTes)





	/*--------------------------------------------------------------------------------------
	OPERAÇÕES DA EMPRESA 03-STECK DA AMAZÔNIA
	--------------------------------------------------------------------------------------*/

	/*====================================================================================\
	|Programa  | AmOper01         | Autor | João Victor              | Data | 28/11/2014  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 01                                                    |
	|          |   01 VENDAS NACIONAIS                                                    |
	|=====================================================================================|
	|Sintaxe   | AmOper01                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper01()
	*-----------------------------*

	If  &_cTipoCli $ 'F/R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If  Substr((&_cCliInscr),1,5) $ '06200/06300'
				// regra de 13 à 18
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '712'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '712'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				Endif
				// regra de 01 à 06
			Else
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '701'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '701'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '732'
				Endif
			EndIf

			// regra de 07 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '732'
			EndIf
		Endif

	ElseIf  &_cTipoCli $ 'F/R' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If  Substr((&_cCliInscr),1,5) $ '06200/06300'
				// regra de 31 à 36
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '730'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '730'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				Endif

				// regra de 19 à 24
			Else
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '701'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '701'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '732'
				EndIf
			Endif
			// regra de 25 à 30
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '732'
			EndIf
		Endif

	ElseIf  &_cTipoCli $ 'F/R' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'
		// regra de 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '707'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '707'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			EndIf
		Endif


	ElseIf  &_cTipoCli = 'S' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 43 à 48
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '713'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '713'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := ''
			EndIf
		Endif
	Endif


	Return (_cTes)

	/*====================================================================================\
	|Programa  | AmOper02         | Autor | João Victor              | Data | 28/11/2014  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 02                                                    |
	|          |   02 VENDAS SUCATA C/DIFERIMNETO                                         |
	|=====================================================================================|
	|Sintaxe   | AmOper02                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper02()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '737'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '746'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '737'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '737'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '746'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '737'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper03         | Autor | João Victor              | Data | 28/11/2014  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 03                                                    |
	|          |   03 VENDAS - SUCATA S/DIFERIMNETO                                       |
	|=====================================================================================|
	|Sintaxe   | AmOper03                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper03()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '734'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '745'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '734'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '734'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '745'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '734'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '734'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '745'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '734'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '734'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '745'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '734'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper04         | Autor | João Victor              | Data | 28/11/2014  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 04                                                    |
	|          |   04 VENDAS - SUCATA S/DIFERIMNETO                                       |
	|=====================================================================================|
	|Sintaxe   | AmOper04                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper04()
	*-----------------------------*

	If  &_cTipoCli $ 'F/R' .And. &_cCliContrib $ '1/2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '741'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '741'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '741'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '741'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '741'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '741'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '741'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '741'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '741'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '741'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '741'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '741'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | AmOper05         | Autor | João Victor              | Data | 16/06/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 05                                                    |
	|          |   05  REM.P/CONSERTO                                                     |
	|=====================================================================================|
	|Sintaxe   | AmOper05                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper05()
	*-----------------------------*

	If  &_cTipoCli $ 'F/R' .And. &_cZconsum $ '1/2' .And. &_cTipopv $ 'B'

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '704'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '704'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '704'
			EndIf
			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '704'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '704'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '704'
			EndIf
		Endif
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | AmOper06         | Autor | João Victor              | Data | 16/06/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 06                                                    |
	|          |   06  REMESSA P/ INDUSTRIALIZACAO -> Utiliza Fornecedor ( ATUAL. ESTOQUE)|
	|=====================================================================================|
	|Sintaxe   | AmOper06                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper06()
	*-----------------------------*

	If  &_cTipoCli $ 'F/R' .And. &_cZconsum $ '1/2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ 'B'

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			EndIf
			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			EndIf
		Endif
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper07         | Autor | João Victor              | Data | 16/06/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 07                                                    |
	|          |   07  DEV. MAT.PRIMA S/ICMS -> Dev Compras -> Utiliza Fornecedor         |
	|=====================================================================================|
	|Sintaxe   | AmOper07                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper07()
	*-----------------------------*

	If  &_cTipoCli $ 'F/R' .And. &_cZconsum $ '1/2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv = 'D'

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '708'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '708'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '708'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '708'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '708'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '708'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '708'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '708'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '708'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '708'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '708'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '708'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper08         | Autor | João Victor              | Data | 16/06/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 08                                                    |
	|          |   08   DEV. MAT.PRIMA C/ICMS - -> Dev Compras -> Utiliza Fornecedor      |
	|=====================================================================================|
	|Sintaxe   | AmOper08                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper08()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv = 'D'

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '744'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '744'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '744'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '744'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '744'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '744'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '744'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '744'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '744'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '744'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '744'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '744'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | AmOper09         | Autor | João Victor              | Data | 16/06/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 09                                                    |
	|          |   09 VENDAS Mat. Prima                                                   |
	|=====================================================================================|
	|Sintaxe   | AmOper09                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper09()
	*-----------------------------*

	If  &_cTipoCli $ 'F/R' .And. &_cZconsum $ '1/2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := ''
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := ''
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper10         | Autor | João Victor              | Data | 16/06/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 10                                                    |
	|          |   10 VENDAS Mat. Prima                                                   |
	|=====================================================================================|
	|Sintaxe   | AmOper10                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper10()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '738'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '738'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '738'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '738'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '738'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '738'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '738'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '738'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '738'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '738'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '738'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '738'
			EndIf
		EndIf
	EndIf

	Return (_cTes)







	/*====================================================================================\
	|Programa  | AmOper11         | Autor | João Victor              | Data | 08/07/2015  |
	|=====================================================================================|
	|Descrição |  TES INTELIGENTE        		    	                                     |
	|          |  Tipo de Operação 11                                                     |
	|          |  11 DEVOL.USO CONS C/ICMS -> Dev Compras -> Utiliza Fornecedor s/ estoque|
	|=====================================================================================|
	|Sintaxe   | AmOper11                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper11()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv = 'D'

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			EndIf
		EndIf
	EndIf

	Return (_cTes)





	/*====================================================================================\
	|Programa  | AmOper12         | Autor | João Victor              | Data | 20/07/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 12                                                    |
	|          |   12 VENDA DO ATIVO                                                      |
	|=====================================================================================|
	|Sintaxe   | AmOper12                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper12()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 01 à 06
		// regra de 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			Endif
			// regra de 07 à 12
			// regra de 31 à 36
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			EndIf
		Endif

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 13 à 18
		// regra de 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			Endif
			// regra de 19 à 24
			// regra de 43 à 48
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			EndIf
		Endif

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'
		// regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			EndIf
			// regra de 55 à 60
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '728'
			EndIf
		Endif
	Endif


	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper13         | Autor | João Victor              | Data | 20/07/2015  |
	|=====================================================================================|
	|Descrição |  TES INTELIGENTE        		    	                                     |
	|          |  Tipo de Operação 13                                                     |
	|          |  13 COMPL ICMS CFOP 5401                                                 |
	|=====================================================================================|
	|Sintaxe   | AmOper13                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper13()
	*-----------------------------*

	If  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '714'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '714'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '714'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper14         | Autor | João Victor              | Data | 20/07/2015  |
	|=====================================================================================|
	|Descrição |  TES INTELIGENTE        		    	                                     |
	|          |  Tipo de Operação 14                                                     |
	|          |  14 COMPL ICMS  CFOP 5101                                                |
	|=====================================================================================|
	|Sintaxe   | AmOper14                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper14()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '750'
			EndIf
			//regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '750'
			EndIf
		EndIf
	Elseif  &_cTipoCli = 'F' .And. &_cZconsum = '2'
		//Regra de 7 à 9
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '750'
			EndIf
			//regra de 10 à 13
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '750'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '750'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


/*--------------------------------------------------------------------------------------
OPERAÇÕES DA EMPRESA 03-STECK DA AMAZÔNIA
/*====================================================================================\
|Programa  | AmOper15         | Autor | Marcelo Klopfer Leme     | Data | 11/10/2022  |
|=====================================================================================|
|Descrição |   TES INTELIGENTE         		    	                                      |
|          |   Tipo de Operação 15                                                    |
|          |   15 - ESCOAMENTO DE PRODUÇÃO                                            |
|=====================================================================================|
|Sintaxe   | AmOper15                                                                 |
|=====================================================================================|
|Uso       | Especifico STECK MANAUS                                                  |
|=====================================================================================|
|........................................Histórico....................................|
\====================================================================================*/
STATIC FUNCTION AmOper15()

	If  &_cTipoCli $ 'F/R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If  Substr((&_cCliInscr),1,5) $ '06200/06300'
				// regra de 13 à 18
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '712'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '712'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				Endif
				// regra de 01 à 06
			Else
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '701'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '701'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '732'
				Endif
			EndIf

			// regra de 07 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '732'
			EndIf
		Endif

	ElseIf  &_cTipoCli $ 'F/R' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If  Substr((&_cCliInscr),1,5) $ '06200/06300'
				// regra de 31 à 36
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '730'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '730'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				Endif

				// regra de 19 à 24
			Else
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '701'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '732'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '701'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '732'
				EndIf
			Endif
			// regra de 25 à 30
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '732'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '732'
			EndIf
		Endif

	ElseIf  &_cTipoCli $ 'F/R' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'
		// regra de 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '707'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '707'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '701'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			EndIf
		Endif

	ElseIf  &_cTipoCli = 'S' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 43 à 48
		//If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '732' //// Alterado por Marcelo Klopfer - 11/01/2022
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '701' //// Alterado por Marcelo Klopfer - 11/01/2022
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '732' //// Alterado por Marcelo Klopfer - 11/01/2022
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '732' //// Alterado por Marcelo Klopfer - 11/01/2022
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '701' //// Alterado por Marcelo Klopfer - 11/01/2022
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '732' //// Alterado por Marcelo Klopfer - 11/01/2022
			EndIf
		//Endif
	Endif

Return (_cTes)




	/*====================================================================================\
	|Programa  | AmOper16         | Autor | João Victor              | Data | 20/07/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 16                                                    |
	|          |   16 BONIFICACAO                                                         |
	|=====================================================================================|
	|Sintaxe   | AmOper16                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper16()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 01 à 06
		// regra de 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			Endif
			// regra de 07 à 12
			// regra de 31 à 36
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			EndIf
		Endif

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 13 à 18
		// regra de 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			Endif
			// regra de 19 à 24
			// regra de 43 à 48
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			EndIf
		Endif

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'
		// regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			EndIf
			// regra de 55 à 60
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '739'
			EndIf
		Endif

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '715'
			EndIf
		Endif
	Endif


	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper17         | Autor | João Victor              | Data | 20/07/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 17                                                    |
	|          |   17 AMOSTRA GRATIS                                                      |
	|=====================================================================================|
	|Sintaxe   | AmOper17                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper17()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 01 à 06
		// regra de 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			Endif
			// regra de 07 à 12
			// regra de 31 à 36
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			EndIf
		Endif

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 13 à 18
		// regra de 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			Endif
			// regra de 19 à 24
			// regra de 43 à 48
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			EndIf
		Endif

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'
		// regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			EndIf
			// regra de 55 à 60
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '717'
			EndIf
		Endif

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '718'
			EndIf
		Endif
	Endif


	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper18         | Autor | João Victor              | Data | 20/07/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 18                                                    |
	|          |   18 AMOSTRA GRATIS                                                      |
	|=====================================================================================|
	|Sintaxe   | AmOper18                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper18()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))  .And. &_cTipopv = 'D'
		// regra de 01 à 06
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '749'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '749'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '749'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '749'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '749'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '749'
			Endif
			// regra de 07 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '749'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '749'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '749'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '749'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '749'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '749'
			EndIf
		Endif
	Endif

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper19         | Autor | João Victor              | Data | 22/07/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 19                                                    |
	|          |   19 ANULAÇÃO DE VALORES REF AQUISIÇÃO DE SERVIÇO DE TRANSPORTE          |
	|=====================================================================================|
	|Sintaxe   | AmOper19                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper19()
	*-----------------------------*

	If  &_cTipoCli $ 'F/R' .And. &_cZconsum $ '1/2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 01 à 03
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '748'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '748'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '748'
			Endif
			// regra de 04 à 06
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '748'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '748'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '748'
			EndIf
		Endif
	Endif

	Return (_cTes)





	/*====================================================================================\
	|Programa  | AmOper20         | Autor | João Victor              | Data | 19/08/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 20                                                    |
	|          |   20 COMPLEMENTO DE PRECO                                                |
	|=====================================================================================|
	|Sintaxe   | AmOper20                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper20()
	*-----------------------------*

	If &_cTipopv = 'C'
		If  &_cTipoCli $ 'F/R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
			If   _cEst = &_cCliEst
				If  Substr((&_cCliInscr),1,5) $ '06200/06300'
					// regra de 13 à 18
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '503'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '503'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := ''
					Endif
					// regra de 01 à 06
				Else
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '502'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '502'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := ''
					Endif
				EndIf

				// regra de 07 à 12
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '502'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '502'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				EndIf
			Endif

		ElseIf  &_cTipoCli $ 'F/R' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
			If   _cEst = &_cCliEst
				If  Substr((&_cCliInscr),1,5) $ '06200/06300'
					// regra de 31 à 36
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '504'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '504'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := ''
					Endif

					// regra de 19 à 24
				Else
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '502'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := ''
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '502'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := ''
					EndIf
				Endif
				// regra de 25 à 30
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '502'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '502'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				EndIf
			Endif

		ElseIf  &_cTipoCli $ 'F/R' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'
			// regra de 37 à 42
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '502'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '502'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				EndIf
			Endif


		ElseIf  &_cTipoCli = 'S' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
			// regra de 43 à 48
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '505'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '505'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := ''
				EndIf
			Endif
		Endif
	Endif


	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper21         | Autor | João Victor              | Data | 19/08/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 21                                                    |
	|          |   21 COMPL.  PRECO DESCONTO ZONA FRANCA CFOP 5401                        |
	|=====================================================================================|
	|Sintaxe   | AmOper21                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper21()
	*-----------------------------*


	If  &_cTipoCli = 'S' .And. &_cTipopv = 'C'
		// regra de 01 à 03
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '501'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '501'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '501'
			Endif
		Endif
	Endif

	Return (_cTes)




	/*====================================================================================\
	|Programa  | AmOper22         | Autor | João Victor              | Data | 20/08/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 22                                                    |
	|          |   22 COMPL ICMS VEND C/ST                                                |
	|=====================================================================================|
	|Sintaxe   | AmOper22                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper22()
	*-----------------------------*


	If  &_cTipoCli = 'S' .And. &_cTipopv = 'I'
		// regra de 01 à 03
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '724'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '724'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '724'
			Endif
		Endif
	Endif

	Return (_cTes)






	/*====================================================================================\
	|Programa  | AmOper23         | Autor | João Victor              | Data | 16/09/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 23                                                    |
	|          |   23 RETORNO LOCAÇÃO                                                     |
	|=====================================================================================|
	|Sintaxe   | AmOper23                                                                 |
	|=====================================================================================|
	|Chamado:  | 002618                                                                   |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper23()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		// regra de 01 à 06
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '747'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '747'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '747'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '747'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '747'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '747'
			Endif
			// regra de 07 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '747'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '747'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '747'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '747'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '747'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '747'
			EndIf
		Endif
	Endif

	Return (_cTes)

	/*====================================================================================\
	|Programa  | AmOper24         | Autor | Giovani Zago             | Data | 26/04/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 24                                                    |
	|          |   24 VENDA - MATL USO E CONSUMO c/ estoque                                                    |
	|=====================================================================================|
	|Sintaxe   | AmOper24                                                                 |
	|=====================================================================================|
	|Chamado:  | 003876                                                                   |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper24()
	*-----------------------------*

	_cTes     := '507'

	Return (_cTes)

	/*====================================================================================\
	|Programa  | AmOper25         | Autor | Giovani Zago             | Data | 26/04/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 25                                                    |
	|          |   25 VENDA - MATL USO E CONSUMO s/ estoque                               |
	|=====================================================================================|
	|Sintaxe   | AmOper25                                                                 |
	|=====================================================================================|
	|Chamado:  | 003876                                                                   |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper25()
	*-----------------------------*

	_cTes     := '721'

	Return (_cTes)


	/*====================================================================================\
	|Programa  | AmOper26         | Autor | Giovani Zago             | Data | 26/04/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 26                                                    |
	|          |   26 RETORNO LOCAÇÃO                                                     |
	|=====================================================================================|
	|Sintaxe   | AmOper26                                                                 |
	|=====================================================================================|
	|Chamado:  | 003924                                                                   |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper26()
	*-----------------------------*

	_cTes     := '508'

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper27         | Autor | Giovani Zago             | Data | 26/04/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 27                                                    |
	|          |   27 RET.DEMONSTRAÇÃO S/ICMS                                                    |
	|=====================================================================================|
	|Sintaxe   | AmOper27                                                                 |
	|=====================================================================================|
	|Chamado:  | 003924                                                                   |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper27()
	*-----------------------------*

	_cTes     := '509'

	Return (_cTes)





	/*====================================================================================\
	|Programa  | AmOper28         | Autor | Jefferson Carlos         | Data | 26/09/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 28                                                    |
	|          |   28 RETORNO DE COMODATO                                                     |
	|=====================================================================================|
	|Sintaxe   | AmOper28                                                                 |
	|=====================================================================================|
	|Chamado:  | 004192                                                                   |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper28()
	*-----------------------------*

	If  &_cTipoCli $ 'F/R' .And. &_cZconsum $ '1/2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv = 'D'

		// regra de 01 à 06
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '736'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '736'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '736'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '736'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '736'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '736'
			Endif
			// regra de 07 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '736'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '736'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '736'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '736'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '736'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '736'
			EndIf
		Endif
	Endif

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper29         | Autor | Jefferson Carlos         | Data | 26/09/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 29                                                    |
	|          |   29 VENDA SUCATA COM DIFEREIMENTO C/ ESTOQUE
	|Chamado 004263                                                                       |
	|=====================================================================================|
	|Sintaxe   | AmOper29                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper29()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '753'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '753'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := ''
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | AmOper30         | Autor | Jefferson Carlos         | Data | 26/09/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 30                                                    |
	|          |   30 VENDA SUCATA SEM DIFEREIMENTO C/ ESTOQUE
	|=====================================================================================|
	|Chamado 004263
	|=====================================================================================|
	|Sintaxe   | AmOper30                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK MANAUS                                                  |
	|=====================================================================================|
	|.................................Histórico....................................       |
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper30()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '752'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '752'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := ''
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper31         | Autor | Jefferson Carlos         | Data | 27/09/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 31                                                    |
	|          |   31 - DEVOL ATIVO  C/ ICMS                                              |
	|          |   Chamado 004319                                                         |
	|=====================================================================================|
	|Sintaxe   | AmOper31                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper31()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '742'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '742'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '742'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '742'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '742'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '742'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '742'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '742'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '742'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '742'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '742'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '742'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | AmOper32         | Autor | Jefferson Carlos         | Data | 27/09/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 32                                                    |
	|          |   32 - DEVOL ATIVO  S/ ICMS                                              |
	|          |   Chamado 004319                                                         |
	|=====================================================================================|
	|Sintaxe   | AmOper32                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper32()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '754'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '754'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '754'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '754'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '754'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '754'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '754'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '754'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '754'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '754'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '754'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '754'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | AmOper33         | Autor | Robson Mazzarotto        | Data | 26/01/2018  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 33                                                    |
	|          |   33 - DEVOLUÇÃO DE USO E CONSUMO C/ICMS                                 |
	|          |   Não tinha chamado mas percebi que faltava esta regra                   |
	|=====================================================================================|
	|Sintaxe   | AmOper33                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper33()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '757'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '757'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '757'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '757'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '757'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '757'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '757'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '757'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '757'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '757'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '757'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '757'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | AmOper34         | Autor | Robson Mazzarotto        | Data | 26/01/2018  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 34                                                    |
	|          |   34 - RETORNO DE EMPRESTIMO				                                  |
	|          |   Chamado 005806                                                         |
	|=====================================================================================|
	|Sintaxe   | AmOper34                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper34()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '755'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '755'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '755'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '755'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '755'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '755'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '755'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '755'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '755'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '755'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '755'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '755'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | AmOper35         | Autor | Robson Mazzarotto        | Data | 26/01/2018  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 35                                                    |
	|          |   35 - DEVOLUÇÃO DE COMBUSTIVEL                                          |
	|          |   Chamado 006145                                                         |
	|=====================================================================================|
	|Sintaxe   | AmOper35                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper35()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '761'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '761'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '761'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '761'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '761'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '761'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '761'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '761'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '761'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '761'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '761'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '761'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | AmOper36         | Autor | Robson Mazzarotto        | Data | 26/01/2018  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 36                                                    |
	|          |   36 - DEVOLUÇÃO DE USO E CONSUMO S/ICMS                                 |
	|          |   Chamado 006223                                                        |
	|=====================================================================================|
	|Sintaxe   | AmOper36                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper36()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '722'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '722'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '722'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '722'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '722'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '722'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '722'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '722'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '722'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '722'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '722'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '722'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | AmOper37         | Autor | Robson Mazzarotto        | Data | 26/01/2018  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                     |
	|          |   Tipo de Operação 37                                                    |
	|          |   37 - DEVOLUÇÃO DE COMBUSTIVEL                                          |
	|          |   Chamado 006223                                                         |
	|=====================================================================================|
	|Sintaxe   | AmOper37                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper37()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '762'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '762'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '762'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '762'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '762'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '762'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '762'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '762'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '762'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '762'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '762'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '762'
			EndIf
		EndIf
	EndIf

	Return (_cTes)
//>> Ticket 20210319004465 - Everson Santana - 19.03.2021	
Static Function AmOper38()

	If  &_cTipoCli = 'F'

		_cTes     := '763'

	EndIf

Return (_cTes)
//<<

	/*====================================================================================\
	|Programa  | AmOper39         | Autor | Giovani Zago		     | Data | 13/01/2019  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		  	                                     |
	|          |   Tipo de Operação 39                                                    |
	|          |   39 - DOAÇÃO DE ATIVO			                                          |
	|          |   Chamado 006223                                                         |
	|=====================================================================================|
	|Sintaxe   | AmOper39                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper39()
	*-----------------------------*

 	_cTes     := '720'
 

Return (_cTes)


	/*====================================================================================\
	|Programa  | AmOper40         | Autor | Jose C. Frasson    | Data | 10/12/2020        |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		  	                                      |
	|          |   Tipo de Operação 40                                                    |
	|          |   40 - SALVADOS DE  SINISTRO	                                          |
	|          |   Chamado 20201210012053                                                 |
	|=====================================================================================|
	|Sintaxe   | AmOper40                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function AmOper40()
	*-----------------------------*

 	_cTes     := '764'
 

Return (_cTes)


/*/{Protheus.doc} AmOper41
Entrega Futura - Remessas
@type function
@version 12.1.27
@author Ricardo Munhoz
@since 30/05/2022
@return _cTes, character
/*/
Static Function AmOper41()

	If  &_cTipoCli $ 'F/R' .And. &_cZconsum $ '1/2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ 'B'

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '765'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '765'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '765'
			EndIf
			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '765'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '765'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '765'
			EndIf
		Endif
	EndIf

Return (_cTes)


	/*====================================================================================\
	|Programa  | StOper92         | Autor | GIOVANI.ZAGO             | Data | 21/12/2018  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 90                                                    |
	|          |   92 - TRANSF. ENTRE FILIAIS  GERA OS  RETRABALHO                        |
	|=====================================================================================|
	|Sintaxe   | StOper90                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper92()
	*-----------------------------*

	If  &_cTipoCli = 'F'
	
		If AllTrim(_cEst)==AllTrim(&_cCliEst)

			If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI==0
				_cTes     := '913'
			ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI==0
				_cTes     := '913'
			ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI==0
				_cTes     := '913'
			ElseIf SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI<>0
				_cTes     := '913'
			ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI<>0
				_cTes     := '913'
			ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI<>0
				_cTes     := '913'
			EndIf
		
		EndIf

	EndIf

	Return  (_cTes)


	/*====================================================================================\
	|Programa  | StOper43         | Autor | RENATO.OLIVEIRA          | Data | 24/08/2020  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 43                                                    |
	|          |   Remessa de Industrialização					                          |
	|=====================================================================================|
	|Sintaxe   | StOper43                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper43()
	*-----------------------------*



	If  &_cTipoCli = 'F'
	
		If _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C'
				_cTes     := '903'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '903'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '903'
			EndIf
		
		Else

			If SB1->B1_CLAPROD = 'C'
				_cTes     := '903'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '903'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '903'
			EndIf
		
		EndIf

	EndIf
	
	Return  (_cTes)

	/*====================================================================================\
	|Programa  | StOper16         | Autor | RENATO.OLIVEIRA          | Data | 09/09/2020  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 16                                                    |
	|          |   Transferência entre filiais (GUARAREMA)		                          |
	|=====================================================================================|
	|Sintaxe   | StOper16                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper16()
	*-----------------------------*



	If  &_cTipoCli = 'F'
	
		If _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C'
				_cTes     := '664'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '904'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '664'
			EndIf
		
		Else

			If SB1->B1_CLAPROD = 'C'
				_cTes     := '664'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '904'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '664'
			EndIf
		
		EndIf

	EndIf
	
	Return  (_cTes)	

	/*====================================================================================\
	|Programa  | StOper89         | Autor | RENATO.OLIVEIRA          | Data | 02/09/2019  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 89                                                    |
	|          |   89 -    REMESSA MERCADORIA FALTANTE (ATU ESTOQUE)                      |
	|=====================================================================================|
	|Sintaxe   | StOper89                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper89()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 01 / 25
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 04 / 28
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '890'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '890'
			EndIf

			//Regra de 7 à 12 e 31 à 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '890'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '890'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 13 / 37 
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 16 / 40
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '886'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '886'
			EndIf

			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '886'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '886'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 49
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 52
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '886'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '886'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '889'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '886'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '886'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 888 ITEM DA PLANILHA 61
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '888'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '888'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 64
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '887'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '887'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '888'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '888'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '888'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '888'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '887'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '887'
			EndIf
		EndIf

	EndIf
Return  (_cTes)


/*====================================================================================\
|Programa  | StOper10         | Autor | Jose C. Frasson          | Data | 11/12/2020  |
|=====================================================================================|
|Descrição |   TES INTELIGENTE        		    	                                  |
|          |   Tipo de Operação 10                                                    |
|          |   10 -    REMESSA PARA CONSIGNACAO					                      |
|=====================================================================================|
|Sintaxe   | StOper10                                                                 |
|=====================================================================================|
|Uso       | Especifico STECK                                                         |
|=====================================================================================|
|........................................Histórico....................................|
\====================================================================================*/

Static Function StOper10()
	
	If &_cTipoCli == 'S' .And. Empty(&_cZconsum) .And. &_cCliContrib == '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		dbSelectArea("SF7")
		SF7->( dbSetOrder(4) )	// F7_FILIAL + F7_GRTRIB + F7_GRPCLI + F7_EST + F7_TIPOCLI
		If SF7->( dbSeek(xFilial("SF7") + SB1->B1_GRTRIB + &_cxCliContr + &_cCliEst + &_cTipoCli) )
			If SF7->F7_MARGEM <> 0
				If _cEst == &_cCliEst
					If SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
						_cTes     := '907'
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '908'
					EndIf
					/*
					If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
						_cTes     := '639'
					ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
						_cTes     := '721'
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
						_cTes     := '907'
					ElseIf SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '639'
					ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '591'
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '908'
					EndIf
					*/
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
						_cTes     := '907'
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '908'
					EndIf				
					/*
					If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
						_cTes     := '639'
					ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
						_cTes     := '721'
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
						_cTes     := '907'
					ElseIf SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '639'
					ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '591'
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '908'
					EndIf
					*/
				EndIf
			ElseIf SF7->F7_MARGEM = 0
				If _cEst == &_cCliEst
					If SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
						_cTes     := '909'
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '906'
					ElseIf (SB1->B1_CLAPROD == 'C') .And. (SB1->B1_IPI == 0)               // Valdemir Rabelo 09/05/2022 - Chamado: 20220426008829
						_cTes     := '907'
					EndIf				
					/*
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '560'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '909'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '501'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '906'
					EndIf
					*/
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
						_cTes     := '909'
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '906'
					EndIf
					/*
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '639'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '721'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '909'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '639'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '591'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '906'
					EndIf
					*/
				EndIf
			EndIf
		Else
			If _cEst == &_cCliEst
				If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
					//_cTes     := '935' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 907 ITEM DA PLANILHA 01
					_cTes     := '907'              // Valdemir Rabelo 09/05/2022  Chamado: 20220426008829
				ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
					_cTes     := '910'
				ElseIf SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '935' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 907 ITEM DA PLANILHA 05
				ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '905'
				// 20210803014588 - ERRO NO PEDIDO 628972 FL02 - Eduardo Pereira Sigamat - 17.08.2021 - Inicio 
				ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '906'
				ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
					_cTes     := '909'
				// 20210803014588 - ERRO NO PEDIDO 628972 FL02 - Eduardo Pereira Sigamat - 17.08.2021 - Fim 
				EndIf			
				/*
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '907'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '910'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '639'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '907'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '905'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '908'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '592'
				EndIf
				*/
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
					_cTes     := '907'
				ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
					_cTes     := '910'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '907'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '905'
				EndIf			
				/*
				If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
					_cTes     := '907'
				ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
					_cTes     := '910'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '639'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '907'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '905'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '592'
				EndIf
				*/
			EndIf
		EndIf
	EndIf

Return _cTes


	/*====================================================================================\
	|Programa  | StOper30         | Autor | Jose C. Frasson          | Data | 11/12/2020  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 30                                                    |
	|          |   30 -    VENDA POR CONSIGNACAO					                      |
	|=====================================================================================|
	|Sintaxe   | StOper30                                                                 |
	|=====================================================================================|
	|Uso       | Especifico STECK                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function StOper30()
	*-----------------------------*
	If  &_cTipoCli = 'S' .And. Empty(&_cZconsum) .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		Do Case
		Case _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '912'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '912'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '911'
			EndIf
		Case _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '912'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '912'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '911'
			EndIf
		EndCase
		
	EndIf
Return  (_cTes)

/*====================================================================================\
|Programa  | NCOper01         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
|=====================================================================================|
|Descrição |   TES INTELIGENTE        		    	                                  |
|          |   Tipo de Operação 01                                                    |
|          |   01 - Vendas Nacionais                                                  |
|=====================================================================================|
|Sintaxe   | NCOper01                                                                 |
|=====================================================================================|
|Uso       | Específico NEWCO                                                         |
|=====================================================================================|
|........................................Histórico....................................|
\====================================================================================*/
*-----------------------------*
Static Function NCOper01()
*-----------------------------*

	//Itens marcados na cor VERDE LIMÃO na Planilha Oficial de TES Inteligente
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		// regra de 01 à 06  e 37 à 47
		/*********************************
		Cliente Dentro do Estado
		*********************************/
		IF _cEst = &_cCliEst

			/*************************************************************
			<<< ALTERAÇÃO >>> 
			Ação...........: Regras:
			...............: 1 - Tipo do Cliente "REVENDEDOR"
			...............: 2 - Cliente "DENTRO do estado de SÃO PAULO"
			...............: 3 - Tipo do Produto for "COMPRADO/FABRICADO"
			...............: 4 - Grupo de Tributação do Produto "EM BRANCO" 
			...............: Será aplica a TES 558
			Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
			Data...........: 13/03/2022
			Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
			*************************************************************/				
			IF (SB1->B1_CLAPROD = 'C' .OR. SB1->B1_CLAPROD = 'F') .AND. EMPTY(SB1->B1_GRTRIB)
				_cTes     := '558' 

			/*************************************************************
			<<< ALTERAÇÃO >>> 
			Ação...........: Regras:
			...............: 1 - Tipo do Cliente "REVENDEDOR"
			...............: 2 - Cliente "DENTRO do estado de SÃO PAULO"
			...............: 3 - Tipo do Produto for "COMPRADO/FABRICADO"
			...............: 4 - Grupo de Tributação do Produto "PREENCHIDO" 
			Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
			Data...........: 13/03/2022
			Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
			*************************************************************/				
			ELSEIF (SB1->B1_CLAPROD = 'C' .OR. SB1->B1_CLAPROD = 'F') .AND. !EMPTY(SB1->B1_GRTRIB)

				/*************************************************************
				<<< ALTERAÇÃO >>> 
				Ação...........: Regras:
				...............: 1 - Se Existir na tabela "SF7"
				...............: 2 - Grupo de Tributação			Exemplo 046
				...............: 3 - Grupo do Cliente					Exemplo 001
				...............: 4 - Para dentro do Estado SP	Exmplo  SP
				...............: 5 - Tipo do Cliente 					Exemplo R	
				...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
				...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
				...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
				Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
				Data...........: 22/03/2022
				Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
				*************************************************************/				
				SF7->(DbSetOrder(4))
				IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
					IF SF7->F7_MARGEM > 0
						_cTes := '916' 
					ELSEIF SF7->F7_MARGEM = 0
						_cTes := '558' 
					ENDIF
				ELSE
					_cTes := '558' 
				ENDIF

			/*************************************************************
			<<< ALTERAÇÃO >>> 
			Ação...........: Regras:
			...............: 1 - Tipo do Cliente "REVENDEDOR"
			...............: 2 - Cliente "DENTRO do estado de SÃO PAULO"
			...............: 3 - Tipo do Produto for "IMPORTADO"
			...............: 4 - Grupo de Tributação do Produto "PREENCHIDO" 
			...............: 5 - Valor do IPI for "IGUAL A ZERO" Será aplciada a TES 558
			...............: 6 - Valor do IPI for "MAIOR QUE ZERO" Será aplciada a TES 506
			Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
			Data...........: 13/03/2022
			Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
			*************************************************************/				
			ELSEIF SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ELSEIF  SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '506'
			ENDIF

		ElseIf _cEst <> &_cCliEst

			If  !(Empty(ALLTRIM( &_cCliSufra)))

				If alltrim(&_cCliMun) $ ('04062') .And. &_cCliEst = 'AM' .and.  &_cCliCep = '069640970'	// regra  191 à 196 = 197 à 202

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
					EndIf


				ElseIf alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'	// regra  125 à 130 = 155 à 160

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '610' //Alterada a TES de 509 para 610 em 02/04/2013 solicitado por Verônica Brandão
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
					EndIf

				ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'	// regra  161 à 166 = 167 à 172

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '610'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '685'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '610'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '610'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '685'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
					EndIf



				ElseIf !(alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252')) .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  173 à 178 = 179 à 184

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '544'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '542'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '544'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '544'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '542'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '830'//Alterado por João Victor em 31/01/2014 de 585 para 830 conforme chamado 000139
					EndIf

				ElseIf alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252') .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  143 à 148 = 185 à 190

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '610'//TROCADO DE 509 PARA 610 SOLICITAÇÃO VERONICA BRANDAO .....giovani 23/04/2013
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '509'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '508'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '827'//Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
					EndIf

				EndIf

			Else	// regra  7 à 12 e 43 à 48
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '560'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '560' //// Alterado por Marcelo Klopfer - 07/01/2022 - TES ANTERIOR 501 ITEM DA PLANILHA 08
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '506'
				EndIf

			EndIf

		EndIf

	/****************************
		1 - Consumidor Final = "F"
		2 - Apresenta Tela = "2" Consumo Próprio.
		3 - Contribuinte = "1" SIM
		4 - Possui Inscrição Estadual ou ISENTO
		5 - Somente para os Estados "MG e PR"
	****************************/
	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))).And. ( &_cCliEst $ 'MG#PR')
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '929'	//// Alterado por Marcelo Klopfer - 27/01/2022 - TES ANTERIOR 872 ITEM DA PLANILHA XXX
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '929'	//// Alterado por Marcelo Klopfer - 27/01/2022 - TES ANTERIOR 873 ITEM DA PLANILHA XXX
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '872'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '929'	//// Alterado por Marcelo Klopfer - 27/01/2022 - TES ANTERIOR 872 ITEM DA PLANILHA XXX
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '929' //// Alterado por Marcelo Klopfer - 27/01/2022 - TES ANTERIOR 874 ITEM DA PLANILHA XXX
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '875'
		EndIf



		//nova regra solicitada pela veronica em 07/12/18 - chamado 008623
	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))).And. ( &_cCliEst $ 'PE')
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '891'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '892'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '891'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '891'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '893'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '894'
		EndIf

		//Itens marcados na cor AZUL ESCURO na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))


		If !(Empty(ALLTRIM( &_cCliSufra)))

			If alltrim(&_cCliMun) $ ('04062') .And. &_cCliEst = 'AM' .and.  &_cCliCep = '069640970'	// regra  233 à 238 = 239 à 244

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'	// regra  131 à 136 = 203 à 208

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'	// regra  137 à 142  = 209 à 214

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252')) .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  221 à 226 = 227 à 232

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252') .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  149 à 154 = 215 à 220

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '621'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '599'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
				EndIf
			EndIf
		Else
			// regra de 13 à 18 e 61 à 66
			/****************************
			1 - Consumidor Final = "F"
			2 - Apresenta Tela = "2" Consumo Próprio.
			3 - Contribuinte = "1" SIM
			4 - Possui Inscrição Estadual ou ISENTO
			5 - Dentro do Estado
			****************************/
			IF   _cEst = &_cCliEst 
			
				/*************************************************************
				<<< ALTERAÇÃO >>> 
				Ação...........: Regras:
				...............: 1 - Se Existir na tabela "SF7"
				...............: 2 - Grupo de Tributação			Exemplo 046
				...............: 3 - Grupo do Cliente					Exemplo 001
				...............: 4 - Para dentro do Estado SP	Exmplo  SP
				...............: 5 - Tipo do Cliente 					Exemplo R	
				...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
				...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
				...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
				Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
				Data...........: 22/03/2022
				Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
				*************************************************************/				
				SF7->(DbSetOrder(4))
				IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
					IF SF7->F7_MARGEM > 0
						_cTes := '916' 
					ELSEIF SF7->F7_MARGEM = 0
						_cTes := '558' 
					ENDIF
				ELSE
					_cTes := '558' 
				ENDIF
			
				/******************************
				1 - Consumidor Final = "F"
				2 - Apresenta Tela = "2" Consumo Próprio.
				3 - Contribuinte = "1" SIM
				4 - Produto "I" importado
				5 - Grupo de Tributação está "PREENCHIDO"
				6 - IPI do protuo for "IGUAL A ZERO"
				******************************/
				IF SB1->B1_CLAPROD = "I" .AND. !EMPTY(SB1->B1_GRTRIB) .AND. SB1->B1_IPI = 0
					_cTes     := '558'

				/******************************
				1 - Consumidor Final = "F"
				2 - Apresenta Tela = "2" Consumo Próprio.
				3 - Contribuinte = "1" SIM
				4 - Produto "I" importado
				5 - Grupo de Tributação está "PREENCHIDO"
				6 - IPI do protuo for "MAIOR QUE ZERO"
				******************************/
				ELSEIF SB1->B1_CLAPROD = "I" .AND. !EMPTY(SB1->B1_GRTRIB) .AND. SB1->B1_IPI > 0
					_cTes     := '572' //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTIDA A TES 572 ITEM DA PLANILHA 66

				/******************************
				1 - Consumidor Final = "F"
				2 - Apresenta Tela = "2" Consumo Próprio.
				3 - Contribuinte = "1" SIM
				4 - Produto "I" importado
				5 - Grupo de Tributação está "EM BRANCO"
				6 - IPI do produto for "IGUAL A ZERO"
				******************************/
				ELSEIF SB1->B1_CLAPROD = "I" .AND. EMPTY(SB1->B1_GRTRIB) .AND. SB1->B1_IPI = 0
					_cTes     := '558'

				/******************************
				1 - Consumidor Final = "F"
				2 - Apresenta Tela = "2" Consumo Próprio.
				3 - Contribuinte = "1" SIM
				4 - Produto "I" importado
				5 - Grupo de Tributação está "EM BRANCO"
				6 - IPI do protuo for "MAIOR QUE ZERO"
				******************************/
				ELSEIF SB1->B1_CLAPROD = "I" .AND. EMPTY(SB1->B1_GRTRIB) .AND. SB1->B1_IPI > 0
					_cTes     := '572' //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTIDA A TES 572 ITEM DA PLANILHA 66
				ENDIF

				// regra 19 à 24 e 67 à 72 - Excluído chamado 002456
				// regra 67 à 72
			ElseIf _cEst <> &_cCliEst
				If !( &_cCliEst $ 'MG/RS/SC/BA/AL/AP/DF/ES/GO/PE/PR/RJ/SE') //.And.  !( &_cCliEst $ 'MG/RS/SC/BA')//Chamado 002456
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '560'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					  _cTes     := '558' //// Alterado por Marcelo Klopfer - 19/04/2022 - ALTERADA A TES 502 PARA 558
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '572'
					EndIf
					// regra 19 à 24 //Chamado 002456 - Realizado ajuste nessa regra pois a mesma estava sendo considerada junto com a regra 67 à 72
				Else
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '560'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '558'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '558' //// Alterado por Marcelo Klopfer - 19/04/2022 - ALTERADA A TES 502 PARA 558
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '572'
					EndIf
				EndIf

			EndIf
		Endif



		//Itens marcados na cor VINHO na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		If !(Empty(ALLTRIM( &_cCliSufra)))

			If alltrim(&_cCliMun) $ ('04062') .And. &_cCliEst = 'AM' .and.  &_cCliCep = '069640970'	// regra  245 à 250

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '578'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '503'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'	// regra  251 à 256

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '680'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '680' //Alterado em 30/04/2013 de 677 para 680 por João Victor conforme solicitação de Verônica Brandão.
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '829' //Alterado por João Victor em 31/01/2014 de 678 para 829 conforme chamado 000139
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'	// regra  257 à 262

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '680'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '679'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '680'//Alterado em 30/04/2013 de 677 para 680 por João Victor conforme solicitação de Verônica Brandão.
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '829' //Alterado por João Victor em 31/01/2014 de 678 para 829 conforme chamado 000139
				EndIf

			ElseIf !(alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252')) .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  263 à 268

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '578'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '578'//Alterado em 30/04/2013 de 503 para 578 por João Victor conforme solicitação de Verônica Brandão.
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '831' //Alterado por João Victor em 31/01/2014 de 507 para 831 conforme chamado 000139
				EndIf

			ElseIf alltrim(&_cCliMun) $ ('00303/00600/00159/00100/00456/00106/00203/00104/00252') .And. &_cCliEst $ 'AC/AP/RO/RR'	// regra  269 à 274

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '578'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '578'//Alterado em 30/04/2013 de 503 para 578 por João Victor conforme solicitação de Verônica Brandão.
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '831' //Alterado por João Victor em 31/01/2014 de 507 para 831 conforme chamado 000139
				EndIf


			EndIf
		Else

			// regra de 55 à 60
			//	If 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)) .And.  &_cCliEst $ 'BA' .And. !(&_cCliEst) $ 'MS'
			/*
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '639'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '721'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '639'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '595'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '591'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '592'
			EndIf

			*/ //chamado 001008 giovani zago 30/09/14
			// regra de 25 à 30 e de 93 à 98
			//ElseIf   _cEst = &_cCliEst

			/****************************
			1 - Consumidor Final = "F"
			2 - Apresenta Tela = " " 
			3 - Contribuinte = "2"
			4 - Possui Inscrição Estadual ou ISENTO
			5 - Dentro do Estado
			6 - COM ICMSST
			****************************/
			IF _cEst = &_cCliEst


				/****************************
				1 - Dentro do Estado
				2 - Produto for Comprado ou Fabricado
				3 - Grupo de Tributação PREENCHIDO
				****************************/
				IF (SB1->B1_CLAPROD = 'C' .OR. SB1->B1_CLAPROD = 'F') .AND. !EMPTY(SB1->B1_GRTRIB)

					/*************************************************************
					<<< ALTERAÇÃO >>> 
					Ação...........: Regras:
					...............: 1 - Se Existir na tabela "SF7"
					...............: 2 - Grupo de Tributação			Exemplo 046
					...............: 3 - Grupo do Cliente					Exemplo 001
					...............: 4 - Para dentro do Estado SP	Exmplo  SP
					...............: 5 - Tipo do Cliente 					Exemplo F - Consumidor Final	
					...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
					...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
					...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
					Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
					Data...........: 22/03/2022
					Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
					*************************************************************/				
					SF7->(DbSetOrder(4))
					IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
						IF SF7->F7_MARGEM > 0
							_cTes := '916' 
						ELSEIF SF7->F7_MARGEM = 0
							_cTes := '558' 
						ENDIF
					ELSE
						_cTes := '558' 
					ENDIF

				/****************************
				1 - Dentro do Estado
				2 - Produto for Comprado ou Fabricado
				3 - Grupo de Tributação EM BRANCO
				****************************/
				ELSEIF (SB1->B1_CLAPROD = 'C' .OR. SB1->B1_CLAPROD = 'F') .AND. EMPTY(SB1->B1_GRTRIB)
					_cTes := '558' 

				/****************************
				1 - Dentro do Estado
				2 - Produto for IMPORTADO
				3 - Grupo de Tributação PREENCHIDO OU EM BRANCO
				****************************/
				ELSEIF SB1->B1_CLAPROD = 'I'
					_cTes     := '572'  //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTIDA A TES ANTERIOR 572 ITEM DA PLANILHA 66
				ENDIF

			ElseIf _cEst <> &_cCliEst /*.And. !(&_cCliEst) $ 'MS'*/	// regra de 31 à 36 e de 99 à 104
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '578'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '565'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '578' //// Alterado por Marcelo Klopfer - 13/01/2021 - TES ANTERIOR 503
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '507'
				EndIf

				/*
			Elseif &_cCliEst $ 'MS' // regra de 287 à 292
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '639'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '721'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '639'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '595'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '591'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '592'
				EndIf
				*/ //chamado 001008 giovani zago 30/09/14
			EndIf
		EndIf

		//Itens marcados na cor VERDE ÁGUA na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))).And. ( &_cCliEst $ 'MG/RS/SC/BA/AL/AP/DF/ES/GO/PE/PR/RJ/SE')//( &_cCliEst $ 'MG/RS/SC/BA/AL/AP/DF/ES/GO/PE/PR/RJ/SE')CHAMADO VERONICA 21/06/17  //( &_cCliEst $ 'MG/RS/SC/BA')Chamado 002456

		If lRICMSST
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '916'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '916'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '558' //506
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '916'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '916'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '506' //560
			EndIf
			Return _cTes
		End If
		
		DbSelectArea("SF7")
		SF7->(DbSetOrder(4))
		//SF7->(DbOrderNickName("NICKSF7"))
		//F7_FILIAL+F7_GRTRIB    +F7_GRPCLI     +F7_EST +F7_TIPOCLI
		//Filial   + Grupo Trib. + Grp.Cli./For + Estado+ Tipo do Cliente
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			// regra de 49 à 54
			If SF7->F7_MARGEM <> 0 
				If &_cCliEst <> 'MG'
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '924' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 639 ITEM DA PLANILHA 49 / 53
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '929' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 721 ITEM DA PLANILHA 49 / 53
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '639'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '924' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 639 ITEM DA PLANILHA 49 / 53
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '920' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 591 ITEM DA PLANILHA 49 / 53
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '592'
					EndIf

				EndIf

				// regra de 299 à 304 Chamado 002456
			ElseIf SF7->F7_MARGEM = 0
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '560'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '560'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '506'
				EndIf
			Endif

		Else
			// regra de 293 à 298 Chamado 002456
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '560'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '502'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '572'
			EndIf
		Endif


		//Itens marcados na cor LARANJA na Planilha Oficial de TES Inteligente
	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) <> '1'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		If lRICMSST
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '916'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '916'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '558' //506
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '916'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '916'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '506' //560
			EndIf
			Return _cTes
		End If

		DbSelectArea("SF7")
		//SF7->(DbOrderNickName("NICKSF7"))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))/* .And. (!(&_cCliEst = 'MT')*/ .And. !(&_cxCliContr $ '004/005/006/007')
			// regra de 73 à 78 e 105 à 110

			/*********************************************
			<<<< ALTERAÇÃO >>>>
			Ação.........: Alteração Tes Inteligente 
			Desenvolvedor: Marcelo Klopfer Leme - SIGAMAT
			Data.........: 07/03/2022
			Chamados.....: 20220221004212
			****************************************/	
			IF	_cEst = &_cCliEst
				IF SB1->B1_CLAPROD = 'C' 
					IF SF7->F7_MARGEM <> 0
						_cTes     := '916'
					ELSE
						_cTes     := '558'
					ENDIF
				ELSEIF SB1->B1_CLAPROD = 'F'
					IF SF7->F7_MARGEM <> 0
						_cTes     := '916'
					ELSE
						_cTes     := '560'
					ENDIF
				ELSEIF SB1->B1_CLAPROD = 'I' 
					IF SF7->F7_MARGEM <> 0
						IF SB1->B1_IPI = 0
							_cTes     := '513'
						ELSEIF SB1->B1_IPI <> 0
							_cTes     := '543'
						ENDIF
					ELSE
						IF SB1->B1_IPI <> 0
							_cTes     := '506'
						ELSEIF SB1->B1_IPI = 0
							_cTes     := '558'
						ENDIF
					ENDIF
				ENDIF

				// regra de 79 à 86 e 111 à 118
			/*************************************************
			Venda para:
			1 - FORA do Estado
			*************************************************/
			ElseIf   _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '918' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 513 ITEM DA PLANILHA 79 / 111
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '918' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 513 ITEM DA PLANILHA 83 / 115
				ElseIf SB1->B1_CLAPROD = 'I'
					If SF7->F7_MARGEM <> 0
						If  SB1->B1_IPI <> 0
							_cTes     := '543'  //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTER TES 543 ITEM DA PLANILHA 117
						ElseIf  SB1->B1_IPI = 0
							_cTes     := '513'
						EndIf
					ElseIf SF7->F7_MARGEM = 0
						If  SB1->B1_IPI <> 0
							_cTes     := '506'
						ElseIf  SB1->B1_IPI = 0
							_cTes     := '558'   //// Alterado por Marcelo Klopfer - 21/12/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 121
						EndIf
					EndIf
					//Chamado 003273
				ElseIf SB1->B1_CLAPROD = 'F'
					If SF7->F7_MARGEM <> 0
						If  SB1->B1_IPI <> 0
							_cTes     := '917'  //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 504 ITEM DA PLANILHA 84 / 116
						ElseIf  SB1->B1_IPI = 0
							_cTes     := '919' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 559 ITEM DA PLANILHA 80 / 112
						EndIf
					ElseIf SF7->F7_MARGEM = 0
						If  SB1->B1_IPI <> 0
							_cTes     := '560'
						ElseIf  SB1->B1_IPI = 0
							_cTes     := '560'
						EndIf
					EndIf
				EndIf
			EndIf

			// regra de 87 à 92 - Regra cancelada em 02/04/2013 por Verônica Brandão
			// regra de 87 à 92 - Regra reativada em 11/02/2015 por Verônica Brandão - chamado 001506
		ELSE
			
			/*************************************************
			Venda para:
			1 - Dentro do Estado
			2 - COM ICMSST
			3 - Cliente SOLIDARIO
			*************************************************/
			If   _cEst = &_cCliEst .AND. !EMPTY(SB1->B1_GRTRIB)
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '916' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 87
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '916' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 560 ITEM DA PLANILHA 88
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '558'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '916' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 558 ITEM DA PLANILHA 90
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '916' //// Alterado por Marcelo Klopfer - 30/09/2021 - TES ANTERIOR 516 ITEM DA PLANILHA 91
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '543' //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTER TES 543 ITEM DA PLANILHA 78
				EndIf

			/*************************************************
			Venda para:
			1 - Dentro do Estado
			2 - SEM ICMSST
			3 - Cliente SOLIDARIO
			*************************************************/
			ELSEIF   _cEst = &_cCliEst .AND. EMPTY(SB1->B1_GRTRIB)
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '558' //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTER TES 558 ITEM DA PLANILHA 87
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '560' //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTER TES 560 ITEM DA PLANILHA 88
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '558'  //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTER TES 558 ITEM DA PLANILHA 89
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '558' //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTER TES 558 ITEM DA PLANILHA 90
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '560'  //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTER TES 501 ITEM DA PLANILHA 91
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '506' //// Alterado por Marcelo Klopfer - 21/12/2021 - TES ALTERIOR 543 ITEM DA PLANILHA 110
				EndIf
				//Else
				
			// regra de 275 à 280
			ElseIf   _cEst <> &_cCliEst
				If &_cCliEst = 'MT' .And. 	&_cxCliContr = '004' .And. Getmv('ST_MTSTOP',,.F.)// giovani zago 28/01/2020 ajuste do estado MT ticket 20200124000120
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '923' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 627 ITEM DA PLANILHA 275
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '927' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 621 ITEM DA PLANILHA 276
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '627'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '923' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 627 ITEM DA PLANILHA 278
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '922' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 626 ITEM DA PLANILHA 276
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '632' //ALTERADO DE 626 PARA 632  19/04/2013
					EndIf

					// regra de 281 à 286
				ElseIf &_cCliEst = 'MT' .And. 	&_cxCliContr $ '005/006/007' .And. Getmv('ST_MTSTOP',,.F.)// giovani zago 28/01/2020 ajuste do estado MT ticket 20200124000120
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '925' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 640 ITEM DA PLANILHA 281
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '928' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 682 ITEM DA PLANILHA 282
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '640'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '925' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 640 ITEM DA PLANILHA 284
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '926' //// Alterado por Marcelo Klopfer - 16/11/2021 - TES ANTERIOR 641 ITEM DA PLANILHA 285
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '642'
					EndIf

				Else	// regra de 119 à 124
					/*************************************************
					Venda para:
					1 - FORA do Estado
					2 - SEM ICMSST
					3 - Cliente SOLIDARIO
					*************************************************/
					IF _cEst <> &_cCliEst
						If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
							_cTes     := '558'
						ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
							_cTes     := '560'
						ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
							_cTes     := '558'
						ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
							_cTes     := '558' //// Alterado por Marcelo Klopfer - 21/12/2021 - MANTIDA TES 558 ITEM DA PLANILHA 123
						ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
							_cTes     := '560'
						ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
							_cTes     := '506'
						EndIf
					ENDIF
				EndIf
			EndIf
		EndIf
	EndIf
Return  (_cTes)


	/*====================================================================================\
	|Programa  | NCOper08         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 08                                                    |
	|          |   08 - Trading                                                           |
	|=====================================================================================|
	|Sintaxe   | NCOper08                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper08()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 01 à 06 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
			//Regra de 07 à 12 e 31 à 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 19 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '540'
			EndIf
		EndIf

	EndIf

	Return (_cTes)

	/*====================================================================================\
	|Programa  | NCOper11         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 11                                                    |
	|          |   11 - REM INDUSTRIALIZAÇÃO POR CONTA E ORDEM                                                           |
	|=====================================================================================|
	|Sintaxe   | NCOper11                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper11()
	*-----------------------------*


	_cTes     := '836'


	Return (_cTes)

	/*====================================================================================\
	|Programa  | NCOper12         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 12                                                    |
	|          |   12 - DEMOSTRACAO                                                       |
	|=====================================================================================|
	|Sintaxe   | NCOper12                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper12()
	*-----------------------------*

	// regra de 01 à 12
	If  &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '651'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '651'
		EndIf
		// regra de 13 à 24
	ElseIf  &_cTipoCli = 'F' .And. &_cCliContrib = '2'
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '524'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '576'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '576'
		EndIf
	Endif

	Return  (_cTes)

	/*====================================================================================\
	|Programa  | NCOper36         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 36                                                    |
	|          |   36 - DEV.REM.P/CONSERTO- CONSUMOS                                      |
	|=====================================================================================|
	|Sintaxe   | NCOper36                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper36()
	*-----------------------------*

	// regra de 01 à 06
	If  &_cTipoCli = 'F'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '527'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '527'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '527'
		EndIf
	Endif

	Return  (_cTes)




	/*====================================================================================\
	|Programa  | NCOper37         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 37                                                    |
	|          |   37 - REMESSA P/ CONSERTO                                               |
	|=====================================================================================|
	|Sintaxe   | NCOper37                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper37()
	*-----------------------------*

	// regra de 01 à 06
	If  &_cTipoCli = 'F'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '526'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '526'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '526'
		EndIf
	Endif

	Return  (_cTes)






	/*====================================================================================\
	|Programa  | NCOper46         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 46                                                    |
	|          |   46 - VENDA FUNDACAO                                                    |
	|=====================================================================================|
	|Sintaxe   | NCOper46                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper46()
	*-----------------------------*

	//Regra de 01 à 12 -> Alterado o Tipo de Cliente do Cadastro de Cliente e do Pedidos de Venda de R=REVENDEDOR para F=CONSUMIDOR FINAL em 08/05/2013 solicitado por Verônica Brandão
	//Regra de 01 à 12 -> Alterado o Tipo de Cliente do Cadastro de Cliente e do Pedidos de Venda de F=CONSUMIDOR FINAL para R=REVENDEDOR e contribuinte de NÃO para SIM  em 15/05/2013 solicitado por Verônica Brandão
	// regra de 01 à 12
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. &_cAtividade = '000054'.And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')
		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '619'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '720'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '619'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '720'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'R' .And. &_cCliContrib = '2' .And. &_cAtividade = '000054' .And. &_cTipopv $ ('N')
		//Regra de 13 à 18
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '718'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '620'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '619'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '720'
			EndIf

			//Regra de 19 à 24
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '813'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '812'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '813'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '813'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '811'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '814'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper73         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 73                                                    |
	|          |   73 - VENDA - FAB.MAT INFORMATICA                                       |
	|=====================================================================================|
	|Sintaxe   | NCOper73                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper73()
	*-----------------------------*

	If &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. &_cAtividade = '000007'.And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		//Regra de 01 à 06
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '560'//Alterada a TES de 705 para 752 em 15/05/2013 solicitado por Verônica Brandão//Alterada a TES de 752 para 560 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '549'//Alterada a TES de 548 para 549 em 15/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '560'//Alterada a TES de 705 para 752 em 15/05/2013 solicitado por Verônica Brandão//Alterada a TES de 752 para 560 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '548'
			EndIf
			//Regra de 07 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '560'//Alterada a TES de 705 para 752 em 15/05/2013 solicitado por Verônica Brandão//Alterada a TES de 752 para 560 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '549'//Alterada a TES de 548 para 549 em 15/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '560'//Alterada a TES de 705 para 752 em 15/05/2013 solicitado por Verônica Brandão//Alterada a TES de 752 para 560 em 20/05/2013 solicitado por André Almeida
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '548'
			EndIf
		Endif

	Elseif &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. &_cAtividade = '000007'.And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		//Regra de 13 à 18
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '548'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '502'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '572'//Alterada a TES de 754 para 572 em 20/05/2013 solicitado por André Almeida
			EndIf
			//Regra de 19 à 24
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '548'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '502'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '572'//Alterada a TES de 754 para 572 em 20/05/2013 solicitado por André Almeida
			EndIf
		Endif
	Endif

	Return  (_cTes)


	/* Regra cancelada em 15/05/2013 por João Victor devido a solicitação de Verônica Brandão
	// regra de 01 à 12
	If  &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. &_cAtividade = '000007' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
	DbSelectArea("SF7")
	SF7->(DbOrderNickName("NICKSF7"))
		If !SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
	_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
	_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
	_cTes     := '548'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
	_cTes     := '549'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
	_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
	_cTes     := '548'
			EndIf
		Endif
	Endif
	*/



	/*====================================================================================\
	|Programa  | NCOper74         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 74                                                    |
	|          |   74 - REMESSA P/ INDUTRIALIZACAO                                        |
	|=====================================================================================|
	|Sintaxe   | NCOper74                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper74()
	*-----------------------------*

	// regra de 01 à 03
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '518'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '518'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '518'
			EndIf
			// regra de 04 à 06
		Elseif _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '518'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '518'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '518'
			EndIf
		Endif
	Endif

	Return  (_cTes)


	/*====================================================================================\
	|Programa  | NCOper78         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 78                                                    |
	|          |   78 - VENDA ESTALEIRO                                                   |
	|=====================================================================================|
	|Sintaxe   | NCOper78                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper78()
	*-----------------------------*

	// regra de 01 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cAtividade = '000008' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cZconsum = '2'
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '795'//Alterada a TES de 618 para 795 em 13/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '795'//Alterada a TES de 618 para 795 em 13/06/2013 solicitado por Verônica Brandão
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '795'//Alterada a TES de 618 para 795 em 13/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '795'//Alterada a TES de 618 para 795 em 13/06/2013 solicitado por Verônica Brandão
			EndIf
		Endif
		//Regra de 13 à 24
	ElseIf  &_cTipoCli = 'F' .And. &_cCliContrib = '2' .And. &_cAtividade = '000008' .And. &_cZconsum = '2'
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '795'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '794'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '793'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '794'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '794'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '793'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '796'
			EndIf
		Endif
	ElseIf &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. &_cAtividade = '000008' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cZconsum = '1'
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '795'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '550'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '618'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '795'
			EndIf
		Endif
	Endif


	Return  (_cTes)




	/*====================================================================================\
	|Programa  | NCOper88         | Autor | GIOVANI.ZAGO             | Data | 10/09/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 88                                                    |
	|          |   88 - TRANSF. ENTRE FILIAIS  GERA OS                                    |
	|=====================================================================================|
	|Sintaxe   | NCOper88                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper88()
	*-----------------------------*

	// regra de 01 à 03
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (_cEst = &_cCliEst) .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '664'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '663'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '664'
		Endif
	Endif

	Return  (_cTes)













	/*====================================================================================\
	|Programa  | NCOper94         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 94                                                    |
	|          |   94 - TRANSF. ENTRE FILIAIS                                             |
	|=====================================================================================|
	|Sintaxe   | NCOper94                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper94()
	*-----------------------------*

	// regra de 01 à 03
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			// regra de 01 à 03
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '664'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '848'//Chamado 002252 Alterar de TES 663 para TES 848
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '664'
				// regra de 04 à 06 - Chamado 002252
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '664'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '663'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '664'
			EndIf
		Endif
	Endif

	Return  (_cTes)


	/*====================================================================================\
	|Programa  | NCOper95         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 95                                                    |
	|          |   95 - REM POR CONTA E ORDEM                                             |
	|=====================================================================================|
	|Sintaxe   | NCOper95                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper95()
	*-----------------------------*

	// regra de 01 à 06
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '581'
		Endif

		//regra de 07 à 12
	Elseif &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '581'
		Endif

		//regra de 13 à 18
	Elseif &_cTipoCli = 'F' .And. &_cCliContrib = '2'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '581'
		Endif

		//regra de 19 à 24
	Elseif &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '581'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '581'
		Endif

	Endif
	Return  (_cTes)


	/*====================================================================================\
	|Programa  | NCOper28         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 28                                                    |
	|          |   28 -    REMESSA MERCADORIA FALTANTE                                          |
	|=====================================================================================|
	|Sintaxe   | NCOper28                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper28()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//			IF SF7->F7_MARGEM > 0

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '898'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '902'
//						Else
							_cTes     := '899'
//						EndIf
					EndIf
				EndIf

			/************************************
			MARGEM IGUAL A ZERO
			************************************/
/*
			ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '898'
						Else
							_cTes     := '898'
						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '902'
						Else
							_cTes     := '899'
						EndIf
					EndIf
				EndIf
			ENDIF
*/
		ELSE

			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '901'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '901'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '901'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '901'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '901'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '898'
//					Else
						_cTes     := '898'
//					EndIf
				EndIf
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '901'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '901'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '901'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '901'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '901'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '902'
//					Else
						_cTes     := '902'
//					EndIf
				EndIf
			EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//			IF SF7->F7_MARGEM > 0

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
/*
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '898'
						Else
							_cTes     := '898'
						EndIf
*/
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
/*
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '898'
						Else
							_cTes     := '898'
						EndIf
*/
					EndIf
				EndIf

			/************************************
			MARGEM IGUAL A ZERO
			************************************/
/*
			ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '899'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '898'
						Else
							_cTes     := '899'
						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					EndIf
				EndIf
			ENDIF
*/
		ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '898'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '900'
//						EndIf
					EndIf
				EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//			IF SF7->F7_MARGEM > 0

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
/*
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '898'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '898'
//						EndIf
*/
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '900'
//						EndIf
/*
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '898'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '898'
*/
					EndIf
				EndIf

			/************************************
			MARGEM IGUAL A ZERO
			************************************/
/*
			ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '899'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '898'
						Else
							_cTes     := '899'
						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					EndIf
				EndIf
			ENDIF
*/
		ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
							_cTes     := '901'
//						Else
//							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '898'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '898'
//						EndIf
					EndIf
				EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		If lRICMSST
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '933' //'901'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '933' //'901'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '901' //'901'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '933' //'901'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '933' //'901'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '902' //'902'
			EndIf
			Return _cTes
		End If

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//			IF SF7->F7_MARGEM > 0

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7__GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '933'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '899'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '899'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '899'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '900'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						IF SF7->F7_MARGEM > 0
							_cTes     := '899'
						Else
							_cTes     := '902'
						EndIf
					EndIf
				EndIf

			/************************************
			MARGEM IGUAL A ZERO
			************************************/
/*
			ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '899'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '898'
						Else
							_cTes     := '899'
						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					EndIf
				EndIf
			ENDIF
*/
		ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '898'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '901'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '902'
//						EndIf
					EndIf
				EndIf
		ENDIF

	EndIf
	Return  (_cTes)


	/*====================================================================================\
	|Programa  | NCOper66         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 66                                                    |
	|          |   66 - COMPL ICMS CFOP 5401                                              |
	|=====================================================================================|
	|Sintaxe   | NCOper66                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper66()
	*-----------------------------*

	//Regra de 1 à 6
	If  &_cTipoCli = 'S'
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '707'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '603'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '707'
		Endif
	Endif

	Return  (_cTes)


	/*====================================================================================\
	|Programa  | NCOper67         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 67                                                    |
	|          |   67 - COMPL ICMS CFOP 5403                                              |
	|=====================================================================================|
	|Sintaxe   | //Solicitado exclusão de regra pela senhora Veronica Brandão chamado 004748                                                             |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
	Static Function NCOper67()
	*-----------------------------*

	If  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) <> '1'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		DbSelectArea("SF7")
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "707"
							Else
								_cTes := "707"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
				EndIf
			Else //Não tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "707"
						Else
							_cTes := "707"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	Return  (_cTes)



	/*====================================================================================\
	|Programa  | NCOper68         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 68                                                    |
	|          |   68 - COMPL ICMS ST CFOP 5101                                           |
	|=====================================================================================|
	|Sintaxe   | NCOper68                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper68()
	*-----------------------------*

	//Regra de 1 à 6
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cTipopv $ ('I')
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '657'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '657'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '657'
		Endif

		//Regra de 7 à 12
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cTipopv $ ('I')
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '657'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '657'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '657'
		Endif

	ElseIf  &_cTipoCli = 'S' .And. &_cZconsum = ' ' .And. &_cTipopv $ ('I')
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '657'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '657'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '657'
		Endif
	Endif

	Return (_cTes)

	/*====================================================================================\
	|Programa  | NCOper69         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 69                                                    |
	|          |   69 - COMPL ICMS ST CFOP 5102                                           |
	|=====================================================================================|
	|Sintaxe   | NCOper69                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper69()
	*-----------------------------*

	//Regra de 1 à 6
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cTipopv $ ('I')
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '659'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '659'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '659'
		Endif

		//	Regra de 7 à 12
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cTipopv $ ('I')
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '659'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '659'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '659'
		Endif

	ElseIf  &_cTipoCli = 'S' .And. &_cZconsum = ' ' .And. &_cTipopv $ ('I')
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '659'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '659'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '659'
		Endif

	Endif

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper32         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 32                                                    |
	|          |   32 - VENDA DO ATIVO                                                    |
	|=====================================================================================|
	|Sintaxe   | NCOper32                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper32()
	*-----------------------------*

	//Das regras de 01 à 60 -> Alterada a TES de 531 para 692 em 08/05/2013 solicitado por Verônica Brandão
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 01 à 06 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
			//Regra de 07 à 12 e 31 à 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 19 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'S' .And. AllTrim(&_cZconsum ) = ''  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '692'
			EndIf
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper75         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 75                                                    |
	|          |   75 - remessa sem movimentar estoque                                    |
	|=====================================================================================|
	|Sintaxe   | NCOper75                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper75()
	*-----------------------------*

	//Regra de 1 à 2
	_cTes     := '687'


	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper13         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 13                                                    |
	|          |   13 - MOSTRUARIO                                                        |
	|=====================================================================================|
	|Sintaxe   | NCOper13                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper13()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 01 à 06 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '545'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '545'
			EndIf
			//Regra de 07 à 12 e 31 à 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '545'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '545'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			EndIf
			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '571'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '586'
			EndIf
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper18         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 18                                                    |
	|          |   18 - FEIRA/EXPOSICOES                                                  |
	|=====================================================================================|
	|Sintaxe   | NCOper18                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper18()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 01 à 06 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
			//Regra de 07 à 12 e 31 à 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '541'
			EndIf
		EndIf

	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper19         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 19                                                    |
	|          |   19 - BONIFICACAO                                                       |
	|=====================================================================================|
	|Sintaxe   | NCOper19                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper19()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Se Existir na tabela "SF7"
		...............: 2 - Grupo de Tributação			Exemplo 046
		...............: 3 - Grupo do Cliente					Exemplo 001
		...............: 4 - Para dentro do Estado SP	Exmplo  SP
		...............: 5 - Tipo do Cliente 					Exemplo R	
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
		Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
		Data...........: 22/03/2022
		Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
		*************************************************************/				
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0

				//Regra de 1 à 6 e 25 à 30
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 01 / 25
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '932'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 04 / 28
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						//_cTes     := '932'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
															//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 521 ITEM DA PLANILHA 05
						_cTes     := '569'         // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
					EndIf

					//Regra de 7 à 12 e 31 a 36
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
					EndIf
				EndIf
			/***********************************
			MARGEM IGUAL A ZERO
			***********************************/
			ELSE
				//Regra de 1 à 6 e 25 à 30
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
					EndIf

					//Regra de 7 à 12 e 31 a 36
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						//_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
						_cTes     := '569'         // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
					EndIf
				EndIf
			ENDIF
		/****************************
		NÃO ACHOU GRUPO DE TRIBUTAÇÃO
		****************************/
		ELSE
				//Regra de 1 à 6 e 25 à 30
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						//_cTes     := '598'
						_cTes     := '569'         // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
					EndIf

					//Regra de 7 à 12 e 31 a 36
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '521'//Alterada a TES de 521 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 521 em 20/05/2013 solicitado por André Almeida
					EndIf
				EndIf
		ENDIF


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Se Existir na tabela "SF7"
		...............: 2 - Grupo de Tributação			Exemplo 046
		...............: 3 - Grupo do Cliente					Exemplo 001
		...............: 4 - Para dentro do Estado SP	Exmplo  SP
		...............: 5 - Tipo do Cliente 					Exemplo R	
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
		Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
		Data...........: 22/03/2022
		Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
		*************************************************************/				
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0

				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 13 / 37
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '932'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 16 / 40
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '932'  //// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 520 ITEM DA PLANILHA 41
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '520'
					EndIf
					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '520'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '520'
					EndIf
				EndIf
			/*******************************
			MARGEM IGUAL A ZERO
			*******************************/
			ELSE
				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '520'
					EndIf
					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '520'
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 13 à 18 e 37 à 42
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '598'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '598'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '598'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '598'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '520'
				EndIf
				//Regra de 19 à 24 e 43 à 48
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '520'
				EndIf
				EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'
		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Se Existir na tabela "SF7"
		...............: 2 - Grupo de Tributação			Exemplo 046
		...............: 3 - Grupo do Cliente					Exemplo 001
		...............: 4 - Para dentro do Estado SP	Exmplo  SP
		...............: 5 - Tipo do Cliente 					Exemplo R	
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
		Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
		Data...........: 22/03/2022
		Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
		*************************************************************/				
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0

				//Regra de 49 à 54
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 49
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '932'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 569 ITEM DA PLANILHA 52
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '932'	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 520 ITEM DA PLANILHA 53
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '520'
					EndIf

					//Regra de 55 à 60
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '569'	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 520 ITEM DA PLANILHA 59
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '520'
					EndIf
				EndIf
			/*******************************
			MARGEM IGUAL A ZERO
			*******************************/
			ELSE
				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '520'
					EndIf
					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '569'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '520'
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 13 à 18 e 37 à 42
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '598'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '598'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '598'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '598'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '520'
				EndIf
				//Regra de 19 à 24 e 43 à 48
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '569'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '520'
				EndIf
				EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Se Existir na tabela "SF7"
		...............: 2 - Grupo de Tributação			Exemplo 046
		...............: 3 - Grupo do Cliente					Exemplo 001
		...............: 4 - Para dentro do Estado SP	Exmplo  SP
		...............: 5 - Tipo do Cliente 					Exemplo R	
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
		Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
		Data...........: 22/03/2022
		Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
		*************************************************************/				
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0

				//Regra de 61 à 66
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 598 ITEM DA PLANILHA 61
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '932' //// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 598 ITEM DA PLANILHA 62
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 598 ITEM DA PLANILHA 64
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '932' //// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 570 ITEM DA PLANILHA 65
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '570'
					EndIf

					//Regra de 67 à 72
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '598' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 570 ITEM DA PLANILHA 71
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '570'
					EndIf
				EndIf
			/******************************
			MARGEM IGUAL A ZERO
			******************************/
			ELSE
				//Regra de 61 à 66
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '569'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 598 ITEM DA PLANILHA 64
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						//_cTes     := '598' //// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 570 ITEM DA PLANILHA 65
						_cTes     := '569'       // Valdemir Rabelo 11/05/2022
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						//_cTes     := '570'
						_cTes     := '521'         // Valdemir Rabelo 11/05/2022
					EndIf

					//Regra de 67 à 72
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '598'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '598' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 570 ITEM DA PLANILHA 71
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '570'
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 61 à 66
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					//_cTes     := '598'
					_cTes     := '569'                 // Valdemir Rabelo 11/05/2022
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					//_cTes     := '598'
					_cTes     := '569'         // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					//_cTes     := '598'
					_cTes     := '520'         // Valdemir Rabelo 11/05/2022
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					//_cTes     := '598'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 598 ITEM DA PLANILHA 64
					_cTes     := '569'        // Valdemir Rabelo 11/05/2022
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					//_cTes     := '598' //// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 570 ITEM DA PLANILHA 65
					_cTes     := '569'         // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					//_cTes     := '570'
					_cTes     := '521'         // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
				EndIf

			//Regra de 67 à 72
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					//_cTes     := '598'
					_cTes     := '569'				  // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					//_cTes     := '598'
					_cTes     := '569'				  // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					//_cTes     := '598'
					_cTes := '520'                  // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					//_cTes     := '598'
					_cTes     := '569'              // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					//_cTes     := '598' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 570 ITEM DA PLANILHA 71
					_cTes     := '569'              // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					//_cTes     := '570'
					_cTes     := '521'               // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
				EndIf

			EndIf
		ENDIF

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper20         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 20                                                    |
	|          |   20 - AMOSTRA GRATIS                                                    |
	|=====================================================================================|
	|Sintaxe   | NCOper20                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper20()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 01 / 25
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 04 / 28
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '650'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '650'
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '650'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '650'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 13 / 37
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 16 / 40
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 49
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 582 ITEM DA PLANILHA 52
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '582'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '523'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 688 ITEM DA PLANILHA 61
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '932'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 688 ITEM DA PLANILHA 64
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '573'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '573'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '688'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '573'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '573'
			EndIf
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper29         | Autor | GIOVANI.ZAGO             | Data | 03/08/2017  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 29                                                    |
	|          |   29 - BONIFICACAO                                                       |
	|=====================================================================================|
	|Sintaxe   | NCOper29                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper29()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 01 / 25
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '937'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 04 / 28 
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '937'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '878'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
					EndIf
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '879'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '878'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
					EndIf
				EndIf
			Else
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 01 / 25
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 04 / 28 
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '879'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '878'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
					EndIf
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '879'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '878'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
					EndIf
				EndIf
			EndIf
		Else
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 01 / 25
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 04 / 28 
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '879'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '878'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
				EndIf
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '879'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '878'//Alterada a TES de 878 para 691 em 15/05/2013 solicitado por André Almeida //Alterada a TES de 691 para 878 em 20/05/2013 solicitado por André Almeida
				EndIf
			EndIf
		EndIf
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 13 / 37
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '937'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 16 / 40
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '937'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '878'
					EndIf
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '878'
					EndIf
				EndIf
			Else
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 13 / 37
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 16 / 40
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '878'
					EndIf
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					EndIf
				EndIf
			EndIf
		Else
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 13 / 37
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 16 / 40
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '878'
				EndIf
			ElseIf   _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 13 / 37
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 16 / 40
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '878'
				EndIf
			EndIf
		EndIf
	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 13 / 37
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 16 / 40
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					EndIf
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					EndIf
				EndIf
			Else
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 13 / 37
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 16 / 40
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					EndIf
					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					EndIf
				EndIf
			EndIf
		Else
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 13 / 37
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 16 / 40
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '877'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '877'
				EndIf
			EndIf
		EndIf
	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 881 ITEM DA PLANILHA 61
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '937'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '843'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '937' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 64
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '937'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '841'
					EndIf
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '843'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '843'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '841'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '843'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '843'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '841'
					EndIf
				EndIf
			Else
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 881 ITEM DA PLANILHA 61
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '877'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 64
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '877'
					EndIf
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '878'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '879'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '878'
					EndIf
				EndIf
			EndIf
		Else
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 881 ITEM DA PLANILHA 61
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '878'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '879' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 879 ITEM DA PLANILHA 64
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '877'
				EndIf
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '879'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '878'
				EndIf
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper23         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 23                                                    |
	|          |   23 - REMESSA DE BRINDES C/ICMS
	|=====================================================================================|
	|Sintaxe   | NCOper23                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper23()
	*-----------------------------*

	//Regra de 1 à 6
	If  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '715'
			Endif
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '715'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '715'
			Endif
		Endif
	Endif

	Return (_cTes)

Static Function NCOper24()

	If  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst = &_cCliEst .And. SB1->B1_IPI = 0
		_cTes     := '915'
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst = &_cCliEst .And. SB1->B1_IPI<>0 .And. AllTrim(SB1->B1_CLAPROD)=="C"
		_cTes     := '915'
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst = &_cCliEst .And. SB1->B1_IPI<>0 .And. AllTrim(SB1->B1_CLAPROD)$"F#I"
		_cTes     := '914'
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst <> &_cCliEst .And. SB1->B1_IPI = 0
		_cTes     := '915'
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst <> &_cCliEst .And. SB1->B1_IPI <> 0 .And. AllTrim(SB1->B1_CLAPROD)=="C"
		_cTes     := '915'
	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '1' .And. _cEst <> &_cCliEst .And. SB1->B1_IPI <> 0 .And. AllTrim(SB1->B1_CLAPROD)$"F#I"
		_cTes     := '914'
	Endif

	Return (_cTes)

	/*====================================================================================\
	|Programa  | NCOper25         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 25                                                    |
	|          |   25 - VENDA DE SUCATA (NÃO ATUA.ESTOQUE)                                |
	|=====================================================================================|
	|Sintaxe   | NCOper25                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper25()
	*-----------------------------*

	//Regra de 1 à 3
	If  &_cTipoCli = 'F' .And. &_cZconsum = '2'
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '686'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '686'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '686'
			Endif
		Endif
	Endif


	Return (_cTes)

	/*====================================================================================\
	|Programa  | NCOper26         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 26                                                    |
	|          |   26 - REMESSA DE BRINDES S/ICMS                                         |
	|=====================================================================================|
	|Sintaxe   | NCOper26                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper26()
	*-----------------------------*

	//Regra de 1 à 6
	If  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '714'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '714'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '714'
			Endif
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '714'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '714'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '714'
			Endif
		Endif
	Endif

	Return (_cTes)




	/*====================================================================================\
	|Programa  |          | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 38                                                    |
	|          |   38 - VENDA A ORDEM                                                     |
	|=====================================================================================|
	|Sintaxe   | NCOper38                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper38()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '930' 	//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 01 / 25
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '930' //Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
													 //// Alterado por Marcelo Klopfer - 07/02/2022 - TES ANTERIOR 733 ITEM DA PLANILHA 26	
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731' //Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '930' //Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 04 / 28
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '930' 	//Alterada a TES de 612 para 732 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 07/02/2022 - TES ANTERIOR 732 ITEM DA PLANILHA 29
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '734' //Alterada a TES de 637 para 734 em 08/05/2013 solicitado por Verônica Brandão
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '731' //Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '733' //Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731' //Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '731' //Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '732' //Alterada a TES de 612 para 732 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '734' //Alterada a TES de 637 para 734 em 08/05/2013 solicitado por Verônica Brandão
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '930'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
													//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 13 / 37
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '930'//Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
													//// Alterado por Marcelo Klopfer - 07/02/2022 - TES ANTERIOR 732 ITEM DA PLANILHA 14
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '930'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 16 / 40
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '735'//Alterada a TES de 655 para 735 em 08/05/2013 solicitado por Verônica Brandão
				                  //// Alterado por Marcelo Klopfer - 07/02/2022 - TES ANTERIOR 735 
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '736'//Alterada a TES de 656 para 736 em 08/05/2013 solicitado por Verônica Brandão
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '733'//Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '735'//Alterada a TES de 655 para 735 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '736'//Alterada a TES de 656 para 736 em 08/05/2013 solicitado por Verônica Brandão
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '930'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 49
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '930'//Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
													//// Alterado por Marcelo Klopfer - 07/02/2022 - TES ANTERIOR 733
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '930'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
														//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 731 ITEM DA PLANILHA 52
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '930' //Alterada a TES de 612 para 732 em 08/05/2013 solicitado por Verônica Brandão
													 //// Alterado por Marcelo Klopfer - 07/02/2022 - TES ANTERIOR 732
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '734'//Alterada a TES de 637 para 734 em 08/05/2013 solicitado por Verônica Brandão
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '733'//Alterada a TES de 633 para 733 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '731'//Alterada a TES de 611 para 731 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '732'//Alterada a TES de 612 para 732 em 08/05/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '734'//Alterada a TES de 637 para 734 em 08/05/2013 solicitado por Verônica Brandão
			EndIf
		EndIf

	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper40         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 40                                                    |
	|          |   40 - ENT.FUTURA-VENDA                                                  |
	|=====================================================================================|
	|Sintaxe   | NCOper40                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper40()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

	//Com Grupo de Trib.
	SF7->(DbSetOrder(4))
	IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf
		EndIf

	Else
		
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '538'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '590'
			EndIf
		EndIf
	Endif

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Com Grupo de Trib.
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '590'
					EndIf
					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0 
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '590'
					EndIf
				EndIf
		Else
				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '590'
					EndIf
					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '590'
					EndIf
				EndIf
		Endif
	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2' //Não contribuinte

		//Com Grupo de Trib.
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
				//Regra de 49 à 54
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '590'
					EndIf

					//Regra de 55 à 60
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '590'
					EndIf
				EndIf
		Else
				//Regra de 49 à 54
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '590'
					EndIf

					//Regra de 55 à 60
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0 
						_cTes     := '538'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '590'
					EndIf
				EndIf
		EndIf

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Com Grupo de Trib.
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			//Regra de 61 à 66
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '590'
				EndIf

				//Regra de 67 à 72
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '590'
				EndIf
			EndIf

		Else

			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '590'
				EndIf

				//Regra de 67 à 72
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '538'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '590'
				EndIf
			EndIf
		Endif
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper41         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 41                                                    |
	|          |   41 - ENT.FUTURA-VENDA                                                  |
	|=====================================================================================|
	|Sintaxe   | NCOper41                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper41()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Com Grupo de Trib.
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))

			//Regra de 1 à 6 e 25 à 30
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '587'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '587'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				EndIf

				//Regra de 7 à 12 e 31 a 36
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				EndIf
			EndIf
		Else
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '587'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '587'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				EndIf

				//Regra de 7 à 12 e 31 a 36
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				EndIf
			EndIf

		Endif


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Com Grupo de Trib.
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			//Regra de 13 à 18 e 37 à 42
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				EndIf
				//Regra de 19 à 24 e 43 à 48
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				EndIf
			EndIf
		Else
			If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					EndIf
					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					EndIf
				EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//Com Grupo de Trib.
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
				//Regra de 49 à 54
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					EndIf

					//Regra de 55 à 60
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					EndIf
				EndIf
		Else
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					EndIf

					//Regra de 55 à 60
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '515'
					EndIf
				EndIf
		Endif
	

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))


		//Com Grupo de Trib.
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			//Regra de 61 à 66
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '941'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '941'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '941'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '941'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				EndIf

				//Regra de 67 à 72
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				EndIf
			EndIf

		Else
			
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				EndIf

				//Regra de 67 à 72
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '515'
				EndIf
			EndIf

		Endif
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper60         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 60                                                    |
	|          |   60 - DEV. MAT.PRIMA -  C/ IPI E ICMS                                   |
	|=====================================================================================|
	|Sintaxe   | NCOper60                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper60()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '539'
			EndIf
		Endif
	Endif

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper61         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 61                                                    |
	|          |   61 - DEV. MAT.PRIMA C/ICMS                                             |
	|=====================================================================================|
	|Sintaxe   | NCOper61                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper61()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '606'
			EndIf
		Endif
	Endif

	Return (_cTes)

	/*====================================================================================\
	|Programa  | NCOper62         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 62                                                    |
	|          |   62 - DEV. MAT.PRIMA S/ICMS                                             |
	|=====================================================================================|
	|Sintaxe   | NCOper62                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper62()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '614'
			EndIf
		Endif
	Endif

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper63         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 63                                                    |
	|          |   63 - DEV. MAT.PRIMA S/ICMS                                             |
	|=====================================================================================|
	|Sintaxe   | NCOper63                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper63()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '516'
			EndIf
		Endif
	Endif

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper64         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 64                                                    |
	|          |   64 - DEVOL.USO CONS C/ICMS                                             |
	|=====================================================================================|
	|Sintaxe   | NCOper64                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper64()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '517'
			EndIf
		Endif
	Endif

	Return (_cTes)

	/*====================================================================================\
	|Programa  | NCOper65         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 65                                                    |
	|          |   65 - DEVOL.USO CONS C/ICMS                                             |
	|=====================================================================================|
	|Sintaxe   | NCOper65                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper65()
	*-----------------------------*

	//Regra de 1 à 12
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			EndIf
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '617'
			EndIf
		Endif
	Endif

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper39         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 39                                                    |
	|          |   39 - REM POR CONTA E ORDEM -CFOP 5923/6923                             |
	|=====================================================================================|
	|Sintaxe   | NCOper39                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/

	*-----------------------------*
Static Function NCOper39()
	*-----------------------------*

	//Das regras de 01 à 24 -> Alterada a TES de 622 para 737 em 08/05/2013 solicitado por Verônica Brandão
	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//REGRA DE 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif

			//REGRA DE 4 à 6
		Elseif _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif
		Endif

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//REGRA DE 7 à 9
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif
			//REGRA DE 10 à 12
		Elseif _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif
		Endif

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		//REGRA DE 13 à 15
		If  _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif

			//REGRA DE 15 à 18
		Elseif _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif
		Endif

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//REGRA DE 19 à 21
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif

			//REGRA DE 22 à 24
		Elseif _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'F'
				_cTes     := '737'
			Elseif SB1->B1_CLAPROD = 'I'
				_cTes     := '737'
			Endif
		Endif

	Endif

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper85         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 85                                                    |
	|          |   85 - VENDA SP/MA -> STECK AM                                           |
	|=====================================================================================|
	|Sintaxe   | NCOper85                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/

	*-----------------------------*
Static Function NCOper85()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. !(Empty(ALLTRIM( &_cCliSufra)))

		//Regra de 1 à 6
		If alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '509'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '508'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '509'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '508'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
			EndIf

			//Regra de 13 à 18
		ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '685'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '610'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '685'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '827' //Alterado por João Victor em 31/01/2014 de 609 para 827 conforme chamado 000139
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. !(Empty(ALLTRIM( &_cCliSufra)))

		//Regra de 7 a 12
		If  alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '508'// Chamado 005549 - Robson Mazzarotto
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '508' // Chamado 005549 - Robson Mazzarotto
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '828'//Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
			EndIf
			//Regra de 19 à 24
		ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '508'// Chamado 005549 - Robson Mazzarotto
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '621'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '508' // Chamado 005549 - Robson Mazzarotto
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '828' //Alterado por João Victor em 31/01/2014 de 719 para 828 conforme chamado 000139
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2' .And. !(Empty(ALLTRIM( &_cCliSufra)))

		//Regra de 25 à 30
		If  alltrim(&_cCliMun) $ ('03569/02603/03536') .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '680'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '677'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '829' //Alterado por João Victor em 31/01/2014 de 678 para 829 conforme chamado 000139
			EndIf

			//Regra de 31 à 36
		ElseIf !(alltrim(&_cCliMun) $ ('03569/02603/03536')) .And. &_cCliEst = 'AM'
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '680'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '679'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '677'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '829'//Alterado por João Victor em 31/01/2014 de 678 para 829 conforme chamado 000139
			EndIf
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper35         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 35                                                    |
	|          |   35 - DEV.REM.P/TROCA                                                   |
	|=====================================================================================|
	|Sintaxe   | NCOper35                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper35()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
			//Com Grupo de Tributação
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))

			If   _cEst = &_cCliEst //Verificado
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 01 / 25
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '936'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 01 / 28
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '936'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '547'
				EndIf

				//Regra de 7 à 12 e 31 a 36
			ElseIf _cEst <> &_cCliEst //Verificado

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '547'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '547'
				EndIf
			EndIf

		Else
			//Sem Grupo de Tributação -- Verifcado
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 01 / 25
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 01 / 28
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '547'
				EndIf

				//Regra de 7 à 12 e 31 a 36
			ElseIf _cEst <> &_cCliEst //Verificado

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '547'
				EndIf
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))

			If   _cEst = &_cCliEst //Verificado
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 13 / 37
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '936'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 16 / 40
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '936'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '713'
				EndIf

			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 13 / 37
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 16 / 40
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '713'
				EndIf
			EndIf

		Else

			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 13 / 37
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 16 / 40
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '713'
				EndIf
				//Regra de 19 à 24 e 43 à 48
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '713'
				EndIf
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))

			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 13 / 37
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '936'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 16 / 40
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '936'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '713'
				EndIf
				//Regra de 19 à 24 e 43 à 48
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '713'
				EndIf
			EndIf

		Else

			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 13 / 37
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '936'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 552 ITEM DA PLANILHA 16 / 40
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '936'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '713'
				EndIf
				//Regra de 19 à 24 e 43 à 48
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '713'
				EndIf
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		If lRICMSST
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '936' //'779'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '936' //'779'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781' //'779'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '936' //'779'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '936' //'779'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '547' //'547'
			EndIf
			Return _cTes
		End If

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))

			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '936' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 602 ITEM DA PLANILHA 49
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '936'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '602'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '936'  	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 602 ITEM DA PLANILHA 52
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '936'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '594'
				EndIf

			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '602'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '602'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '713' 
				EndIf
			EndIf

		Else

			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 602 ITEM DA PLANILHA 49
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '602'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552'  	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 602 ITEM DA PLANILHA 52
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '547'
				EndIf

				//Regra de 55 à 60
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '552'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '713'
				EndIf
			EndIf
		EndIf

	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper34         | Autor | GIOVANI.ZAGO             | Data | 17/04/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 34                                                    |
	|          |   34 - REM.P/TROCA                                                    |
	|=====================================================================================|
	|Sintaxe   | NCOper34                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper34()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '779'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '779'
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '779'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '779'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. &_cCliContrib = '2'

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '781'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '780'
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '631'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '631'
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '630'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '631'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '631'
			EndIf
		EndIf

	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper21         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 21                                                    |
	|          |   21 - REM.P/TROCAMAT.PROPAGANDA                                         |
	|=====================================================================================|
	|Sintaxe   | NCOper21                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper21()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6 e 25 à 30
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf

			//Regra de 7 à 12 e 31 a 36
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 13 à 18 e 37 à 42
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf
			//Regra de 19 à 24 e 43 à 48
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf
		EndIf

	ElseIf  &_cTipoCli = 'F' .And. &_cCliContrib = '2' .And. Alltrim(&_cZconsum) = ''

		//Regra de 61 à 66
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf

			//Regra de 67 à 72
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf
		EndIf


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '' .And. &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 49 à 54
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf

			//Regra de 55 à 60
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '696'//Alterada a TES de 546 para 696 em 11/06/2013 solicitado por Verônica Brandão
			EndIf
		EndIf

	EndIf

	Return (_cTes)

	/*====================================================================================\
	|Programa  | NCOper22         | Autor | GIOVANI.ZAGO            | Data | 31/01/2017  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 22                                                    |
	|          |   22 - INDUSTRIALIZAÇÃO PARA OUTRA EMPRESA				                  |
	|=====================================================================================|
	|Sintaxe   | NCOper22                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper22()
	*-----------------------------*



	If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
		_cTes     := '866'
	ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
		_cTes     := '866'
	ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
		_cTes     := '866'
	ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
		_cTes     := '866'
	ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
		_cTes     := '865'
	ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
		_cTes     := '865'
	EndIf


	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper79         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 79                                                    |
	|          |   79 - DEVOL.USO CONS C/ IPI E ICMS (NÃO ATUA.ESTOQUE)                   |
	|=====================================================================================|
	|Sintaxe   | NCOper79                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper79()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '782'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper80         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 80                                                    |
	|          |   80 - DEVOL.USO CONS C/ICMS (NÃO ATUA.ESTOQUE)                          |
	|=====================================================================================|
	|Sintaxe   | NCOper80                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper80()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '783'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper81         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 81                                                    |
	|          |   81 - DEVOL.USO CONS S/ICMS (NÃO ATUA.ESTOQUE)                          |
	|=====================================================================================|
	|Sintaxe   | NCOper81                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper81()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '784'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper57         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 57                                                    |
	|          |   57 - DEVOL ATIVO  C/ IPI E ICMS                                        |
	|=====================================================================================|
	|Sintaxe   | NCOper57                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper57()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '785'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper58         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 58                                                    |
	|          |   58 - DEVOL ATIVO  C/ ICMS                                              |
	|=====================================================================================|
	|Sintaxe   | NCOper58                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper58()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '672'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper59         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 59                                                    |
	|          |   59 - DEVOL ATIVO  S/ ICMS                                              |
	|=====================================================================================|
	|Sintaxe   | NCOper59                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper59()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '607'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper83         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 83                                                    |
	|          |   83 - DEVOL ATIVO  C/ IPI E ICMS (NÃO ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | NCOper83                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper83()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '786'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper84         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 84                                                    |
	|          |   84 - DEVOL ATIVO  C/ IPI E ICMS (NÃO ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | NCOper84                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper84()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '725'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper82         | Autor | JOAO.RINALDI             | Data | 15/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 82                                                    |
	|          |   82 - DEVOL ATIVO  S/ ICMS (NÃO ATUA.ESTOQUE)                           |
	|=====================================================================================|
	|Sintaxe   | NCOper82                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper82()
	*-----------------------------*


	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst

			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '698'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper09         | Autor | JOAO.RINALDI             | Data | 29/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 09                                                    |
	|          |   09 - COMPLEMENTO DE PRECO                                              |
	|=====================================================================================|
	|Sintaxe   | NCOper09                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper09()
	*-----------------------------*

	If  &_cTipoCli = 'R' /*.And. &_cZconsum = '1'  .And. &_cCliContrib = '1'*/ .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '742'
				EndIf
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '742'
				EndIf
			EndIf
		ELSE
			If _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '742'
				EndIf
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '742'
				EndIf
			EndIf
		ENDIF
	ElseIf  &_cTipoCli = 'F' /*.And. &_cZconsum = '2'  .And. &_cCliContrib = '1'*/ .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '754'
				EndIf
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '754'
				EndIf
			EndIf
		ELSE
			If _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '754'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '754'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '752'
				EndIf
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '754'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '750'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '752'
				EndIf
			EndIf
		ENDIF
	ElseIf  &_cTipoCli = 'S' /*.And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'*/  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
							_cTes     := '942'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
							_cTes     := '942'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
							_cTes     := '942'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
							_cTes     := '942'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
							_cTes     := '746'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
							_cTes     := '748'
					EndIf
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
							_cTes     := '746'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
							_cTes     := '746'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
							_cTes     := '751'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
							_cTes     := '746'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
							_cTes     := '746'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
							_cTes     := '748'
					EndIf
				EndIf
		ELSE
				If _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
							_cTes     := '750'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
							_cTes     := '750'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
							_cTes     := '750'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
							_cTes     := '750'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
							_cTes     := '750'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
							_cTes     := '742'
					EndIf
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
							_cTes     := '750'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
							_cTes     := '750'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
							_cTes     := '750'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
							_cTes     := '750'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
							_cTes     := '901'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
							_cTes     := '898'
					EndIf
				EndIf
		ENDIF
	EndIf
Return  (_cTes)


	/*====================================================================================\
	|Programa  | NCOper71         | Autor | JOAO.RINALDI             | Data | 11/06/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 71                                                    |
	|          |   71 - VENDAS - FAB.MAT.INF. (RE ICMS)                                   |
	|=====================================================================================|
	|Sintaxe   | NCOper71                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper71()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '788'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '788'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '788'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '705'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '787'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper96         | Autor | JOAO.RINALDI             | Data | 11/06/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 96                                                    |
	|          |   96 - TRANSF. ENTRE FILIAIS (NÃO ATUA.ESTOQUE)                          |
	|=====================================================================================|
	|Sintaxe   | NCOper96                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper96()
	*-----------------------------*

	// regra de 01 à 03
	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (_cEst = &_cCliEst) .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		If SB1->B1_CLAPROD = 'C'
			_cTes     := '790'
		ElseIf SB1->B1_CLAPROD = 'F'
			_cTes     := '789'
		ElseIf SB1->B1_CLAPROD = 'I'
			_cTes     := '790'
		Endif
	Endif

	Return  (_cTes)




	/*====================================================================================\
	|Programa  | NCOper97         | Autor | JOAO.RINALDI             | Data | 18/06/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 97                                                    |
	|          |   97 - VENDA COPA                                                        |
	|=====================================================================================|
	|Sintaxe   | NCOper97                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper97()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '2'
		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			EndIf
			//Regra de 7 à 12
		Elseif  _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '809'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '808'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '809'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '809'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '808'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '809'
			EndIf
		Endif
	Elseif &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')
		//Regra de 13 à 18
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			EndIf
			//Regra de 19 à 24
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			EndIf
		EndIf
	ElseIf &_cTipoCli == 'R' .And. &_cCliContrib == '1' .And. (!Empty(Alltrim(&_cCliInscr)) .Or. 'ISENT' $ Upper(Alltrim(&_cCliInscr)))	// Ticket 20210604009371 - TES INTELIGENTE - Eduardo Pereira - Inicio
		//Regra de 13 à 18
		If   _cEst == &_cCliEst
			If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			EndIf
			//Regra de 19 à 24
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '806'
			ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '807'
			EndIf
		EndIf
		// Ticket 20210604009371 - TES INTELIGENTE - Eduardo Pereira - Fim
	Endif

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper14         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 14                                                    |
	|          |   14 - REMESSA PARA TESTE                                                |
	|=====================================================================================|
	|Sintaxe   | NCOper14                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper14()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '596'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '596'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '644'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '596'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '596'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper15         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 15                                                    |
	|          |   15 - RETORNO TESTE                                                     |
	|=====================================================================================|
	|Sintaxe   | NCOper15                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper15()
	*-----------------------------*

//	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('D') //ticket 20200803005044
		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '797'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '797'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '798'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '797'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '797'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper17         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 17                                                    |
	|          |   17 - REM P/VASILHAME                                                   |
	|=====================================================================================|
	|Sintaxe   | NCOper17                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper17()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '694'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper27         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 27                                                    |
	|          |   27 - RETORNO VASILHAME                                                 |
	|=====================================================================================|
	|Sintaxe   | NCOper27                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper27()
	*-----------------------------*

//	If  &_cTipoCli = 'F' .OR.&_cTipoCli = 'D' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

	If  &_cTipoCli = 'F' .OR.&_cTipoCli = 'D' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('D')// 20200803005044
		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '697'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper42         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 42                                                    |
	|          |   42 - TRANSFERENCIA DE SALDO C/D                                        |
	|=====================================================================================|
	|Sintaxe   | NCOper42                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper42()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '711'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '711'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '711'
			EndIf

			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '711'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '711'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '711'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper45         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 45                                                    |
	|          |   45 - TRANSFERENCIA DE ATIVO                                            |
	|=====================================================================================|
	|Sintaxe   | NCOper45                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper45()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '723'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '723'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '723'
			EndIf

			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '723'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '723'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '723'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper48         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 48                                                    |
	|          |   48 - TRANSF USO E CONSUMO                                              |
	|=====================================================================================|
	|Sintaxe   | NCOper48                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper48()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '693'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '693'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '693'
			EndIf

			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '693'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '693'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '693'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper49         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 49                                                    |
	|          |   49 - RETORNO LOCAÇÃO                                                   |
	|=====================================================================================|
	|Sintaxe   | NCOper49                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper49()
	*-----------------------------*

	//If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')
	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('D') //20200803005044
		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '649'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper51         | Autor | GIOVANI.ZAGO             | Data | 07/06/2017  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 51                                                    |
	|          |   51 - REMESSA PARA DESCARTE					                          |
	|=====================================================================================|
	|Sintaxe   | NCOper51                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper51()
	*-----------------------------*

	_cTes     := '867'


	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper52         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 52                                                    |
	|          |   52 - REM.ATIVO IMOB.USO FORA DO ESTABECIMENTO                          |
	|=====================================================================================|
	|Sintaxe   | NCOper52                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper52()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. &_cZconsum = '2' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '699'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '699'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '699'
			EndIf

			//Regra de 4 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C'
				_cTes     := '699'
			ElseIf SB1->B1_CLAPROD = 'F'
				_cTes     := '699'
			ElseIf SB1->B1_CLAPROD = 'I'
				_cTes     := '699'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper53         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 53                                                    |
	|          |   53 - RET.DEMONSTRAÇÃO C/IPI E ICMS                                     |
	|=====================================================================================|
	|Sintaxe   | NCOper53                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper53()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '553'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper54         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 54                                                    |
	|          |   54 - RET.DEMONSTRAÇÃO C/ICMS                                           |
	|=====================================================================================|
	|Sintaxe   | NCOper54                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper54()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '554'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper55         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 55                                                    |
	|          |   55 - RET.DEMONSTRAÇÃO S/IPI E ICMS                                     |
	|=====================================================================================|
	|Sintaxe   | NCOper55                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper55()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '583'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper70         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 70                                                    |
	|          |   70 - RETORNO COMODATO                                                  |
	|=====================================================================================|
	|Sintaxe   | NCOper70                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper70()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '727'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper72         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 72                                                    |
	|          |   72 - SINISTRO                                                          |
	|=====================================================================================|
	|Sintaxe   | NCOper72                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper72()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '805'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper77         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 77                                                    |
	|          |   77 - VENDA - FABR. MAT. P/ VEICULOS                                    |
	|=====================================================================================|
	|Sintaxe   | NCOper77                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper77()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N') .And. &_cAtividade = '000024'

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '791'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '791'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '506'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '791'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '558'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '791'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '506'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper87         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 87                                                    |
	|          |   87 - RET INDL                                                          |
	|=====================================================================================|
	|Sintaxe   | NCOper87                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper87()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('D')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '700'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper98         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 98                                                    |
	|          |   98 - VENDA - MATL USO E CONSUMO                                        |
	|=====================================================================================|
	|Sintaxe   | NCOper98                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper98()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '613'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper99         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 99                                                    |
	|          |   99 - VENDA - MATL USO E CONSUMO (NÃO ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | NCOper99                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper99()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '810'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper07         | Autor | JOAO.RINALDI             | Data | 28/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 07                                                    |
	|          |   07 - VENDAS RED B.CALCULO ICMS                                         |
	|=====================================================================================|
	|Sintaxe   | NCOper07                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper07()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '815'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '816'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '818'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '815'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '817'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '816'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '818'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper03         | Autor | Jefferson.carlos         | Data | 09/04/2018  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 03                                                    |
	|          |   03 - RET.DEMONSTRAÇÃO C/IPI E ICMS ( ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | NCOper03                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO    Chamado 007038                                                     |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper03()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('B')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '885'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper05         | Autor | JOAO.RINALDI             | Data | 24/01/2014  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 05                                                    |
	|          |   05 - VENDA - DRAWBACK                                                  |
	|=====================================================================================|
	|Sintaxe   | NCOper05                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper05()
	*-----------------------------*
	//giovani zago alterei zconsumo para 2 veronica solicitou 28/01/14
	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '825'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '825'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '824'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '825'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '824'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '825'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '824'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper90         | Autor | João Victor              | Data | 12/11/2014  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 90                                                    |
	|          |   90 - VENDA - REPENEC                                                   |
	|          |   Chamado 001107                                                         |
	|=====================================================================================|
	|Sintaxe   | NCOper90                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper90()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv $ ('N')

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '838'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '838'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '837'
			EndIf

			//Regra de 7 à 12
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '838'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '837'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '838'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '837'
			EndIf
		EndIf
	EndIf

	Return (_cTes)



	/*====================================================================================\
	|Programa  | NCOper91         | Autor | João Victor              | Data | 12/02/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 91                                                    |
	|          |   91 - ANULAÇÃO DE VALORES REF AQUISIÇÃO DE SERVIÇO DE TRANSPORTE        |
	|          |   Chamado 001496                                                         |
	|=====================================================================================|
	|Sintaxe   | NCOper91                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper91()
	*-----------------------------*
	_cTes     := '842'
	Return (_cTes)

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 3
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			EndIf

			//Regra de 3 à 6
		ElseIf _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '842'
			EndIf
		EndIf
	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper93         | Autor | João Victor              | Data | 27/05/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 93                                                    |
	|          |   93 - INDUSTRIALIZAÇÃO PARA OUTRA EMPRESA                               |
	|          |   Chamado 001996                                                         |
	|=====================================================================================|
	|Sintaxe   | NCOper93                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper93()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//			IF SF7->F7_MARGEM > 0
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '631'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '511'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '902'
//						Else
							_cTes     := '564'
//						EndIf
					EndIf
				EndIf

			/************************************
			MARGEM IGUAL A ZERO
			************************************/
/*
			ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '898'
						Else
							_cTes     := '898'
						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '901'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '902'
						Else
							_cTes     := '899'
						EndIf
					EndIf
				EndIf
			ENDIF
*/
		ELSE

			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '511'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '511'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '511'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '511'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '511'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '898'
//					Else
						_cTes     := '564'
//					EndIf
				EndIf
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '511'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '511'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '511'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '511'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '901'
//					Else
						_cTes     := '511'
//					EndIf
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//					If Empty(SB1->B1_GRTRIB)
//						_cTes     := '902'
//					Else
						_cTes     := '564'
//					EndIf
				EndIf
			EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//			IF SF7->F7_MARGEM > 0

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '638'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '638'
//						EndIf
					EndIf
				EndIf

			/************************************
			MARGEM IGUAL A ZERO
			************************************/
/*
			ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '899'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '898'
						Else
							_cTes     := '899'
						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					EndIf
				EndIf
			ENDIF
*/
		ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '564'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '564'
//						EndIf
					EndIf
				EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//			IF SF7->F7_MARGEM > 0

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '638'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '638'
//						EndIf
					EndIf
				EndIf

			/************************************
			MARGEM IGUAL A ZERO
			************************************/
/*
			ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '899'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '898'
						Else
							_cTes     := '899'
						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					EndIf
				EndIf
			ENDIF
*/
		ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '564'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '564'
//						EndIf
					EndIf
				EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//			IF SF7->F7_MARGEM > 0

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7__GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '931'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '638'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '597'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SF7->F7_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '638'
//						EndIf
					EndIf
				EndIf

			/************************************
			MARGEM IGUAL A ZERO
			************************************/
/*
			ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '933'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '899'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '898'
						Else
							_cTes     := '899'
						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						If Empty(SF7->F7_GRTRIB)
							_cTes     := '901'
						Else
							_cTes     := '900'
						EndIf
					EndIf
				EndIf
			ENDIF
*/
		ELSE

				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '898'
//						Else
							_cTes     := '564'
//						EndIf
					EndIf

				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '511'
//						EndIf
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
//						If Empty(SB1->B1_GRTRIB)
//							_cTes     := '901'
//						Else
							_cTes     := '564'
//						EndIf
					EndIf
				EndIf
		ENDIF
	EndIf

/*
	//If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
	//	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'   .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) //chamado veronica 23/09/16

	//Regra de 1 à 6
	If   _cEst = &_cCliEst
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '931' //// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 511 ITEM DA PLANILHA 01
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '931' //// Alterado por Marcelo Klopfer - 07/02/2022 - TES ANTERIOR 564
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '511'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '931' //// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 511 ITEM DA PLANILHA 01
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '930' //// Alterado por Marcelo Klopfer - 07/02/2022 - TES ANTERIOR 564
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '638'
		EndIf

		//Regra de 7 à 12
	ElseIf _cEst <> &_cCliEst
		If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
			_cTes     := '511'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
			_cTes     := '564'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
			_cTes     := '511'
		ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
			_cTes     := '511'
		ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
			_cTes     := '564'
		ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
			_cTes     := '638'
		EndIf
	EndIf
	//EndIf
*/

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper47         | Autor | João Victor              | Data | 14/10/2015  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 47                                                    |
	|          |   47 - VENDA TRANSPORTE PUBLICO                                          |
	|          |   Chamado 002843                                                         |
	|=====================================================================================|
	|Sintaxe   | NCOper47                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper47()
	*-----------------------------*

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '850'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '849'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '850'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '850'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '849'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '850'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper86         | Autor | João Victor              | Data | 26/02/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 86                                                    |
	|          |   86 - MUDANÇA DE ENDEREÇO                                               |
	|          |   Chamado 002843                                                         |
	|=====================================================================================|
	|Sintaxe   | NCOper86                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper86()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv == 'N'

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '854'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '854'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '854'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '854'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '854'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '854'
			EndIf
		EndIf
	EndIf

	Return (_cTes)




	/*====================================================================================\
	|Programa  | NCOper76         | Autor | GIOVANI.ZAGO              | Data | 11/04/2016  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE                                                        |
	|          |   Tipo de Operação 76                                                    |
	|          |   76 - MUDANÇA DE ENDEREÇO                                               |
	|          |   Chamado 002843                                                         |
	|=====================================================================================|
	|Sintaxe   | NCOper76                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper76()
	*-----------------------------*

	If  &_cTipoCli = 'F' .And. &_cZconsum = '2' .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) .And. &_cTipopv == 'N'

		//Regra de 1 à 6
		If   _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := '856'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := '856'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := '856'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '856'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '856'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '856'
			EndIf
		EndIf
	EndIf

	Return (_cTes)

/*/{Protheus.doc} NcOper30
Venda por Consignação
@type function
@version 12.1.27
@author Ricardo Munhoz
@since 30/05/2022
@return _cTes, character
/*/
Static Function NcOper30()
	*-----------------------------*
	If  &_cTipoCli = 'S' .And. Empty(&_cZconsum) .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		Do Case
		Case _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '912'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '912'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '911'
			EndIf
		Case _cEst <> &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '912'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '911'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '912'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '911'
			EndIf
		EndCase
		
	EndIf
Return  (_cTes)


	/*====================================================================================\
	|Programa  | NCOper99         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 99                                                    |
	|          |   99 - VENDA - MATL USO E CONSUMO (NÃO ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | NCOper99                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper31()
	*-----------------------------*


	If  &_cTipoCli = 'F'

		If &_cZconsum = '1'
			If (SB1->B1_CLAPROD = 'F' .Or. SB1->B1_CLAPROD = 'I' ).And. SB1->B1_IPI <> 0
				_cTes     := '860'
			Else
				_cTes     := '861'
			EndIf
		Else
			If (SB1->B1_CLAPROD = 'F' .Or. SB1->B1_CLAPROD = 'I' ).And. SB1->B1_IPI <> 0
				_cTes     := '859'
			Else
				_cTes     := '861'
			EndIf

		EndIf




	ElseIf  &_cTipoCli = 'R'

		If &_cZconsum = '1'
			If (SB1->B1_CLAPROD = 'F' .Or. SB1->B1_CLAPROD = 'I' ).And. SB1->B1_IPI <> 0
				_cTes     := '860'
			Else
				_cTes     := '938' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 861 ITEM DA PLANILHA 04 / 16 / 28 / 40 / 52 
			EndIf

		ElseIf &_cZconsum = '2'
			If (SB1->B1_CLAPROD = 'F' .Or. SB1->B1_CLAPROD = 'I' ).And. SB1->B1_IPI <> 0
				_cTes     := '859'
			Else
				_cTes     := '938' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 861 ITEM DA PLANILHA 04 / 16 / 28 / 40 / 52 
			EndIf

		EndIf

	ElseIf  &_cTipoCli = 'S'

		If (SB1->B1_CLAPROD = 'F' .Or. SB1->B1_CLAPROD = 'I' ).And. SB1->B1_IPI <> 0
			_cTes     := '862'
		Else
			_cTes     := '938' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 863 ITEM DA PLANILHA 64
		EndIf

	EndIf

	Return (_cTes)


	/*====================================================================================\
	|Programa  | NCOper99         | Autor | JOAO.RINALDI             | Data | 25/05/2013  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                  |
	|          |   Tipo de Operação 99                                                    |
	|          |   99 - VENDA - MATL USO E CONSUMO (NÃO ATUA.ESTOQUE)                     |
	|=====================================================================================|
	|Sintaxe   | NCOper99                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper33()
	*-----------------------------*

	_cTes     := '846'

	Return (_cTes)

/*====================================================================================\
|Programa  | NCOper10         | Autor | Marcelo Klopfer          | Data | 19/04/2022  |
|=====================================================================================|
|Descrição |   TES INTELIGENTE        		    	                                      |
|          |   Tipo de Operação 10                                                    |
|          |   10 -    REMESSA PARA CONSIGNACAO					                              |
|=====================================================================================|
|Sintaxe   | NCOper10                                                                 |
|=====================================================================================|
|Uso       | Especifico STECK                                                         |
|=====================================================================================|
|........................................Histórico....................................|
\====================================================================================*/

Static Function NCOper10()
	
		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Tipo do Cliente "SOLIDARIO"
		...............: 2 - NÃO abre tela
		...............: 3 - Cliente contribuinte
		*************************************************************/				
	If &_cTipoCli == 'S' .And. Empty(&_cZconsum) .And. &_cCliContrib == '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		dbSelectArea("SF7")
		SF7->( dbSetOrder(4) )	// F7_FILIAL + F7_GRTRIB + F7_GRPCLI + F7_EST + F7_TIPOCLI
		If SF7->( dbSeek(xFilial("SF7") + SB1->B1_GRTRIB + &_cxCliContr + &_cCliEst + &_cTipoCli) )

			/*************************************************************
			<<< ALTERAÇÃO >>> 
			Ação...........: Regras:
			...............: 1 - Tipo do Cliente "SOLIDARIO"
			...............: 2 - NÃO abre tela
			...............: 3 - Contribuinte igual 1 
			...............: 4 - Grupo de Tributação do Produto "PREENCHIDO" 
			...............: 5 - MARGEM maior que ZERO
			...............: 6 - Cliente DENTRO do ESTADO
			Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
			Data...........: 19/04/2022
			Chamado........: 20220418008242
			*************************************************************/				
			IF SF7->F7_MARGEM <> 0 .AND. _cEst == &_cCliEst
					If SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
						_cTes     := '910' //908
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '908'
					ELSEIF SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
						_cTes     := '935' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 907 ITEM DA PLANILHA 01
					ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
						_cTes     := '935' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 910 ITEM DA PLANILHA 02
					ElseIf SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '935' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 907 ITEM DA PLANILHA 05
					ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI <> 0					
						_cTes     := '935' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 905 ITEM DA PLANILHA 06
					EndIf

			/*************************************************************
			<<< ALTERAÇÃO >>> 
			Ação...........: Regras:
			...............: 1 - Tipo do Cliente "SOLIDARIO"
			...............: 2 - NÃO abre tela
			...............: 3 - Contribuinte igual 1 
			...............: 4 - Grupo de Tributação do Produto "PREENCHIDO" 
			...............: 5 - MARGEM maior que ZERO
			...............: 6 - Cliente FORA do ESTADO
			Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
			Data...........: 19/04/2022
			Chamado........: 20220418008242
			*************************************************************/				
			ELSEIF SF7->F7_MARGEM <> 0 .AND. _cEst <> &_cCliEst
					If SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
						_cTes     := '907'
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '908'
					ELSEIF SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
						_cTes     := '907'
					ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
						_cTes     := '910'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '907'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '907'	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 905 ITEM DA PLANILHA 14
					EndIf				

			/*************************************************************
			<<< ALTERAÇÃO >>> 
			Ação...........: Regras:
			...............: 1 - Tipo do Cliente "SOLIDARIO"
			...............: 2 - NÃO abre tela
			...............: 3 - Contribuinte igual 1 
			...............: 4 - Grupo de Tributação do Produto "PREENCHIDO" 
			...............: 5 - MARGEM IGUAL A ZERO
			...............: 6 - Cliente DENTRO do ESTADO
			Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
			Data...........: 19/04/2022
			Chamado........: 20220418008242
			*************************************************************/				
			ELSEIF SF7->F7_MARGEM = 0 .AND. _cEst == &_cCliEst
					If SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
						_cTes     := '910' //909
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '906'
					ELSEIF SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
						_cTes     := '907'
					ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
						_cTes     := '910'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '907'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '907'	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 905 ITEM DA PLANILHA 14
					EndIf				

			/*************************************************************
			<<< ALTERAÇÃO >>> 
			Ação...........: Regras:
			...............: 1 - Tipo do Cliente "SOLIDARIO"
			...............: 2 - NÃO abre tela
			...............: 3 - Contribuinte igual 1 
			...............: 4 - Grupo de Tributação do Produto "PREENCHIDO" 
			...............: 5 - MARGEM IGUAL A ZERO
			...............: 6 - Cliente FORA do ESTADO
			Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
			Data...........: 19/04/2022
			Chamado........: 20220418008242
			*************************************************************/				
			ELSEIF SF7->F7_MARGEM = 0 .AND. _cEst <> &_cCliEst
					If SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
						_cTes     := '909'
					ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '906'
					ENDIF
			ENDIF

		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Tipo do Cliente "SOLIDARIO"
		...............: 2 - NÃO abre tela
		...............: 3 - Contribuinte igual 1 
		...............: 4 - Grupo de Tributação do Produto "EM BRANCO" 
		Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
		Data...........: 19/04/2022
		Chamado........: 20220418008242
		*************************************************************/				
		ELSE
			/*************************************************************
			<<< ALTERAÇÃO >>> 
			Ação...........: Regras:
			...............: 1 - Tipo do Cliente "SOLIDARIO"
			...............: 2 - NÃO abre tela
			...............: 3 - Contribuinte igual 1 
			...............: 4 - Grupo de Tributação do Produto "EM BRANCO" 
			...............: 5 - Cliente DENTRO do ESTADO
			Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
			Data...........: 19/04/2022
			Chamado........: 20220418008242
			*************************************************************/				
			IF _cEst == &_cCliEst
				If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
					//_cTes     := '935' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 907 ITEM DA PLANILHA 01
					_cTes     := '907' 	// Valdemir Rabelo 09/05/2022 - Chamdo: 20220426008829
				ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
					//_cTes     := '935' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 910 ITEM DA PLANILHA 02
					_cTes     := '907' 	 	// Valdemir Rabelo 09/05/2022 - Chamdo: 20220426008829
				ElseIf SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '907' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - MANTER TES ANTERIOR 907 ITEM DA PLANILHA 05
				ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '907' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 905 ITEM DA PLANILHA 06
				ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '906'
				ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
					_cTes     := '909'
				EndIf			
			/*************************************************************
			<<< ALTERAÇÃO >>> 
			Ação...........: Regras:
			...............: 1 - Tipo do Cliente "SOLIDARIO"
			...............: 2 - NÃO abre tela
			...............: 3 - Contribuinte igual 1 
			...............: 4 - Grupo de Tributação do Produto "EM BRANCO" 
			...............: 5 - Cliente FORA do ESTADO
			Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
			Data...........: 19/04/2022
			Chamado........: 20220418008242
			*************************************************************/				
			ELSEIF _cEst <> &_cCliEst
				If SB1->B1_CLAPROD == 'C' .And. SB1->B1_IPI = 0
					_cTes     := '907'
				ElseIf SB1->B1_CLAPROD == 'F' .And. SB1->B1_IPI = 0
					_cTes     := '910'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '907'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '907'	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 905 ITEM DA PLANILHA 14
				ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '906'
				ElseIf SB1->B1_CLAPROD == 'I' .And. SB1->B1_IPI = 0
					_cTes     := '909'
				EndIf			
			ENDIF
		ENDIF
	EndIf

Return _cTes

/*====================================================================================\
|Programa  | NCOper89         | Autor | Marcelo Klopfer Leme     | Data | 19/04/2022  |
|=====================================================================================|
|Descrição |   TES INTELIGENTE        		    	                                      |
|          |   Tipo de Operação 89                                                    |
|          |   89 -    REMESSA MERCADORIA FALTANTE (ATU ESTOQUE)                      |
|=====================================================================================|
|Sintaxe   | NCOper89                                                                 |
|=====================================================================================|
|Uso       | Especifico STECK                                                         |
|=====================================================================================|
|........................................Histórico....................................|
\====================================================================================*/
Static Function NCOper89()

	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Se Existir na tabela "SF7"
		...............: 2 - Grupo de Tributação			Exemplo 046
		...............: 3 - Grupo do Cliente					Exemplo 001
		...............: 4 - Para dentro do Estado SP	Exmplo  SP
		...............: 5 - Tipo do Cliente 					Exemplo R	
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
		Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
		Data...........: 22/03/2022
		Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
		*************************************************************/				
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0

				//Regra de 1 à 6 e 25 à 30
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 01 / 25
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '887'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 04 / 28
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 890 ITEM DA PLANILHA 05
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '887'
					EndIf

					//Regra de 7 à 12 e 31 à 36
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '889' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 890 ITEM DA PLANILHA 11
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '890'
					EndIf
				EndIf

			/******************************
			MARGEM IGUAL A ZERO
			******************************/
			ELSE
				//Regra de 1 à 6 e 25 à 30
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '890'
					EndIf

					//Regra de 7 à 12 e 31 à 36
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '889' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 890 ITEM DA PLANILHA 11
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '890'
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 1 à 6 e 25 à 30
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '887'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '887'
				EndIf

			//Regra de 7 à 12 e 31 à 36
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '889' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 890 ITEM DA PLANILHA 11
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '890'
				EndIf
			EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Se Existir na tabela "SF7"
		...............: 2 - Grupo de Tributação			Exemplo 046
		...............: 3 - Grupo do Cliente					Exemplo 001
		...............: 4 - Para dentro do Estado SP	Exmplo  SP
		...............: 5 - Tipo do Cliente 					Exemplo R	
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
		Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
		Data...........: 22/03/2022
		Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
		*************************************************************/				
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0
				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 13 / 37 
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 16 / 40
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 886 ITEM DA PLANILHA 41
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '886'
					EndIf

					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '889' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 886 ITEM DA PLANILHA 47
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '886'
					EndIf
				EndIf
			/************************
			MARGEM IGUAL A ZERO
			************************/
			ELSE
				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '886'
					EndIf

					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '889' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 886 ITEM DA PLANILHA 47
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '886'
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 13 à 18 e 37 à 42
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '886'
				EndIf

			//Regra de 19 à 24 e 43 à 48
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '889' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 886 ITEM DA PLANILHA 47
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '886'
				EndIf
			EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Se Existir na tabela "SF7"
		...............: 2 - Grupo de Tributação			Exemplo 046
		...............: 3 - Grupo do Cliente					Exemplo 001
		...............: 4 - Para dentro do Estado SP	Exmplo  SP
		...............: 5 - Tipo do Cliente 					Exemplo R	
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
		Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
		Data...........: 22/03/2022
		Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
		*************************************************************/				
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0
				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 13 / 37 
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 16 / 40
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 886 ITEM DA PLANILHA 41
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '886'
					EndIf

					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '889' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 886 ITEM DA PLANILHA 47
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '886'
					EndIf
				EndIf
			/************************
			MARGEM IGUAL A ZERO
			************************/
			ELSE
				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '886'
					EndIf

					//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '889' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 886 ITEM DA PLANILHA 47
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '886'
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 13 à 18 e 37 à 42
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '886'
				EndIf

			//Regra de 19 à 24 e 43 à 48
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '889' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 886 ITEM DA PLANILHA 47
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '886'
				EndIf
			EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Se Existir na tabela "SF7"
		...............: 2 - Grupo de Tributação			Exemplo 046
		...............: 3 - Grupo do Cliente					Exemplo 001
		...............: 4 - Para dentro do Estado SP	Exmplo  SP
		...............: 5 - Tipo do Cliente 					Exemplo R	
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "IGUAL A ZERO" Será aplica a TES 558     <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 6 - Encontoru amarração na SF7 e a "MARGEM" for "MAIOR QUE ZERO" Será aplica a TES 916   <<<< AGUARDANDO POSIÇÃO PARA SABER SE SEGUIRA ESTA REGRA. >>>> 12/04/2022
		...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
		Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
		Data...........: 22/03/2022
		Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
		*************************************************************/				
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0
				//Regra de 61 à 66
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 888 ITEM DA PLANILHA 61
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '934'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '888'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 889 ITEM DA PLANILHA 64
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '934' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 887 ITEM DA PLANILHA 65
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '887'
					EndIf

					//Regra de 67 à 72
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '888'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '888'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '888'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '888'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '888' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 887 ITEM DA PLANILHA 71
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '887'
					EndIf
				EndIf
			/***************************
			MARGEM IGUAL A ZERO
			***************************/
			ELSE
				//Regra de 61 à 66
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '888'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '889'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '887'
					EndIf

					//Regra de 67 à 72
				ElseIf _cEst <> &_cCliEst

					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '888'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '888'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '888'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '888'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '888' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 887 ITEM DA PLANILHA 71
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '887'
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 61 à 66
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '888'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '889'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '887'
				EndIf

			//Regra de 67 à 72
			ElseIf _cEst <> &_cCliEst

				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '888'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '888'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '888'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '888'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '888' 	//// Alterado por Marcelo Klopfer - 19/04/2022 - TES ANTERIOR 887 ITEM DA PLANILHA 71
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '887'
				EndIf
			EndIf
		ENDIF

	EndIf
Return  (_cTes)


Static Function NcOper0A()

If  &_cTipoCli = 'S' /*.And. &_cZconsum = '1' */  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) //.And. &_cTipopv $ ('P')
//	SF7->(DbSetOrder(4))
//	If SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//		If SF7->F7_MARGEM > 0
//			If _cEst = &_cCliEst
//			Else
//			EndIf
//		Else
//			If _cEst = &_cCliEst
//			Else
//			EndIf
//		EndIf
//	Else
		If _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '944'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '944'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '944'
			EndIf
		Else
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '944'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '944'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '944'
			EndIf
		EndIf
//	EndIf
EndIf

RETURN _cTes


Static Function NcOper0B()

If  &_cTipoCli = 'R' /*.And. &_cZconsum = '1' */  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr))) //.And. &_cTipopv $ ('P')
//	SF7->(DbSetOrder(4))
//	If SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
//		If SF7->F7_MARGEM > 0
//			If _cEst = &_cCliEst
//			Else
//			EndIf
//		Else
//			If _cEst = &_cCliEst
//			Else
//			EndIf
//		EndIf
//	Else
		If _cEst = &_cCliEst
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '822'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '822'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '822'
			EndIf
		Else
			If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
				_cTes     := ''
			ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
				_cTes     := '822'
			ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
				_cTes     := '822'
			ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
				_cTes     := '822'
			EndIf
		EndIf
//	EndIf
EndIf

RETURN _cTes


/*====================================================================================\
	|Programa  | NCOper0C         | Autor | MARCELO KLOPFER LEME     | Data | 20/04/2022  |
	|=====================================================================================|
	|Descrição |   TES INTELIGENTE        		    	                                      |
	|          |   Tipo de Operação 0C                                                    |
	|          |   0C - REMESSA DE MATERIAL FALTANTE NÃO ATUALIZA ESTOQUE                 |
	|=====================================================================================|
	|Sintaxe   | NCOper0C                                                                 |
	|=====================================================================================|
	|Uso       | Específico NEWCO                                                         |
	|=====================================================================================|
	|........................................Histórico....................................|
	\====================================================================================*/
	*-----------------------------*
Static Function NCOper0C()
	*-----------------------------*


	If  &_cTipoCli = 'R' .And. &_cZconsum = '1'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		/*************************************************************
		<<< ALTERAÇÃO >>> 
		Ação...........: Regras:
		...............: 1 - Se Existir na tabela "SF7"
		...............: 2 - Grupo de Tributação			Exemplo 046
		...............: 3 - Grupo do Cliente					Exemplo 001
		...............: 4 - Para dentro do Estado SP	Exmplo  SP
		...............: 5 - Tipo do Cliente 					Exemplo R	
		...............: 7 - NÃO Encontoru amarração na SF7 Será aplica a TES 558
		Desenvolvedor..: Marcelo Klopfer Leme - SIGAMAT
		Data...........: 22/03/2022
		Chamado........: 20220303004966 - VIRADA APOEMA NEWCO DISTRIBUIDORA
		*************************************************************/				
		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0

				//Regra de 1 à 6 e 25 à 30
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '690'
					EndIf

					//Regra de 7 à 12 e 31 à 36
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '690'
						ENDIF
					EndIf
				EndIf

			/******************************
			MARGEM IGUAL A ZERO
			******************************/
			ELSE
				//Regra de 1 à 6 e 25 à 30
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '690'
						ENDIF
					EndIf

					//Regra de 7 à 12 e 31 à 36
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '690'
						ENDIF
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 1 à 6 e 25 à 30
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '690'
				EndIf

			//Regra de 7 à 12 e 31 à 36
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					If  &_cCliEst = "AM"
						_cTes     := '689'
					ELSE
						_cTes     := '690'
					ENDIF
				EndIf
			EndIf
		ENDIF


	ElseIf  &_cTipoCli = 'F' .And. &_cZconsum = '2'  .And. &_cCliContrib = '1' .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0
		
				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '615'
					EndIf

				//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '615'
						ENDIF
					EndIf
				EndIf
			/*********************************
			MARGEM IGUAL A ZERO
			*********************************/
			ELSE
				//Regra de 13 à 18 e 37 à 42
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '615'
					EndIf

				//Regra de 19 à 24 e 43 à 48
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '615'
						ENDIF
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 13 à 18 e 37 à 42
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '615'
				EndIf

			//Regra de 19 à 24 e 43 à 48
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '615'
						ENDIF
				EndIf
			EndIf
		ENDIF

	ElseIf  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And. &_cCliContrib = '2'

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0
				//Regra de 49 à 54
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '939' 
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '939'	//// Alterado por Marcelo Klopfer - 06/12/2021 - TES ANTERIOR 901 ITEM DA PLANILHA 52
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '615'
					EndIf

					//Regra de 55 à 60
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '615'
						ENDIF
					EndIf
				EndIf
			/*****************************
			MARGEM IGUAL A ZERO
			*****************************/
			ELSE
				//Regra de 49 à 54
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689' 
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '615'
					EndIf

					//Regra de 55 à 60
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '615'
						ENDIF
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 49 à 54
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '689' 
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '615'
				EndIf

			//Regra de 55 à 60
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '615'
						ENDIF
				EndIf
			EndIf
		ENDIF


	ElseIf  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))

		SF7->(DbSetOrder(4))
		IF SF7->(DBSEEK(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			IF SF7->F7_MARGEM > 0

				//Regra de 61 à 66
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '667'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '939'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						//_cTes     := '899'
						_cTes     := '661'       // Valdemir Rabelo 11/05/2022 - Chamado: 20220510009884
					EndIf

					//Regra de 67 à 72
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '667'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '667'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '667'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '667'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '667'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '667'
						ELSE
							_cTes     := '661'
						ENDIF
					EndIf
				EndIf
			/************************************
			MARGEM IGUAL A ZERO
			************************************/
			ELSE
				//Regra de 61 à 66
				If   _cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						_cTes     := '690'
					EndIf

					//Regra de 67 à 72
				ElseIf _cEst <> &_cCliEst
					If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
						_cTes     := '689'
					ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '690'
						ENDIF
					EndIf
				EndIf
			ENDIF
		ELSE
			//Regra de 61 à 66
			If   _cEst = &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
					_cTes     := '690'
				EndIf

			//Regra de 67 à 72
			ElseIf _cEst <> &_cCliEst
				If SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI = 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'C' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'F' .And. SB1->B1_IPI <> 0
					_cTes     := '689'
				ElseIf SB1->B1_CLAPROD = 'I' .And. SB1->B1_IPI <> 0
						If  &_cCliEst = "AM"
							_cTes     := '689'
						ELSE
							_cTes     := '690'
						ENDIF
				EndIf
			EndIf
		ENDIF
	EndIf
	Return  (_cTes)


/*/{Protheus.doc} NCOper0E
Remessa Empréstimo de Ativo
@type function
@version  12.1.33
@author Ricardo Munhoz
@since 13/10/2022
@return character, TES correspondente
/*/
	Static Function NCOper0E()

	If  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '1'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'S' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'R' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := ""
							Else
								_cTes := ""
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := ""
							Else
								_cTes := ""
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'R' .And. Alltrim(&_cZconsum) = '1'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := ""
							Else
								_cTes := ""
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := ""
							Else
								_cTes := ""
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'R' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0 //Tem SF7
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := ""
							Else
								_cTes := ""
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			Else  //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
				If EMPTY(SB1->B1_GRTRIB) //Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem MVA mas é Zero e não tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst //Dentro do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := ""
							Else
								_cTes := ""
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else //Não tem SF7
			If EMPTY(SB1->B1_GRTRIB) //Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst //Dentro do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0
				If EMPTY(SB1->B1_GRTRIB) //Tem SF7 com Margem, Não Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem SF7 com Margem, Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			Else
				If EMPTY(SB1->B1_GRTRIB) //Tem SF7 sem Margem, Não Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem SF7 sem Margem, Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else
			If EMPTY(SB1->B1_GRTRIB) //Não Tem SF7, Não Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não Tem SF7, Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = '1'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0
				If EMPTY(SB1->B1_GRTRIB) //Tem SF7 com Margem, Não Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem SF7 com Margem, Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			Else
				If EMPTY(SB1->B1_GRTRIB) //Tem SF7 sem Margem, Não Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem SF7 sem Margem, Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else
			If EMPTY(SB1->B1_GRTRIB) //Não Tem SF7, Não Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não Tem SF7, Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0
				If EMPTY(SB1->B1_GRTRIB) //Tem SF7 com Margem, Não Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem SF7 com Margem, Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			Else
				If EMPTY(SB1->B1_GRTRIB) //Tem SF7 sem Margem, Não Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem SF7 sem Margem, Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else
			If EMPTY(SB1->B1_GRTRIB) //Não Tem SF7, Não Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não Tem SF7, Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	If  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = ''  .And.  &_cCliContrib <> '1'  //.And. (!Empty(ALLTRIM(&_cCliInscr)) .Or. 'ISENT' $ Upper(ALLTRIM(&_cCliInscr)))
		SF7->(DbSetOrder(4))
		If SF7->(DbSeek(xFilial("SF7")+SB1->B1_GRTRIB+&_cxCliContr+&_cCliEst+&_cTipoCli))
			If SF7->F7_MARGEM <> 0
				If EMPTY(SB1->B1_GRTRIB) //Tem SF7 com Margem, Não Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem SF7 com Margem, Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			Else
				If EMPTY(SB1->B1_GRTRIB) //Tem SF7 sem Margem, Não Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				Else //Tem SF7 sem Margem, Tem Grupo Tributário na SB1
					IF	_cEst = &_cCliEst
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					Else //Fora do Estado
						If SB1->B1_CLAPROD = 'C'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'F'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
						If SB1->B1_CLAPROD = 'I'
							If SB1->B1_IPI = 0
								_cTes := "706"
							Else
								_cTes := "706"
							EndIf
						EndIf
					EndIf
				EndIf
			EndIf
		Else
			If EMPTY(SB1->B1_GRTRIB) //Não Tem SF7, Não Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			Else //Não Tem SF7, Tem Grupo Tributário na SB1
				IF	_cEst = &_cCliEst
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				Else //Fora do Estado
					If SB1->B1_CLAPROD = 'C'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'F'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
					If SB1->B1_CLAPROD = 'I'
						If SB1->B1_IPI = 0
							_cTes := "706"
						Else
							_cTes := "706"
						EndIf
					EndIf
				EndIf
			EndIf
		EndIf
	EndIf

	Return _cTes

//--------------------------------------------------------------------------------//
//FR - 21/03/2023 - Flávia Rocha - Sigamat Consultoria - PROJETO MERCADO LIVRE
//--------------------------------------------------------------------------------//
/*/{Protheus.doc} NCOper0G
Remessa Para Mercado Livre
@type function
@version  12.1.33
@author Flávia Rocha
@since 13/10/2022
@return character, TES correspondente
/*/
Static Function NCOper0G()

//_cTipoCli --> F=Cons.Final;L=Prod.Rural;R=Revendedor;S=Solidario;X=Exportacao/Importacao 
//_cTipoCli --> Pega conteúdo do campo C5_TIPOCLI
//C5_ZCONSUM --> Pega conteúdo do campo C5_ZCONSUM -> {"1 - Industrialização","2 - Consumo Próprio"}

//*************************************************
//	1 - Consumidor Final = "F"
//	2 - Apresenta Tela = "2" Consumo Próprio.
//	3 - Contribuinte = "1" SIM
//	4 - Possui Inscrição Estadual 
//	5 - Somente para o Estado SP
//**************************************************

If  &_cTipoCli = 'F' .And. Alltrim(&_cZconsum) = '2'  .And.  &_cCliContrib = '1'  .And. ( !Empty(ALLTRIM(&_cCliInscr)) )
	//IF	_cEst = &_cCliEst //Dentro do Estado
		If SB1->B1_CLAPROD $ 'C/F'//COMPRADO OU FABRICADO 954 : [C]omprado, [F]abricado 
			//If SB1->B1_IPI = 0
				_cTes := "954"  //sem IPI
		ElseIF SB1->B1_CLAPROD == "I"
			If SB1->B1_IPI = 0
				_cTes := "954"
			Elseif SB1->B1_IPI > 0
				_cTes := "955" //com IPI
			EndIf
		Endif 
	//EndIf
Endif 
	
Return _cTes

