#include 'Protheus.ch'
#include 'RwMake.ch'

/*====================================================================================\
|Programa  | STGAP31         | Autor | GIOVANI.ZAGO              | Data | 01/02/2013  |
|=====================================================================================|
|Descrição |  Gap 31     												              |
|          |                                                                          |
|          |                                                                          |
|=====================================================================================|
|Sintaxe   | STGAP31                                                                  |
|=====================================================================================|
|Uso       | Especifico STECK                                                         |
|=====================================================================================|
|........................................Histórico....................................|
\====================================================================================*/
*-----------------------------*
User Function ST31GAP()
	*-----------------------------*
	
	Local aArea         := GetArea()
	Local _nPosCom2     := aScan(aHeader, { |x| Alltrim(x[2]) == "C6_COMIS2"  })
	Local i		:= 0
	If ( Type("l410Auto") == "U" .OR. !l410Auto )  .and. !IsInCallSteck("U_STFAT15")
		
		For i:= 1 To Len(Acols)
			
			If !aCols[i,Len(aHeader)+1]
				
				aCols[i,_nPosCom2]   := 0
			EndIf
		Next i
	EndIf
Return( )

